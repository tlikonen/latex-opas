\chapter{Dokumentin asetukset}

% Tämä luku käsittelee...

\section{Dokumenttiluokat}
\label{luku:dokumenttiluokat}

Latexin lähdedokumenttien alussa on aina samankaltainen rivi, joka
määrittelee käytettävän dokumenttiluokan ja mahdollisesti dokumentin
pe\-rus\-ase\-tuk\-sia. Dokumenttiluokka määritellään komennolla
\koodi{\keno documentclass} ja sen argumentiksi annetaan
dokumenttiluokan nimi. Valinnaisilla argumenteilla vaikutetaan
asetuksiin.

\begin{koodilohkosis}
  \documentclass[a4paper, 12pt]{article}
\end{koodilohkosis}

Dokumenttiluokka on eräänlaisen pohjadokumentti eli ominaisuuksien ja
asetusten kokoelma, jonka varaan oma dokumentti kirjoitetaan. Eri
dokumenttiluokat sisältävät erilaisia ominaisuuksia ja erilaiset
oletusasetukset. Edellä olevassa esimerkissä käytettiin
\koodi{article}\-/luokkaa, joka on yleiskäyttöinen luokka
monenlaisten dokumenttien kirjoittamiseen.

Seuraavissa alaluvuissa käsitellään tavallisimpia dokumenttiluokkia ja
niiden asetuksia. Dokumenttiluokkia voi tehdä itsekin, ja sitä aihetta
käsitellään luvussa \ref{luku:omat_dokumenttiluokat}.

\subsection{Perusdokumenttiluokat}

Muutama dokumenttiluokka kuuluu Latexin perusvalikoimaan, eli ne ovat
aina saatavilla ja asennettuna, kun itse Latexkin on. Niitä kutsutaan
välillä standardeiksi dokumenttiluokiksi, ja ne ovat ikään kuin
muuttumattomia perusluokkia, joiden varaan on turvallista rakentaa omia
dokumentteja tai muita dokumenttiluokkia. Muita dokumenttiluokkia
kehitetään Latexin perusosien ulkopuolella, ja niiden ominaisuudet
voivat muuttua ja kehittyä nopeammin ajan myötä.

Normaalit%
\koodimargin{article \\ report \\ book} paperisivuihin perustuvat
dokumentit tehdään luokkien \koodi{article}, \koodi{report} tai
\koodi{book} avulla. Ne ovat keskenään hyvin samanlaisia, mutta
niiden oletusasetukset poikkeavat toisistaan. Karkeasti jaoteltuna
\koodi{article}\-/luokka on tarkoitettu lyhyehköille artikkeleille ja
yleiseksi perustaksi monenlaisille dokumenteille. Sen sijaan
\koodi{report} ja \koodi{book} on tarkoitettu laajoihin
dokumentteihin, ja niissä on kirja\-typo\-grafian piirteitä.

Suurin edellä mainittujen perusluokkien ero on otsikoinnissa ja
dokumentin jäsentämisessä: \koodi{report} ja \koodi{book}
sisältävät suuret pääluvut (\koodi{\keno chapter}) eli otsikot, jotka
alkavat tyhjältä sivulta; \koodi{article} ei sisällä samanlaisia
päälukuja vaan ainoastaan tavalliset leipätekstin mukana kulkevat
väliotsikot (\koodi{\keno section}, \koodi{\keno subsection}
jne.). Otsikointia ja tekstin jäsentämistä käsitellään tarkemmin luvussa
\ref{luku:otsikot}.

Toinen ero perusluokkien välillä on se, että vain
\koodi{book}\-/luokka sisältää komennot \koodi{\keno frontmatter},
\koodi{\keno mainmatter} ja \koodi{\keno backmatter}, joita voi
käyttää ilmaisemaan tietokirjan erityyppiset osat: alkusivut,
varsinaiset sisältösivut ja liitesivut. Näitä käsitellään luvussa
\ref{luku:frontmainbackmatter}.

Muut erot koskevat lähinnä oletusasetuksia, mutta asetukset ovat
tietenkin muutettavissa, eivätkä ne siten ole määräävä tekijä
valittaessa luokkien \koodi{article}, \koodi{report} ja
\koodi{book} välillä. Dokumenttiluokkien asetuksia käsitellään
seuraavassa alaluvussa.

Muita%
\koodimargin{letter} perusdokumenttiluokkia ovat \koodi{letter} ja
\koodi{slides}. Nimensä mukaisesti \koodi{letter} on kirjeiden
kirjoittamista varten. Se sisältää kirjeen tyypilliseen rakenteeseen
liittyviä komentoja ja soveltuu varsinkin tarpeisiin, joissa täytyy
automaattisesti tuottaa samanmuotoisia kirjeitä usealle
vas\-taan\-otta\-jalle. Sama Latex\-/dokumentti voi sisältää useita
kirjeitä, ja sivunumerointi ja alaviitteiden numerointi alkaa joka
kirjeessä alusta -- kuten on tietysti toivottavaa.
\koodi{letter}\-/luokkaa käsitellään tarkemmin luvussa
\ref{luku:kirjeet}.

Esitys\-grafiikkaa%
\koodimargin{slides} eli dia\-esityksiä voi tehdä
\koodi{slides}\-/luokan avulla. Tähän tarkoitukseen on kuitenkin
olemassa paljon monipuolisempi luokka \koodi{beamer}, joten
\koodi{slides}\-/luokan käyttö ei ole kovin mielekästä.
Dia\-esi\-tys\-ten ja \koodi{beamer}\-/luokan perus\-asioita
käsitellään luvussa \ref{luku:diaesitykset}.

\subsection{Perusdokumenttiluokkien asetukset}

Taulukkoon \ref{tlk:luokkavalitsimet}%
\koodimargin{*paper} on koottu perusdokumenttiluokkien valitsimet.
Paperikoko valitaan komennoilla \koodi{a4\-paper} (210 × 297 mm),
\koodi{a5\-paper} (148 × 210 mm), \koodi{b5\-paper} (176 × 250 mm),
\koodi{executivepaper} (7,25 × 10,5 tuumaa), \koodi{legalpaper} (8,5 ×
14 tuumaa) tai \koodi{letterpaper} (8,5 × 11 tuumaa). Latexin oletuksena
on \koodi{letterpaper}, mutta oletusta voi olla muutettu Latexin
jakelupaketissa. Varminta on aina itse kirjoittaa haluttu paperikoko
dokumentin asetuksiin.

\leijutlk{
  \ttfamily
  \begin{tabular}{llll}
    \toprule
    a4paper & landscape & onecolumn & 10pt \\
    a5paper & final & twocolumn & 11pt \\
    b5paper & draft & openany & 12pt \\
    executivepaper & oneside & openright & titlepage \\
    legalpaper & twoside & fleqn & notitlepage \\
    letterpaper & openbib & leqno & clock \\
    \bottomrule
  \end{tabular}
}{
  \caption{Perusdokumenttiluokkien asetukset}
  \label{tlk:luokkavalitsimet}
}

Paperi%
\koodimargin{landscape} on oletuksena pysty\-asen\-nossa, mutta valitsin
\koodi{landscape} asettaa sen vaaka\-/asentoon. Tämä asetus koskee
dokumentin kaikkia sivuja, mutta jos haluaa asettaa vain yksittäisiä
sivuja vaaka\-/asentoon, täytyy käyttää \paketti{pdf\-lscape}\-/pakettia
ja sen tarjoamaa ympäristöä.\avusepkg{pdflscape}

Paperikokoja ja muitakin sivun mittoja voi määritellä monipuolisemmin
\paketti{geometry}\-/paketin toimintojen avulla (luku
\ref{luku:sivuasetukset}). Jos sitä pakettia käyttää, ei näitä
dokumenttiluokan paperi\-koko\-ase\-tuk\-sia tarvita välttämättä
lainkaan.

Dokumentista%
\koodimargin{draft} voi latoa luonnosversion käyttämällä
dokumenttiluokan valitsinta \koodi{draft}. Luonnokseen merkitään ainakin
tekstipalstan yli pursuavat rivit (engl. \englanti{overfull box})
mustalla suorakulmiolla, mikä voi auttaa tekstikappaleiden ulkoasun
korjailussa (luku \ref{luku:kappale}). Eri makropaketit voivat hyödyntää
\koodi{draft}\-/valitsinta omalla tavallaan eli muuttaa toimintaansa sen
perusteella. Esimerkiksi grafiikkaan liittyvä paketti \paketti{graphicx}
(luku \ref{luku:grafiikka}) jättää luonnosversiosta kuvat pois, ja
niiden paikalla on vain suorakulmio. Pdf\-/tiedoston ristiviitteistä
huolehtiva \paketti{hyperref}\-/paketti jättää pdf:n sisäiset
ristiviitteet ja sisällysluettelon tekemättä (luku
\ref{luku:ristiviitteet}).

Lopullinen%
\koodimargin{final} ladontatila on \koodi{final}, jolloin dokumenttiin
ladotaan kaikki sisältö ja ominaisuudet niin kuin se on tarkoitettu
julkaistavaksi. Tätä valitsinta ei tarvitse käyttää, koska se on
oletustila.

\subsection{Muita dokumenttiluokkia}

\section{Sivu}
\label{luku:sivuasetukset}
\subsection{Marginaalit ja mitat}
\subsection{Ylä- ja alatunnisteet}

\section{Fontit}
\label{luku:kirjaintyypit}

Fontit ja niiden asettaminen on Latexissa melko monimutkainen
kokonaisuus, koska fonteilla on paljon ominaisuuksia ja niihin
vaikutetaan monilla eri asetuksilla ja abstraktiotasoilla. Aika monta
asiaa pitää ymmärtää, jotta voi tehokkaasti työskennellä Latexin
fonttien kanssa.

Fontti jo itsessään on moniselitteinen käsite, joka vaatii typografiassa
usein täsmentäviä ilmauksia. Sana \emph{fontti} voi tarkoittaa
kokonaista kirjainperhettä eli yhteensopivien kirjainleikkausten
muodostamaa kokonaisuutta. Samaan kirjainperheeseen kuuluu yleensä
ainakin neljä eri leikkausta: tavallinen, \textit{kursiivi},
\textbf{lihavoitu} ja \textbf{\textit{lihavoitu kursiivi}}. Joihinkin
perheisiin kuuluu leikkauksia paljon enemmänkin, kuten useita eri
vahvuuksia. Joissakin puheissa sana \emph{fontti} tarkoittaa vain yhtä
kirjainleikkausta, ja silloin koko perheeseen viitataan ehkä sanalla
fonttiperhe.

Tässä oppaassa käytän \emph{fontti}\-/sanaa yleisnimityksenä Latexin
kirjaintyyppeihin liittyville asetuksille. Se tarkoittaa kirjainperhettä
tai siihen kuuluvaa yksittäistä leikkausta sekä asetuksia, jotka
liittyvät niihin. Silloin kun merkitystä pitää täsmentää, käytän
suomenkielisiä nimiä kirjainperhe ja kirjainleikkaus. Sen sijaan sanan
\emph{kirjasin} jätän kokonaan pois. Se tarkoittaa vanhassa
metalliladonnassa ja mekaanisissa kirjoituskoneissa metallisen
ladontakappaleen eli kirjakkeen päähän valettua kirjaimen tai muun
merkin kohokuviota, joka painaa mustejäljen paperille.

Kuten Latexissa yleensäkin myös fonttien kanssa kannattaa käyttää
korkean abstraktiotason komentoja, jotka piilottavat yksityiskohdat ja
teknisen toteutuksen. Latexin fonttitoiminnot on suunniteltu juuri
siihen: matalan tason font\-ti\-ase\-tuk\-set määritellään mieluiten
vain kerran dokumentin esittelyosassa, ja sen jälkeen käytetään
pelkästään korkean tason komentoja.

\subsection{Fontin valinta}

Latexin fonttien perus\-toiminnot rakentuvat kolmen erityyppisen
kirjainperheen varaan: antiikva eli pääteviivallinen%
\footnote{Antiikva (lat. \emph{antiquus} 'vanha') perustuu antiikin
  Roomassa käytettyihin kirjainmuotoihin. Ne olivat pääteviivallisia,
  mutta pääteviivat sinänsä eivät ole ainoa antiikvan piirre. Toinen
  tärkeä ominaisuus ovat erivahvuiset kirjainten viivat.}
(\englanti{serif, roman}), groteski eli pääteviivaton%
\footnote{Groteskiin (ransk. \emph{grotesque} 'kummallinen') kuuluu
  pääteviivojen puuttumisen lisäksi lähes tasavahvuiset kirjainten
  viivat. Tämän oppaan groteskifontissa on kuitenkin selvästi
  antiikvamaiset kaksivahvuiset viivat, joten se on eräänlainen
  antiikvan ja groteskin välimuoto.} (\englanti{sans serif, gothic})
ja tasalevyinen kirjoituskoneen kaltainen perhe
(\englanti{typewriter, monospace}). Kuvassa
\ref{kuva:kirjainperhetyypit} ovat tässä oppaassa käytetyt kolme eri
kirjainperhettä. Leipätekstissä käytetään antiikvaa, otsikoissa ja
kuvateksteissä groteskia ja koodi\-esi\-mer\-keis\-sä tasalevyistä.
Kirjoituskoneen kaltainen tasalevyinen kirjainperhe on tässä tapauksessa
tyypiltään antiikva eli pääteviivallinen, mutta se voisi olla muutakin.
Tasalevyisyys on sen kirjainperheen tärkein määrittävä tekijä Latexin
asetusten näkökulmasta.

\leijukuva{
  {\rmfamily\addfontfeatures{ScaleAgain=5}Amf}
  \hfill
  {\sffamily\addfontfeatures{ScaleAgain=5}Amf}
  \hfill
  {\ttfamily\addfontfeatures{FakeStretch=1, ScaleAgain=5}Amf}
}{
  \caption{Vasemmalla pääteviivallinen, keskellä pääteviivaton ja
    oikealla tasalevyinen pääteviivallinen kirjainperhe}
  \label{kuva:kirjainperhetyypit}
}

Latexin fonttitekniikka rakentuu eri-ikäisistä kerroksista ja
tekniikoista. Fontteja on tehty esimerkiksi
\englanti{Metafont}\-/nimisellä kuvauskielellä, jolla tuotetaan
bittikarttafontteja eli pikseleistä koostuvia fontteja. Ne voidaan
muuttaa \englanti{Post Script Type~1} \=/muotoon ja käyttää
Latexissa. Myöhemmin mukaan ovat tulleet monipuoliset True Type- ja Open
Type \=/muotoiset fontit, ja niihin tämä opas keskittyy.

Joidenkin fonttien käyttöönottoon on tehty oma makropakettinsa, joten
sellaiset fontit voi ladata dokumentin esittelyosassa komennolla
\koodi{\keno usepackage}. Fonttikohtaisia makropaketteja on olemassa
varsinkin vanhalle fonttitekniikalle (\englanti{Metafont, Post Script
  Type~1}) mutta myös matematiikkatilan (luku \ref{luku:matematiikka})
fonttiasetuksille ja joillekin kir\-jain\-perhe\-koko\-nai\-suuk\-sille.

Valmiita makropaketteja on vain joillekin fonteille, ja käytännössä
yleensä True Type- ja Open Type \=/muodossa olevat kirjainperheet
otetaan käyttöön \paketti{fontspec}\-/paketin komennoilla alla olevan
esimerkin mukaisesti.

\begin{koodilohkosis}
  \setmainfont{TeX Gyre Termes}[Scale=1]
  \setsansfont{TeX Gyre Heros} [Scale=MatchLowercase]
  \setmonofont{TeX Gyre Cursor}[Scale=MatchLowercase]
\end{koodilohkosis}

Edellisessä esimerkissä \englanti{TeX Gyre Termes, Heros} ja
\englanti{Cursor} ovat kirjainperheiden nimiä. Fonttitiedostojen
tulee olla asennettuna käyttöjärjestelmän normaalien käytäntöjen
mukaisesti tai Latex\-/jakelun käytäntöjen mukaisesti.

Kirjainperheiden käyttöönoton yhteydessä voi määritellä lukuisia
asetuksia kuten ligatuureja, gemenanumeroita, optisia kokoja ja muita
fontin ominaisuuksia. Edellisessä esimerkissä käytetään vain
\koodi{Scale}\-/valitsinta, jolla fontin voi skaalata haluttuun kokoon.

Peruskirjainperheen (\koodi{\keno set\-main\-font}) skaalaukseksi
asetetaan \koodi{Scale=1}, eli sille ei tehdä mitään, ja koko valitsimen
voisi jättää pois. Sen sijaan kahdella muulla kirjainperheellä
(\koodi{\keno set\-sans\-font}, \koodi{\keno set\-mono\-font}) käytetään
ker\-roin\-ase\-tus\-ta \koodi{MatchLowercase}, joka skaalaa fontin
siten, että gemenakirjaimet eli pienet kirjaimet ovat yhtä korkeita kuin
peruskirjainperheessä. Mikäli skaa\-laus\-ase\-tus
\koodi{MatchLowercase} ei tuota ihan toivottua tulosta, voi
kirjainperheen skaalausta hienosäätää vielä
\koodi{Scale\-Again}\-/valitsimella seuraavaan tapaan:

\begin{koodilohkosis}
  \setmonofont{TeX Gyre Cursor}
  [Scale=MatchLowercase, ScaleAgain=.97]
\end{koodilohkosis}

\pagebreak[3]

Jos edellä kuvatut kolme kirjainperhettä eivät riitä, on
\paketti{fontspec}\-/paketissa komennot lisäperheiden ja \=/leikkausten
määrittämiseen. Uusi perhe määritellään seuraavasti:

\begin{koodilohkosis}
  \newfontfamily{\hienoperhe}{TeX Gyre Schola}[…]
\end{koodilohkosis}

Komento \koodi{\keno new\-font\-family} toimii samalla tavalla kuin
aiemmin esitellyt \koodi{\keno set\-main\-font} ym. komennot, mutta
lisäksi ensimmäinen argumentti määrittää komennon, jolla kirjainperhe
otetaan käyttöön. Edellisessä esimerkissä luodaan komento \koodi{\keno
  hieno\-perhe}, joka kytkee päälle \englanti{TeX Gyre Schola}
\=/nimisen kirjainperheen.

\pagebreak[3]

Jos ei tarvita kokonaista perhettä vaan yksi leikkaus riittää, käytetään
komentoa \koodi{\keno new\-font\-face}. Seuraavassa esimerkissä
määriteltävä komento \koodi{\keno hieno\-leikkaus} ottaa käyttöön
lihavoidun (bold) kirjainleikkauksen perheestä \englanti{TeX Gyre
  Schola}.

\begin{koodilohkosis}
  \newfontface{\hienoleikkaus}{TeX Gyre Schola Bold}[…]
\end{koodilohkosis}

\subsection{Fontin koko ja rivikorkeus}

Fonttien koot on tapana valita ja ilmaista typografisen pistemitan
avulla. Esimerkiksi 10--12 pistettä on tyypillinen leipätekstin
oletuskoko teks\-tin\-kä\-sit\-tely\-ohjel\-mis\-sa. Piste on
typografiassa mitta\-yksikkö, jonka pituus on määritelty eri tavoin eri
aikoina ja eri kulttuureissa.

Myös Latexissa fonttien koot voi määritellä pistemittojen avulla. Niitä
ja muitakin Latexin mit\-ta\-yk\-si\-köi\-tä käsitellään tarkemmin
luvussa \ref{luku:mitat}. Fonteissa ole\-tus\-mitta\-yk\-sik\-kö\-nä on
vanha pica\-/järjestelmän piste, jonka pituus on noin \num{0,3515}
millimetriä. Sen lyhenne Latexissa on~\emph{pt}. Tämän oppaan
esimerkeissä käytetään kuitenkin Post Script \=/standardin mukaista,
julkaisuohjelmiin vakiintunutta uudempaa pica\-/pistettä, joka on hieman
edellistä pidempi: noin \num{0,3528} millimetriä. Latexissa sen lyhenne
on~\emph{bp}. Ero näiden kahden pistemitan välillä on hyvin pieni,
tavallisilla fonttiko'oilla käytännössä merkityksetön.

Kirjainleikkauksen koko mitataan merkistön ylimmän ja alimman kohdan
välillä, esimerkiksi k\=/kirjaimen ylimmän pisteen ja y\=/kirjaimen
alimman pisteen välillä. Lisäksi mittaan luetaan mukaan merkistön ylä-
ja alapuolella oleva pieni tyhjä tila, jonka fontin suunnittelija on
määritellyt.

Matalalla tasolla fonttien kokoon vaikuttaa Latexissa eräs yllättävä
asia. Nimittäin dokumenttiluokalle (luku \ref{luku:dokumenttiluokat})
voi antaa valitsimen, jolla koko asetetaan. Vaihtoehtoja on Latexin
normaaleissa dokumenttiluokissa vain kolme: \koodi{10pt} (oletus),
\koodi{11pt} ja \koodi{12pt}. Dokumenttiluokan koko\-asetus vaikuttaa
myös sivun marginaaleihin, koska Latex pyrkii pitämään rivin
merkkimäärän lukijalle sopivana: yhdelle riville ei kannata latoa ihan
mahdottomasti merkkejä, koska rivin seuraaminen vaatii enemmän
keskittymistä.

Fontin koon määrittäminen dokumenttiluokan valitsimella ehkä kuuluu jo
vähän menneisyyteen, mutta voi sitä edelleen käyttää, jos se riittää ja
sillä saa halutun lopputuloksen. Yleensä lienee järkevää jättää
dokumenttiluokan fonttiasetus oletukseksi (\koodi{10pt}) ja käyttää koon
asettamiseen luvuissa \ref{luku:fontti_suhteellinen} ja
\ref{luku:fontti_absoluuttinen} kerrottuja tapoja. Sivun marginaalien ja
muiden mittojen määrittämiseen on ohjeita luvussa
\ref{luku:sivuasetukset}.

Fonttiasetuksiin kuuluu fontin koon lisäksi toinenkin mitta: rivikorkeus
(\koodi{\keno base\-line\-skip}). Se on mitta rivin peruslinjalta edellisen
rivin peruslinjalle. Fontin koko ja rivikorkeus määritellään
saman\-aikaisesti, koska ne ovat saman \koodi{\keno fontsize}\-/komennon
argumentteja. Esimerkki:

\begin{koodilohkosis}
  \fontsize{10bp}{12bp} \selectfont
\end{koodilohkosis}

Ensimmäinen argumentti on fontin kokomitta ja toinen on rivikorkeus.
Mitta\-yksiköt voivat olla mitä tahansa Latexin mittoja, ja oletuksena
käytetään pt\-/pistemittaa, jos yksikköä ei ole mainittu. Komento
\koodi{\keno select\-font} on mukana, koska vasta sen myötä matalan
tason fonttikomennot tulevat voimaan. Korkean tason fonttikomennot (luku
\ref{luku:fontit_korkea}) suorittavat sen automaattisesti.

Rivikorkeus on vähintään sama kuin fontin koko, mutta yleensä se
asetetaan pari pistettä suuremmaksi, jotta rivit eivät olisi liian
lähellä toisiaan. Esimerkissä \ref{esim:rivikorkeus} on kaksi erilaista
\koodi{\keno fontsize}\-/komentoa ja ladottu lopputulos.

\begin{esimerkki*}
\begin{koodilohko}
  \fontsize{8bp}{11bp}\selectfont Tässä on pienehkö leipätekstin
  fonttikoko ja suhteellisen suuri rivikorkeus. Pitkät rivit vaativat
  suuremman rivikorkeuden kuin lyhyet rivit.

  \fontsize{16bp}{17bp}\selectfont Tässä on melko suuri fontti ja
  suhteellisen pieni rivikorkeus. Suuri fontti ja lyhyet rivit eivät
  tarvitse kovin suurta rivikorkeutta.
\end{koodilohko}
\parbox{\linewidth}{%
  \linespread{1}
  \fontsize{8bp}{11bp}\selectfont Tässä on pienehkö leipätekstin
  fonttikoko ja suhteellisen suuri rivikorkeus. Pitkät rivit vaativat
  suuremman rivikorkeuden kuin lyhyet rivit.

  \fontsize{16bp}{17bp}\selectfont Tässä on melko suuri fontti ja
  suhteellisen pieni rivikorkeus. Suuri fontti ja lyhyet rivit eivät
  tarvitse kovin suurta rivikorkeutta. }

\vspace{1ex}
\hrulefill
\vspace{2ex}

\caption{Fontin koon ja rivikorkeuden asettaminen ja vaikutus}
\label{esim:rivikorkeus}
\end{esimerkki*}

Toinen tekstirivien peruslinjojen väliseen etäisyyteen vaikuttava asetus
on \koodi{\keno baselinestretch}. Se on desimaalilukukerroin, jolla
nykyinen rivikorkeus kerrotaan. Kerroin asetetaan helpoimmin komennolla
\koodi{\keno linespread}.\footnote{Toinen tapa: \koodi{\keno
    renewcommand\{\keno baselinestretch\}\{kerroin\}}}

\begin{koodilohkosis}
  \fontsize{10bp}{12bp} \linespread{1.3} \selectfont
\end{koodilohkosis}

Edellä oleva esimerkki asettaa fontin kooksi 10 pistettä ja
rivikorkeudeksi 12 pistettä. \koodi{\keno linespread}\-/komennolla
asetetun kertoimen vuoksi rivien peruslinjojen väliseksi etäisyydeksi
tulee lopulta 1,3 kertaa 12 pistettä eli 15,6 pistettä. Ei ole väliä,
kummassa järjestyksessä \koodi{\keno fontsize}- ja \koodi{\keno
  linespread}\-/komennot annetaan. Asetukset tulevat voimaan vasta
\koodi{\keno select\-font}\-/komennon jälkeen.

Käytännössä \koodi{\keno linespread} sopii rivikorkeuden yleistason
hienosäätöön, esimerkiksi dokumentin esittelyosassa. Sitä ei kannattane
kovin paljon muutella, koska se vaikuttaa kaikkialla. Sen sijaan
\koodi{\keno fontsize}\-/komennolla määritetään rivikorkeus tietylle
fonttikoolle ja tiettyyn tilanteeseen.

\subsection{Korkean tason komennot}
\label{luku:fontit_korkea}

Latexissa on joukko korkean tason fonttikomentoja, jotka on tarkoitettu
käytettäväksi sen jälkeen, kun matalan tason asetukset on kerran
määritetty. Taulukossa \ref{tlk:fonttimallikomennot} on komennot
kirjainperheen ja kirjainleikkauksen valintaan. Kirjainperhekomento
vaihtaa koko perheen kaikkine leikkauksineen, ja kirjainleikkauskomento
valitsee toisen leikkauksen samasta perheestä.

\leijutlk{
  \begin{tabular}{llll}
    \toprule
    \multicolumn{2}{l}{\ots{Komento}}
    & \multicolumn{2}{l}{\ots{Merkitys}} \\
    \midrule
    \koodi{\keno rmfamily} & \koodi{\keno textrm\{\}}
    & {\rmfamily perhe} & antiikva, serif, roman \\
    \koodi{\keno sffamily} & \koodi{\keno textsf\{\}}
    & {\sffamily perhe} & groteski, sans serif, gothic \\
    \koodi{\keno ttfamily} & \koodi{\keno texttt\{\}}
    & {\ttfamily perhe} & tasalevyinen, typewriter \\
    \midrule
    \koodi{\keno mdseries} & \koodi{\keno textmd\{\}}
    & {\mdseries leikkaus} & tavallinen vahvuus, medium \\
    \koodi{\keno bfseries} & \koodi{\keno textbf\{\}}
    & {\bfseries leikkaus} & lihavoitu, bold \\
    \midrule
    \koodi{\keno upshape} & \koodi{\keno textup\{\}}
    & {\upshape leikkaus} & pystyasento, tavallinen \\
    \koodi{\keno slshape} & \koodi{\keno textsl\{\}}
    & {\slshape leikkaus} & kalteva, slanted, oblique \\
    \koodi{\keno itshape} & \koodi{\keno textit\{\}}
    & {\itshape leikkaus} & kursiivi, italic \\
    \koodi{\keno scshape} & \koodi{\keno textsc\{\}}
    & {\scshape leikkaus} & pienversaali, kapiteeli, small caps \\
    \bottomrule
  \end{tabular}
}{
  \caption{Komennot kirjainperheen ja kirjainleikkauksen valintaan}
  \label{tlk:fonttimallikomennot}
}

Kirjainleikkauksen asetukset jaetaan kahteen ryhmään:
\englanti{\emph{series}} 'sarja' ja \englanti{\emph{shape}} 'muoto'.
Kummastakin ryhmästä on valittuna aina yksi ominaisuus, eli
samanaikaisesti voi olla voimassa esimerkiksi \koodi{\keno bf\-se\-ries}
(\textbf{lihavoitu}) ja \koodi{\keno it\-shape} (\textit{kursiivi}), ja
tuloksena on \textbf{\itshape lihavoitua kursiivia}.

Tämän oppaan fontissa kalteva leikkaus (\koodi{\keno sl\-shape}) ja
kursiivileikkaus (\koodi{\keno it\-shape}) tuottavat saman
lopputuloksen. Niin on useimmissa muissakin fonteissa, mutta
käsitteellisesti ne ovat eri asia. Edellä mainitut komennot voivat
joissakin fonteissa valita eri leikkauksen. Kalteva leikkaus on
tavallisen eli pys\-ty\-asen\-toi\-sen leikkauksen kallistettu versio.
Kallistus on voitu tehdä mekaanisesti, mutta se voi olla myös
kirjainmuotoilijan piirtämä leikkaus. Kursiivi puolestaan on aina
muodoltaan erilainen leikkaus. Se hieman mukailee
käsi\-ala\-kir\-joi\-tusta, joskaan kirjaimia ei ole sidottu toisiinsa.

Komennot fontin koon valintaan ovat taulukossa
\ref{tlk:fonttikokokomennot}. Taulukko kertoo myös, mitä fontin
pistekokoa (pt) mikäkin komento tarkoittaa oletuksena. Oletus riippuu
Latexin dokumenttiluokkien (luku \ref{luku:dokumenttiluokat})
fonttikokovalitsimista \koodi{10pt}, \koodi{11pt} ja \koodi{12pt}.

\leijutlk{
  \begin{tabular}{lr@{}lr@{}lr@{}l}
    \toprule
    \ots{Komento}
    & \multicolumn{2}{c}{\ots{10pt}}
    & \multicolumn{2}{c}{\ots{11pt}}
    & \multicolumn{2}{c}{\ots{12pt}} \\
    \midrule
    \koodi{\keno tiny} & 5 && 6 && 6 \\
    \koodi{\keno scriptsize} & 7 && 8 && 8 \\
    \koodi{\keno footnotesize} & 8 && 9 && 10 \\
    \koodi{\keno small} & 9 && 10 && 10&,95 \\
    \koodi{\keno normalsize} & 10 && 10&,95 & 12 \\
    \koodi{\keno large} & 12 && 12 && 14&,4 \\
    \koodi{\keno Large} & 14&,4 & 14&,4 & 17&,28 \\
    \koodi{\keno LARGE} & 17&,28 & 17&,28 & 20&,74 \\
    \koodi{\keno huge} & 20&,74 & 20&,74 & 24&,88 \\
    \koodi{\keno Huge} & 24&,88 & 24&,88 & 24&,88 \\
    \bottomrule
  \end{tabular}
}{
  \caption{Fonttien oletuspistekoot dokumenttiluokkien valitsimilla
    \koodi{10pt}, \koodi{11pt} ja \koodi{12pt}}
  \label{tlk:fonttikokokomennot}
}

\pagebreak[3]

Kaikille korkean tason fonttikomennoille on olemassa myös samanniminen
ympäristönsä. Seuraavassa esimerkissä on kaksi fontteihin vaikuttavaa
ympäristöä sisäkkäin.

\pagebreak[3]

\begin{koodilohkosis}
  \begin{footnotesize}
    \begin{scshape}
      Tämä teksti on pienen pientä pienversaalia.
    \end{scshape}
  \end{footnotesize}
\end{koodilohkosis}

\begin{tulossis}
  \begin{footnotesize}
    \begin{scshape}
      Tämä teksti on pienen pientä pienversaalia.
    \end{scshape}
  \end{footnotesize}
\end{tulossis}

\pagebreak[3]

\subsection{Koot suhteellisesti}
\label{luku:fontti_suhteellinen}

Dokumentin fonttien koot on helpointa määrittää siten, että asettaa
ensin peruskirjainperheen koon ja antaa muiden fonttien määräytyä
suhteessa siihen. Esimerkki \ref{esim:fontti_suhteellinen} selventää,
kuinka se tapahtuu. Alussa otetaan käyttöön dokumenttiluokka
\koodi{article} ja annetaan sille valitsin \koodi{10pt}, joka määrittää
fonttikooksi 10 pistettä. Se on dokumenttiluokan ole\-tus\-ase\-tus,
jota ei tarvitsisi edes kirjoittaa näkyviin. Esimerkin toisella rivillä
otetaan \paketti{fontspec}\-/paketti käyttöön.

Peruskirjainperheen (rivi~4) koko skaalataan 1,4\-/kertaiseksi, eli
pistekooksi tulee 1,4 kertaa 10 pistettä eli 14 pistettä (pt).
Normaalikokoinen peruskirjainperhe on ainoa, jonka pistekoko tiedetään.
Kaikkien muiden koot täytyisi selvittää laskemalla.

Groteski eli pääteviivaton kirjainperhe (rivi~5) ja tasalevyinen perhe
(rivi~6) skaalataan samankorkuiseksi kuin perusperhe. Vertailukohtana
ovat gemenat eli pienaakkoset (\koodi{MatchLowercase}). Näiden kahden
kirjainperheen pistekokoa ei tiedetä. Se ei välttämättä ole sama kuin
perusfontissa, koska fonttien pistekoko mitataan ylimmän ja alimman
kohdan välillä ja koska fonttien mittasuhteet ovat erilaisia.

\begin{esimerkki*}
\begin{koodilohko}
  \documentclass[10pt]{article} % 10pt on oletus
  \usepackage{fontspec}

  \setmainfont{TeX Gyre Termes}[Scale=1.4]
  \setsansfont{TeX Gyre Heros} [Scale=MatchLowercase]
  \setmonofont{TeX Gyre Cursor}[Scale=MatchLowercase]
  \linespread{1.45}
\end{koodilohko}
\caption{Fonttikokojen määrittäminen suhteessa peruskirjainperheeseen}
\label{esim:fontti_suhteellinen}
\end{esimerkki*}

Viimeisellä rivillä oleva \koodi{\keno linespread}\-/komento on tärkeä.
Se asettaa rivikorkeuden kertoimeksi 1,45. Kertoimen täytyy olla
vähintään yhtä suuri kuin peruskirjainperheen skaalauskerroin (1,4),
jotta rivivälit ovat riittävän suuret. Näiden asetusten jälkeen
dokumentissa käytetään korkeamman tason komentoja fonttien valintaan,
esimerkiksi fonttikoon valintakomentoja \koodi{\keno small},
\koodi{\keno normalsize}, \koodi{\keno large} (taulukko
\ref{tlk:fonttikokokomennot}).

Edellä kuvatussa suhteellisessa kirjainperheiden koon määrittelyssä on
sellainen ongelma tai kummallisuus, että Latex koko ajan luulee, että
peruskirjainperhe on normaalikokoisena 10 pistettä (pt). Latexin matalan
tason fonttikomennot eivät tiedä kirjainperheen skaalauskertoimesta, ja
siksi esimerkiksi komentojen

\begin{koodilohkosis}
  \fontsize{10bp}{12bp} \selectfont
\end{koodilohkosis}

tuloksena ei todellisuudessa ole 10 pisteen (bp) fontti, vaan mukaan
lasketaan myös kirjainperheen skaalauskerroin. Tämän vuoksi \koodi{\keno
  fontsize}\-/komennon käyttö menee aika oudoksi. Argumenttina annettu
kokomitta ei pidä paikkaansa.

Jos korkean tason font\-ti\-koko\-komen\-to\-jen (taulukko
\ref{tlk:fonttikokokomennot}) lisäksi tarvitaan jotakin muuta kokoa,
voisi mahdollisesti \koodi{\keno fontsize}\-/komennon sijasta käyttää
\paketti{fontspec}\-/paketin tarjoamaa komentoa ja tilanteeseen sopivaa
skaalauskerrointa esimerkiksi seuraavalla tavalla:

\begin{koodilohkosis}
  {\addfontfeatures{Scale=3.2}Poikkeuksellisen isoa tekstiä}
\end{koodilohkosis}

Jos edellä mainitut kummallisuudet eivät häiritse eikä ole tarvetta
määritellä fontteja tarkasti tietyn pistekoon mukaiseksi, on
suhteellinen määrittelytapa todella helppo. Kaikki dokumentin fontit
määräytyvät perusfontin skaalauskertoimen kautta. Tämä tapa sopii hyvin
varsinkin dokumentin sisällön kirjoittamisvaiheeseen, jossa ehkä
halutaan vain nopeasti asettaa dokumentti suurin piirtein järkevän
näköiseksi. Myöhemmin voi määrittää koot tarkemmin niin sanotun
absoluuttisen menetelmän avulla, jota käsitellään seuraavassa luvussa.

\subsection{Koot absoluuttisesti}
\label{luku:fontti_absoluuttinen}

Absoluuttinen fonttien koonmääritystapa tarkoittaa sitä, että koot
asetetaan tietyn kokoiseksi käyttämällä esimerkiksi pistemittoja ja että
kirjaimet myös päätyvät lopulliseen dokumenttiin juuri sen kokoisena.
Tämä tapa on myös teknisesti eheä, eli Latexin eri osat ovat samaa
mieltä siitä, minkäkokoisesta fontista on kyse. Näin ei ollut
suhteellisen tavan kanssa (luku \ref{luku:fontti_suhteellinen}).

Joskus yrityksen, oppilaitoksen tai muun julkaisijan ohjeissa
määritellään tarkasti, mitä fontteja käytetään ja mikä on leipätekstin
ja otsikoiden fonttikoko. Silloin tarvitaan tässä luvussa kuvattua tapaa
fonttien asettamiseen.

\begin{esimerkki*}
\begin{koodilohko}
  \documentclass{article}
  \usepackage{fontspec}

  % Leipätekstiin samankokoiset fontit
  \setmainfont{TeX Gyre Termes}
  \setsansfont{TeX Gyre Heros} [Scale=MatchLowercase]
  \setmonofont{TeX Gyre Cursor}[Scale=MatchLowercase]

  % Muualle sans ja mono ilman skaalausta
  \newfontfamily{\sffamilyabs}{TeX Gyre Heros}
  \newfontfamily{\ttfamilyabs}{TeX Gyre Cursor}

  \linespread{1} % ei välttämättä tarvita

  % Kaikki tarvittavat fonttikoot ja komennot
  \renewcommand{\footnotesize}{\fontsize{10bp}{12bp}\selectfont}
  \renewcommand{\small}       {\fontsize{12bp}{14bp}\selectfont}
  \renewcommand{\normalsize}  {\fontsize{14bp}{17bp}\selectfont}
  \renewcommand{\large}       {\fontsize{17bp}{19bp}\selectfont}
  \renewcommand{\Large}       {\fontsize{20bp}{22bp}\selectfont}
  \normalsize % jotta tulee heti voimaan eikä vasta tekstiosassa
\end{koodilohko}
\caption{Fonttikokojen määrittäminen pistekoon avulla}
\label{esim:fontti_absoluuttinen}
\end{esimerkki*}

Esimerkistä \ref{esim:fontti_absoluuttinen} selviää perus\-ajatus.
Peruskirjainperhe (rivi~5) otetaan käyttöön ilman skaalausta (eli
\koodi{Scale=1}), minkä vuoksi koon voi jatkossa asettaa täsmälleen
kohdalleen \koodi{\keno fontsize}\-/komennolla. Samaa ei tehdä groteskin
eikä tasalevyisen fontin kanssa (rivit 6--7), vaan käytetään skaalausta
\koodi{MatchLowercase}, jotta tekstikappaleessa kaikki kirjainperheet
näyttävät samankokoisilta. Tässä menetetään mahdollisuus määrittää
näiden kirjainperheiden koko täsmällisesti pistemitan avulla. Jos siihen
on tarvetta esimerkiksi otsikoissa, voidaan käyttää rivien 10--11
komentoja. Niillä luodaan uudet kirjainperheet, jotka ovat käytännössä
samoja mutta ilman skaalausta.

Uusien kirjainperheiden komentojen nimiksi on valittu \koodi{\keno
  sf\-fam\-i\-ly\-abs} ja \koodi{\keno tt\-fam\-i\-ly\-abs} (vrt.
\koodi{\keno sf\-fam\-i\-ly} ja \koodi{\keno tt\-fam\-i\-ly}, taulukko
\ref{tlk:fonttimallikomennot}), ja näillä komennoilla kirjainperheet
kytketään päälle. Jos esimerkiksi jonkin julkaisun vaatimuksiin kuuluu,
että otsikossa täytyy olla 16 pisteen lihavoitu TeX Gyre Heros
\=/kirjainleikkaus, voi esimerkissä \ref{esim:fontti_absoluuttinen}
olevien asetusten pohjalta antaa otsikolle seuraavat komennot:

\begin{koodilohkosis}
  \sffamilyabs\fontsize{16bp}{18bp}\bfseries
\end{koodilohkosis}

Esimerkin \ref{esim:fontti_absoluuttinen} riveillä 16--20 määritellään
uudelleen Latexin korkean tason komennot, joilla fonttikoot asetetaan.
Oletus\-arvot tulevat dokumenttiluokasta (luku
\ref{luku:dokumenttiluokat}), mutta jos ne eivät ole sopivia, täytyy
vähintäänkin määritellä komento \koodi{\keno normal\-size} mutta sen
lisäksi kaikki ne koot, joita omassa dokumentissa tarvitaan. Tässä
esimerkissä normaali koko asetetaan 14 pisteen kokoiseksi.

Jokaiselle fonttikoolle määritetään riveillä 16--20 myös oma
rivikorkeus, ja se on tarkoitus asettaa sopivaksi juuri kyseiselle
koolle. Rivikorkeuteen vaikuttaa myös kerroin \koodi{\keno
  baselinestretch}, joka asetetaan komennolla \koodi{\keno linespread}.
Sitä ei välttämättä tarvitse käyttää, koska kirjainperheitä ei ole
skaalattu ja koska rivikorkeus asetetaan aina \koodi{\keno
  fontsize}\-/komennolla. \koodi{\keno linespread} on kuitenkin kätevä
komento rivikorkeuden säätämiseen yleisesti kaikkialla.

Fonttikokojen määrittelyn lopuksi rivillä 21 suoritetaan komento
\koodi{\keno normal\-size}, jotta se tulee heti voimaan. Dokumentin
esittelyosassa voidaan käyttää fonttikokoon viittaavia mittoja
\koodi{em} ja \koodi{ex}, ja ne viittaavat nyt tähän kokoon.
\koodi{\keno normal\-size}\-/komento suoritetaan kyllä myöhemmin
automaattisesti dokumentin tekstiosan eli \koodi{document}\-/ympäristön
alussa.

Edellä kuvatun absoluuttisen koonmääritystavan etuna on se, että
kirjoittaja hallitsee fonttien kokoa ja rivikorkeuksia tarkasti ja että
julkaisuun saadaan juuri ne mitat, jotka halutaan tai vaaditaan. Tapa on
myös teknisesti eheä eli toimii Latexin sisäisen logiikan näkökulmasta
oikein. Haittana voi pitää sitä, että kaikki koot täytyy määritellä
erikseen.

\subsection{Typografiset ligatuurit}

Typografiset ligatuurit ovat fontissa olevia yhdistelmämerkkejä, joissa
on typografisista syitä yhdistetty kaksi tai useampia kirjaimia yhteen
merkkiin.%
\footnote{Typografisten ligatuurien lisäksi on olemassa myös
  luonnollisten kielten ligatuureja, jotka muodostavat kieleen kuuluvan
  kirjaimen, kuten æ norjan kielessä. Niillä on jokin luonnolliseen
  kieleen liittyvä merkitys, eikä eri merkkejä ei ole yhdistetty
  typografisista syistä.} Tällaisia ligatuureja käytettiin jo
metalliladonnassa, eli samassa metallikirjakkeessa saattoi olla enemmän
kuin yksi kirjain.

Typografisten ligatuurien tarkoituksena on tuottaa tyylikkäämpi
lopputulos kuin saataisiin erillisten kirjainten avulla. Syynä on
esimerkiksi se, että erilliset peräkkäiset kirjaimet eivät ole aina
keskenään yhteensopivia. Kirjainten välistys voi olla ongelmallista:
sopivalle etäisyydelle asetettaessa kirjainten osat voivat mennä
rumannäköisesti päällekkäin. Riippuu fontista, mitkä ligatuurit ovat
tarpeellisia ja mitkä ligatuurimerkit on ylipäätään toteutettu fontin
merkistöön. Tavallisia antiikvafonttien ligatuureja ovat fi, ff, ffi, fl
ja ffl, mutta jotkin fontit sisältävät muitakin. Kuvaan
\ref{kuva:ligatuurit} on koottu erilaisia ligatuureja.

\leijukuva{
  \addfontfeatures{Scale=3.5, Ligatures={Common, Historic}}
  fi ff ffi fl ffl Th fb st ct
}{
  \caption{Tavalliset f\=/alkuiset ligatuurit, vähän harvinaisemmat Th
    ja fb sekä erikseen päälle kytkettävät historialliset ligatuurit st
    ja ct}
  \label{kuva:ligatuurit}
}

Latex hoitaa tavallisten typografisten ligatuurien latomisen
automaattisesti, eli lähdedokumenttiin ei kannata kirjoittaa
Unicode\-/merkistön typografisia ligatuurimerkkejä (esimerkiksi
\uctunnus{u+fb01 latin small ligature fi}) vaan ihan tavallisia
erillisiä kirjaimia. Open Type \=/fontin suunnittelija on päättänyt
meidän puolestamme, mitkä kir\-jain\-yh\-dis\-tel\-mät on parasta latoa
ligatuurin avulla, ja ole\-tus\-ase\-tuk\-sil\-la Latex noudattaa niitä
ohjeita.

Jos kuitenkin yksittäisen ligatuurin muodostumisen haluaa estää, voi
kirjainten väliin kirjoittaa komennon \koodi{\keno
  text\-comp\-word\-mark}, joka tekee näkymättömän, juuri tähän
tarkoitukseen olevan merkin \uctunnus{u+200c zero width non-joiner}.

\pagebreak[3]

\begin{koodilohkosis}
  \Large
  fi f\textcompwordmark i
\end{koodilohkosis}

\begin{tulossis}
  \Large
  fi f\textcompwordmark i
\end{tulossis}

Mikäli tavallisia ligatuureja ei halua käyttöön lainkaan, on parasta
valita jo kirjainperheen tai \=/leikkauksen käyttöönotossa asetus
\koodi{Liga\-tures=No\-Com\-mon}. Väliaikaisesti fontin asetuksiin voi
vaikuttaa komennolla \koodi{\keno add\-font\-fea\-tures}, joka sekin on
\paketti{fontspec}\-/pakettiin sisältyvä komento.

\begin{koodilohkosis}
  \setmainfont{…}[Ligatures=NoCommon] % Kirjainperheen yleisasetus.
  {\addfontfeatures{Ligatures=NoCommon} fi fl} % Väliaikaisesti.
\end{koodilohkosis}

Tavallisten ligatuurien lisäksi Open Type \=/fontit voivat sisältää myös
harvinaisempia ligatuureja, jotka täytyy erikseen kytkeä päälle. Niiden
tarkoituksena on esimerkiksi erityinen koristeellisuus tai
historiallisen kirjoitustavan jäljittely. Harvinaisia ligatuureja ei ole
tarkoitus käyttää joka tilanteessa vaan ainoastaan erityisestä syystä.
Kuvan \ref{kuva:ligatuurit} st- ja ct\-/ligatuurit on saatu fontin
asetuksella \koodi{Liga\-tures=His\-toric}. Muita
li\-ga\-tuu\-ri\-ase\-tuk\-sia kannattaa tutkia
\paketti{fontspec}\-/paketin ohjekirjasta.

\subsection{Fonttivinkkejä KESKEN}

% setmainfont=groteski (\rmfamily), entä setsansfont?

\section{Kieli}
\label{luku:kieliasetukset}

\subsection{Polyglossia}
\subsection{Babel}

\section{Tavutus}
\label{luku:tavutus}

\subsection{Perustoiminta}

Latex\-/järjestelmä tavuttaa eli katkaisee sanat automaattisesti rivien
lopussa, jotta rivit ja kappaleet saisi näyttämään tasapainoisilta.
Tavutukseen vaikuttavat kielikohtaiset tavutussäännöt ja \=/asetukset
sekä \koodi{\keno hyphenation}\-/komennolla määritellyt säännöt.
Yksittäisen sanan tavutukseen voi vaikuttaa myös tiettyjen sanassa
mukana olevien merkkien avulla. Niitä käsitellään seuraavissa
alaluvuissa.

Mitat \koodi{\keno lefthyphenmin=N} ja \koodi{\keno righthyphenmin=N}
vaikuttavat tavutukseen sanan reunoissa. Parametri \koodi{N} on
positiivinen kokonaisluku, ja se määrittää, kuinka monta merkkiä
vähintään sanan vasemmasta tai oikeasta reunasta pidetään yhdessä.
Oletus\-arvot ovat kielikohtaisia ja määritellään
\paketti{polyglossia}\-/{} ja \paketti{babel}\-/paketeissa. Suomen
kielessä kumpikin mitta on 2~merkkiä.

Mitat alustetaan kielikohtaisiin oletus\-arvoihin aina, kun
kie\-li\-ase\-tuk\-set tulevat voimaan. Näin on esimerkiksi dokumentin
aloittavan \koodi{document}\-/ympäristön alussa tai kielen vaihtuessa.
Tästä seuraa, että jos mittoja ha\-luaa muuttaa, täytyy ne asettaa
\koodi{document}\-/ympäristön alussa tai aina kielen vaihtamisen
jälkeen.

Omat kieli\-asetukset saa mukaan automaattiseksi, kun lisää muutokset
kielikohtaisiin alustuskomentoihin alla olevan esimerkin mukaisesti.
Tällä tavoin omat asetukset tulevat voimaan samalla kuin muutkin
kie\-li\-ase\-tuk\-set. Esimerkissä oleva komento \koodi{\keno add\-to}
on \paketti{polyglossia}\-/{} ja \paketti{babel}\-/paketin ominaisuus.

\begin{koodilohkosis}
  \addto{\captionsfinnish}{
    \lefthyphenmin=3
    \righthyphenmin=3
  }
\end{koodilohkosis}

Tavutukseen voi vaikuttaa myös \koodi{\keno hyphenation}\-/komennolla,
jolla määritellään yksittäisten sanojen tavutuskohdat kaikkialla
dokumentissa, riippumatta kielestä. Seuraava esimerkki selventää
\koodi{\keno hyphenation}\-/komennon käyttöä.

\begin{koodilohkosis}
  \hyphenation{
    nimen-omaan
    poh-jois-euroop-pa-lai-nen
    inter-net-ope-raat-to-ri
  }
\end{koodilohkosis}

\subsection{Tavutukseen vaikuttavat merkit}

Tietyt sanassa olevat merkit kytkevät muut tavutussäännöt pois päältä ja
muuttavat sanan tavutuksen yksilölliseksi. Jos sanassa on mukana yksikin
tavutusvihje (\koodi{\keno-}), yhdysmerkki (\koodi{-}), lyhyt
ajatusviiva (\koodi{--}) tai pitkä ajatusviiva (\koodi{---}), sana
katkaistaan vain näiden kohdalta (\koodi{\keno-}) tai jälkeen.

\leijutlk{
  \begin{tabular}{lll}
    \toprule
    \ots{Lähde}
    & \ots{Tavutus}
    & \ots{Selitys} \\
    \midrule
    \koodi{matkustaa}
    & mat\tavukohta kus\tavukohta taa
    & tavutus kaikista kohdista \\
    \koodi{matkus\keno-taa}
    & matkus\tavukohta taa
    & vain tavutusvihjeen kohdalta \\
    \koodi{matka-aika}
    & matka-\tavukohta aika
    & vain yhdysmerkin jälkeen \\
    \koodi{matka-ai\keno-ka}
    & matka-\tavukohta ai\tavukohta ka
    & vain yhdysmerkki ja tavutusvihje \\
    \koodi{Oulu--Rovaniemi}
    & Oulu--\tavukohta Rovaniemi
    & vain ajatusviivan jälkeen \\
    \koodi{Oulu--Rova\keno-niemi}
    & Oulu--\tavukohta Rova\tavukohta niemi
    & vain ajatusviiva ja tavuvihje \\
    \koodi{matka-}
    & matka-
    & ei tavutuskohtia \\
    \koodi{-aika}
    & -\tavukohta aika
    & vain yhdysmerkin jälkeen \\
    \bottomrule
  \end{tabular}
}{
  \caption{Tavutusvihjeen, yhdysmerkin ja ajatusviivan vaikutus
    tavutukseen}
  \label{tlk:tex-tavutus}
}

Taulukossa \ref{tlk:tex-tavutus} on esimerkkejä tavutusvihjeiden,
yhdysmerkin ja ajatusviivan vaikutuksesta. Ensimmäisessä sarakkeessa on
esimerkkisana siinä muodossa kuin se kirjoitetaan lähdetiedostoon.
Toisessa sarakkeessa on ladottu sana, johon on punaisella pystyviivalla
merkittynä mahdolliset tavutuskohdat.

Viimeinen rivi paljastaa suomen kielen kannalta ongelmallisen tilanteen.
Esimerkiksi ilmauksessa \emph{matkasuunnitelma ja \mbox{-aika}} ei sanaa
saa katkaista yhdysmerkin jälkeen, koska rivin loppuun jäisi yksinäinen
yhdysmerkki. Latexin peruskeinoilla sana täytyy laittaa näkymättömään
laatikkoon, joka pitää merkit yhdessä: \koodi{\keno mbox\{-aika\}}.
Toinen vaihtoehto on sitovan yhdysmerkin käyttö, johon onkin monenlaisia
toteutuksia. Niistä kerrotaan seuraavissa luvuissa.

\subsection{Unicoden sitova yhdysmerkki}
\label{luku:unicode_sitova}

Unicode-merkistön sitova yhdysmerkki \uctunnus{u+2011 non\-/breaking
  hyphen} näkyy tavallisena yhdysmerkkinä, mutta se estää sanan
katkaisemisen yhdysmerkin vierestä. Sitovaa yhdysmerkkiä voi käyttää
Xelatex\-/kääntäjän kanssa. Sen sijaan Lualatex\-/kääntäjä vain kadottaa
koko merkin.

Tavallinen yhdysmerkki \uctunnus{u+002d hyphen\-/minus} ja Unicoden
sitova yhdysmerkki \uctunnus{u+2011} vaikuttavat sanan tavuttamiseen eri
tavalla. Tavallinen yhdysmerkki estää sanan tavuttamisen muualta kuin
yhdysmerkin jälkeen. Unicoden sitova yhdysmerkki puolestaan sallii sanan
tavuttamisen kaikista normaaleista tavutuskohdista. Ainoastaan sitovan
yhdysmerkin vierestä ei katkaista.

\leijutlk{%
  \begin{tabular}{ll}
    \toprule
    \ots{Lähde}
    & \ots{Tavutus} \\
    \midrule
    \koodi{Latex-järjestelmä}
    & Latex-\tavukohta järjestelmä \\
    \koodi{Latex\sitovaym järjestelmä}
    & La\tavukohta tex-jär\tavukohta jes\tavukohta tel\tavukohta mä \\
    \koodi{-järjestelmä}
    & -\tavukohta järjestelmä \\
    \koodi{\sitovaym järjestelmä}
    & -jär\tavukohta jes\tavukohta tel\tavukohta mä \\
    \bottomrule
  \end{tabular}
}{%
  \caption{Tavallisen ja Unicoden sitovan yhdysmerkin (punaisella)
    vaikutus tavutukseen}
  \label{tlk:unicode-yhdysmerkki}
}

Taulukossa \ref{tlk:unicode-yhdysmerkki} vertaillaan yhdysmerkkejä.
Viimeinen rivi osoittaa, että Unicoden sitovan yhdysmerkin avulla voi
estää sen, että yhdysmerkillä alkava sana katkaistaisiin heti
yhdysmerkin jälkeen eli merkki jäisi yksinään rivin loppuun.

\subsection{Pakettiratkaisuja}

Makropaketti \paketti{extdash} tuo uusia komentoja ja mahdollisuuksia
tavutuksen hallintaan. Komennot ovat sellaisia kuin \koodi{\keno
  Hyph\-dash} ja \koodi{\keno En\-dash}, mutta niille on saatavilla myös
lyhemmät muodot, jos paketin lataa käyttämällä
\koodi{short\-cuts}\-/valitsinta.

\begin{koodilohkosis}
  \usepackage[shortcuts]{extdash}
\end{koodilohkosis}

Paketti sisältää kaksi lisä\-vaihto\-ehtoa kolmelle viivavälimerkille
eli yhdysmerkille, lyhyelle ajatusviivalle ja pitkälle ajatusviivalle.
Kun Latexin viivavälimerkit aina estävät tavutuksen muualta kuin
välimerkin jälkeen, \paketti{extdash}\-/paketin perus\-vaihto\-ehdot
sallivat tavuttamisen. Lisäksi kaikille kolmelle viivavälimerkille on
sitova versio, joka estää tavutuksen viivavälimerkin jälkeen. Taulukossa
\ref{tlk:extdash} on \paketti{extdash}\-/paketin tärkeimmät komennot ja
niiden merkitykset. Taulukossa \ref{tlk:extdash-vertailu} vertaillaan
\paketti{extdash}\-/paketin komentoja Latexin vastaaviin.

\leijutlk{
  \begin{tabular}{ll}
    \toprule
    \ots{Komento} & \ots{Merkitys} \\
    \midrule
    \koodi{\keno -/} & tavutuksen salliva yhdysmerkki \\
    \koodi{\keno =/} & sitova, tavutuksen salliva yhdysmerkki \\
    \koodi{\keno --} & tavutuksen salliva lyhyt ajatusviiva \\
    \koodi{\keno ==} & sitova, tavutuksen salliva lyhyt ajatusviiva \\
    \koodi{\keno ---} & tavutuksen salliva pitkä ajatusviiva \\
    \koodi{\keno ===} & sitova, tavutuksen salliva pitkä ajatusviiva \\
    \bottomrule
  \end{tabular}
}{
  \caption{\paketti{extdash}-paketin komentoja}
  \label{tlk:extdash}
}

\leijutlk{
  \begin{tabular}{llll}
    \toprule
    \ots{Lähde} & \ots{Tavutus}
    & \ots{Lähde} & \ots{Tavutus} \\
    \midrule
    \koodi{matka-aika}
                & matka-\tavukohta aika
                & \koodi{Oulu--Rovaniemi}
                & Oulu--\tavukohta Rovaniemi \\
    \koodi{matka\keno -/aika}
                & mat\tavukohta ka-\tavukohta ai\tavukohta ka
                & \koodi{Oulu\keno --Rovaniemi}
                & Ou\tavukohta lu--\tavukohta Ro\tavukohta va\tavukohta
                  nie\tavukohta mi \\
    \koodi{matka\keno =/aika}
                & mat\tavukohta ka-ai\tavukohta ka
                & \koodi{Oulu\keno ==Rovaniemi}
                & Ou\tavukohta lu--Ro\tavukohta va\tavukohta
                  nie\tavukohta mi \\
    \koodi{matka-}
                & matka-
                & \koodi{-aika}
                & -\tavukohta aika \\
    \koodi{matka\keno -/}
                & mat\tavukohta ka-
                & \koodi{\keno =/aika}
                & -ai\tavukohta ka \\
    \bottomrule
  \end{tabular}
}{
  \caption{Latexin ja \paketti{extdash}-paketin komentojen vertailua}
  \label{tlk:extdash-vertailu}
}

Kieli\-asetuksia hoitavan \paketti{polyglossia}\-/paketin uudehkot
versiot (2020\==) tukevat suomen kielelle
\koodi{babel\-short\-hands}\-/valitsinta, joka lisää keinovalikoimaan
\paketti{babel}\-/paketista peräisin olevia tavutuksen
hallintakomentoja. On esimerkiksi tavutuksen salliva yhdysmerkki
(\koodi{\textquotedbl-}), joka toimii samoin kuin
\paketti{extdash}\-/paketin \koodi{\keno-/}.

Mukana on myös sitova, kaiken tavutuksen estävä yhdysmerkki
(\koodi{\textquotedbl\textasciitilde}), jolle ei ole vastinetta Texissä
eikä \paketti{extdash}\-/paketissa -- muuten kuin \koodi{\keno
  mbox}\-/laatikon avulla. \paketti{polyglossia}\-/paketin ''Baabelin
lyhenteet'' sisältävät eräitä muitakin hyödyllistä sanan katkaisemiseen
liittyviä komentoja.

Dokumentin otsikoissa (\koodi{\keno section} ym.) täytyy olla varovainen
\paketti{extdash}\-/paketin komentojen kanssa. Ne toimivat ladotussa
dokumentissa, mutta \paketti{hyperref}\-/paketin avulla syntyvässä
pdf\-/tiedoston sisällysluettelossa ne eivät näy oikein. Ongelman voi
kiertää käyttämällä Latexin otsikkokomentojen valinnaista parametria,
jolla määritellään erikseen sisällysluettelossa näytettävä otsikko. Sen
avulla varsinainen otsikko voi sisältää monimutkaisempia komentoja ja
sisällysluetteloon tuleva versio vain tekstiä ja tavutusvihjeitä.

\begin{koodilohkosis}
  \section[Latex-jär\-jes\-tel\-mä]{\LaTeX\-/järjestelmä}
\end{koodilohkosis}

Otsikot voivat vaatia tavutusvihjeitä silloin, kun niihin viitataan
tekstistä komennolla \koodi{\keno nameref} tai kun otsikko itsessään on
pitkä ja täytyy jakaa useammalle riville.

\subsection{Johtopäätökset}

Suomenkielisen tekstin kirjoittamiseen tarvittaneen välillä
\paketti{extdash}\-/paketin tavutus\-apuja, koska kielessä on pitkiä
yhdysmerkin tai ajatusviivan sisältäviä yhdyssanoja kuten
\emph{Molotov\--Ribben\-trop\-/sopimus} tai
\emph{kognitiivis\-/behavioristinen}. Rivejä ei välttämättä saa
siisteiksi, ellei pitkissä yhdyssanoissa salli tavuttamista muualtakin
kuin yhdysmerkin jälkeen. Tavutusvihjeitä voi toki lisäillä käsin, mutta
se voi käydä joskus työlääksi.\footnote{Esimerkiksi:
  \koodi{kog\keno-ni\keno-tii\keno-vis-%
    be\keno-ha\keno-vio\keno-ris\keno-ti\keno-nen}} Tässä oppaassa ja
edellä mainituissa esimerkkisanoissa on käytetty
\paketti{extdash}\-/paketin yhdysmerkkiä \koodi{\keno -/} ja
ajatusviivaa \koodi{\keno --}, joten tavutus hoituu itsestään.

Unicoden sitovaa yhdysmerkkiä (luku \ref{luku:unicode_sitova}) ei ehkä
kannata käyttää, koska Lualatex\-/kääntäjä kadottaa koko merkin. Merkki
kyllä toimii Xelatex\-/kääntäjällä, mutta \paketti{extdash}\-/paketti
tarjoaa kaikkialla toimivan vaihtoehdon sitovalle yhdysmerkille
(\koodi{\keno =/}).

Pdf-tiedostojen sisäinen sisällysluettelo syntyy
\paketti{hyperref}\-/paketin avustuksella itsestään dokumentin
otsikoista (\koodi{\keno section} ym.). Otsikoissa kannattanee käyttää
tavutuksessa vain Latexin perustoimintoja eli tavallisia yhdysmerkkejä
ja tavutusvihjeitä (\koodi{\keno-}), koska erikoisemmat komennot eivät
näy pdf:n sisällysluettelossa oikein.

Jos \paketti{extdash}\-/paketin toimintojen lisäksi tarvitsee sitovaa,
kaiken tavutuksen estävää yhdysmerkkiä (esimerkiksi
\koodi{\textquotedbl\textasciitilde aika}), täytyy käyttää myös
\paketti{polyglossia}\-/paketin ''Baabelin lyhenteitä''. Seuraava
esimerkki näyttää, kuinka kaikki mainitut toiminnot kytketään päälle.

\begin{koodilohkosis}
  \usepackage{polyglossia}
  \usepackage[shortcuts]{extdash}
  \setdefaultlanguage[babelshorthands]{finnish}
\end{koodilohkosis}

\subsection{Tavutus pois päältä KESKEN}
