% Tekijä:   Teemu Likonen <tlikonen@iki.fi>
% Lisenssi: Creative Commons Nimeä-JaaSamoin 4.0 Kansainvälinen (CC BY-SA 4.0)
%           https://creativecommons.org/licenses/by-sa/4.0/legalcode.fi

\chapter{Dokumentin asetukset}

Dokumentin yleiset asetukset koostuvat Latexissa dokumenttiluokan
valinnasta (luku \ref{luku:dokumenttiluokat}), sivun koon ja
marginaalien määrittelystä (luku \ref{luku:sivuasetukset}), fonttien
määrittelystä (luku \ref{luku:kirjaintyypit}) sekä kieliasetuksista
(luku \ref{luku:kieliasetukset}).

Kaikkia asetuksia ei tarvitse päättää alussa, ja on ehkä jopa
suotavaakin keskittyä aluksi lähinnä dokumentin sisällön ja rakenteen
suunnitteluun ja tuottamiseen. Ulkoasuun kyllä ehtii tulla
kirjoittamisen aikana monenlaisia ajatuksia, joita ei olisi välttämättä
alussa osannut huomioida. Kirjoittamaan pääsee hyvinkin yksinkertaisen
dokumenttirungon avulla (esim. \ref{esim:ensimmainen},
s.~\pageref{esim:ensimmainen}), mutta tässä luvussa käsitellään
asetusten määrittelyä ja mahdollisuuksia melko perusteellisesti.

\section{Dokumenttiluokat}
\label{luku:dokumenttiluokat}

Latexin lähdedokumenttien alussa on aina samankaltainen rivi, joka
määrittelee käytettävän dokumenttiluokan ja mahdollisesti dokumentin
pe\-rus\-ase\-tuk\-sia. Dokumenttiluokka määritellään komennolla
\koodi{\keno documentclass} ja sen argumentiksi annetaan
dokumenttiluokan nimi. Valinnaisilla argumenteilla vaikutetaan
asetuksiin.

\begin{koodilohkosis}
  \documentclass[a4paper, 12pt]{article}
\end{koodilohkosis}

Dokumenttiluokka on eräänlainen pohjadokumentti eli ominaisuuksien ja
asetusten kokoelma, jonka varaan oma dokumentti kirjoitetaan. Eri
dokumenttiluokat sisältävät erilaisia ominaisuuksia ja erilaiset
oletusasetukset. Edellä olevassa esimerkissä käytettiin
\koodi{article}\-/luokkaa, joka on yleiskäyttöinen luokka
monenlaisten dokumenttien kirjoittamiseen.

Seuraavissa alaluvuissa käsitellään tavallisimpia dokumenttiluokkia ja
niiden asetuksia. Dokumenttiluokkia voi tehdä itsekin, ja sitä aihetta
käsitellään luvussa \ref{luku:omat_dokumenttiluokat}.

\subsection{Perusdokumenttiluokat}

Muutama dokumenttiluokka kuuluu Latexin perusvalikoimaan, eli ne ovat
aina saatavilla ja asennettuna, kun itse Latexkin on. Niitä kutsutaan
välillä standardeiksi dokumenttiluokiksi, ja ne ovat ikään kuin
muuttumattomia perusluokkia, joiden varaan on turvallista rakentaa omia
dokumentteja tai muita dokumenttiluokkia. Muita dokumenttiluokkia
kehitetään Latexin perusosien ulkopuolella, ja niiden ominaisuudet
voivat muuttua ja kehittyä nopeammin ajan myötä.

Normaalit paperisivuihin perustuvat dokumentit tehdään luokkien
\koodi{article}, \koodi{report} tai \koodi{book} avulla.
\koodimargin{article} \koodimargin{report} \koodimargin{book} Ne ovat
keskenään hyvin samanlaisia, mutta niiden oletusasetukset poikkeavat
toisistaan. Karkeasti jaoteltuna \koodi{article}\-/luokka on tarkoitettu
lyhyehköille artikkeleille ja yleiseksi perustaksi monenlaisille
dokumenteille. Sen sijaan \koodi{report} ja \koodi{book} on tarkoitettu
laajoihin dokumentteihin, ja niissä on kirja\-typo\-grafian piirteitä.

Suurin edellä mainittujen perusluokkien ero on otsikoinnissa ja
dokumentin jäsentämisessä: \koodi{report} ja \koodi{book}
sisältävät suuret pääluvut (\koodi{\keno chapter}) eli otsikot, jotka
alkavat tyhjältä sivulta; \koodi{article} ei sisällä samanlaisia
päälukuja vaan ainoastaan tavalliset leipätekstin mukana kulkevat
väliotsikot (\koodi{\keno section}, \koodi{\keno subsection}
jne.). Otsikointia ja tekstin jäsentämistä käsitellään tarkemmin luvussa
\ref{luku:otsikot}.

Toinen ero perusluokkien välillä on se, että vain \koodi{book}\-/luokka
sisältää komennot \koodi{\keno frontmatter}, \koodi{\keno mainmatter} ja
\koodi{\keno backmatter}, joita voi käyttää ilmaisemaan tietokirjan
erityyppiset osat: alkusivut, varsinaiset sisältösivut ja liitesivut.
Näitä käsitellään luvussa \ref{luku:frontmainbackmatter}. Lisäksi
\koodi{report}\-/luokka sisältää ympäristön \koodi{ab\-stract}, joka on
tarkoitettu tekstin tiivis\-telmä\-osan tekemiseen;
\koodi{book}\-/luokassa sitä ei ole.

Muut erot koskevat lähinnä oletusasetuksia, mutta asetukset ovat
tietenkin muutettavissa, eivätkä ne siten ole määräävä tekijä
valittaessa luokkien \koodi{article}, \koodi{report} ja
\koodi{book} välillä. Dokumenttiluokkien asetuksia käsitellään
seuraavassa alaluvussa.

Muita perusdokumenttiluokkia ovat \koodi{let\-ter} \koodimargin{letter}
ja \koodi{slides}. Nimensä mukaisesti \koodi{let\-ter} on kirjeiden
kirjoittamista varten. Se sisältää kirjeen tyypilliseen rakenteeseen
liittyviä komentoja ja soveltuu varsinkin tarpeisiin, joissa täytyy
automaattisesti tuottaa samanmuotoisia kirjeitä usealle
vas\-taan\-otta\-jalle. Sama Latex\-/dokumentti voi sisältää useita
kirjeitä, ja sivunumerointi ja alaviitteiden numerointi alkaa joka
kirjeessä alusta -- kuten on tietysti toivottavaa.
\koodi{letter}\-/luokkaa käsitellään tarkemmin luvussa
\ref{luku:kirjeet}.

Piirtoheittimien läpinäkyvien kalvojen ja sen kaltaisten dokumenttien
tekemiseen on dokumenttiluokka \koodi{slides}. \koodimargin{slides}
Piirtoheittimet ovat jääneet menneisyyteen, ja nykyään jokseenkin
vastaavanlainen rooli on esi\-tys\-gra\-fiikka\-ohjel\-milla, joilla
tehdään dia\-esi\-tyk\-siä esimerkiksi esitelmien havaintomateriaaliksi.
\koodi{slides}\-/luokkaa ei varmaan tarvita enää mihinkään, mutta
esi\-tys\-gra\-fiik\-kaan on olemassa erittäin monipuolinen luokka
\koodi{beamer}, jonka perus\-asioita käsitellään luvussa
\ref{luku:diaesitykset}.

\subsection{Perusdokumenttiluokkien asetukset}

Taulukkoon \ref{tlk:luokkavalitsimet} on koottu perusdokumenttiluokkien
valitsimet. Sivun koko asetetaan valitsimilla \koodi{a4\-paper} (210 ×
297 mm), \koodimargin{*paper} \koodi{a5\-paper} (148 × 210 mm),
\koodi{b5\-paper} (176 × 250 mm), \koodi{execu\-tive\-paper} (7,25 ×
10,5 tuumaa), \koodi{legal\-paper} (8,5 × 14 tuumaa) tai
\koodi{letter\-paper} (8,5 × 11 tuumaa). Latexin oletuksena on
\koodi{letterpaper}, mutta oletusta voi olla muutettu Latexin
jakelupaketissa. Varminta on aina itse kirjoittaa haluttu sivukoko
dokumentin asetuksiin.

\leijutlk{
  \ttfamily
  \begin{tabular}{llll}
    \toprule
    a4paper & landscape & openright & 10pt \\
    a5paper & final & openany & 11pt \\
    b5paper & draft & onecolumn & 12pt \\
    executivepaper & oneside & twocolumn & titlepage \\
    legalpaper & twoside & fleqn & notitlepage \\
    letterpaper & openbib & leqno & clock \\
    \bottomrule
  \end{tabular}
}{
  \caption{Perusdokumenttiluokkien valitsimet}
  \label{tlk:luokkavalitsimet}
}

Sivu on oletuksena pysty\-asen\-nossa, mutta valitsin \koodi{landscape}
\koodimargin{landscape} asettaa sen vaaka\-/asentoon. Tämä asetus koskee
dokumentin kaikkia sivuja, mutta jos haluaa asettaa vain yksittäisiä
sivuja vaaka\-/asentoon, täytyy käyttää
\paketti{pdf\-lscape}\-/pakettia\avctan{pdflscape} ja sen tarjoamaa
ympäristöä.

Sivun koon ja muitakin mittoja voi määritellä monipuolisemmin
\paketti{geometry}\-/paketin toimintojen avulla (luku
\ref{luku:sivuasetukset}). Jos sitä pakettia käyttää, ei näitä
dokumenttiluokan sivu\-koko\-ase\-tuk\-sia tarvita välttämättä lainkaan.

Leipätekstin fontin koon voi määrittää valitsimilla \koodi{10pt},
\koodimargin{10pt} \koodimargin{11pt} \koodimargin{12pt} \koodi{11pt} ja
\koodi{12pt}, joista ensin mainittu on oletus. Lyhenne pt tarkoittaa
typografista pistemittaa, joita käsitellään luvussa \ref{luku:mitat}.
Nämä asetukset vaikuttavat myös sivun marginaaleihin, koska fontin koko
vaikuttaa tekstiriville mahtuvien merkkien määrään ja Latex pyrkii
pitämään rivit sopivan mittaisina lukemisen kannalta.

Vain kolme eri fonttikokoa leipätekstille on kovin vähän ja peräisin
ajalta, jolloin Latexin fontit olivat pik\-seli\-gra\-fiik\-kaa eli
muodostuivat erillisistä kuvapisteistä. Nyky\-aika\-na fontit ovat
vek\-tori\-gra\-fiik\-kaa eli matemaattisten kaavojen avulla
muodostettavia kuvia, ja ne voi venyttää mihin kokoon tahansa. Sen
vuoksi nämä dokumenttiluokkien fonttikokovalitsimet eivät ole kovin
tarpeellisia eivätkä riitä kaikkiin tarpeisiin nykyaikana. Voi niitä
silti käyttää, jos niiden avulla saa halutun lopputuloksen. Fontteja
käsitellään tarkemmin luvussa \ref{luku:kirjaintyypit}.

Dokumentista voi latoa luonnosversion käyttämällä dokumenttiluokan
valitsinta \koodi{draft}. \koodimargin{draft} Luonnoksena ladottuun
dokumenttiin tulevat merkityksi (musta suorakulmio) ainakin
tekstipalstan yli pursuavat rivit, mikä voi auttaa tekstikappaleiden
ulkoasun korjailussa (luku \ref{luku:kappale}). Eri makropaketit voivat
hyödyntää \koodi{draft}\-/valitsinta omalla tavallaan eli muuttaa
toimintaansa sen perusteella. Esimerkiksi grafiikkaan liittyvä paketti
\paketti{graph\-icx} (luku \ref{luku:grafiikka}) jättää luonnosversiosta
kuvat pois, ja niiden paikalla on vain suorakulmio. Pdf\-/tiedoston
ristiviitteistä huolehtiva \paketti{hyperref}\-/paketti jättää pdf:n
sisäiset ristiviitteet ja sisällysluettelon tekemättä (luku
\ref{luku:ristiviitteet}). Latominen voi nopeutua huomattavasti.

Lopullinen ladontatila on \koodi{final}, \koodimargin{final} joka
tarkoittaa, että dokumenttiin ladotaan kaikki sisältö ja ominaisuudet
niin kuin se on tarkoitettu julkaistavaksi. Tätä valitsinta ei tarvitse
käyttää, koska se on oletustila.

Sivujen yksipuolisuus \koodimargin{oneside} \koodimargin{twoside}
(\koodi{one\-side}) ja kaksipuolisuus (\koodi{two\-side}) ovat
asetuksia, jotka vaikuttavat sivun marginaalien asetuksiin ja
mahdollisesti uuden pääluvun (\koodi{\keno chapter}) aloitukseen. Oletus
on yksipuolinen dokumentti kaikissa muissa perusdokumenttiluokissa
paitsi \koodi{book}\-/luokassa, jonka oletus on kaksipuolinen.

Yksipuolisessa dokumentissa kaikkien sivujen marginaalit ovat
lähtökohtaisesti samanlaisia ja asetuksissa puhutaan esimerkiksi
vasemmasta (\englanti{left}) ja oikeasta (\englanti{right})
marginaalista. Kaksipuolisessa dokumentissa sivut ajatellaan pareittain:
kaksi sivua muodostaa kirjan aukeaman, jonka vasemmalla puolella on
parillinen sivunumero ja oikealla pariton. Marginaalien asetuksissa
puhutaan sisämarginaaleista (\englanti{inner}) ja ulkomarginaaleista
(\englanti{outer}). Sisämarginaalit ovat oletuksena pienemmät, koska
niitä on aukeamalla aina kaksi vierekkäin. Ulkomarginaaleissa on tilaa
marginaalihuomautuksille (luku \ref{luku:marginaalihuomautukset}).
Marginaaleja ja muita sivun asetuksia käsitellään tarkemmin luvussa
\ref{luku:sivuasetukset}.

Jos dokumentti on määritetty kaksipuoliseksi (\koodi{two\-side}),
voidaan \koodi{open\-right}\-/valitsimella \koodimargin{openright}
määrittää pääluvut (\koodi{\keno chapter}) alkamaan aina
oikeanpuoleiselta sivulta. Se onkin oletus dokumenttiluokassa
\koodi{book}. Valitsin \koodi{open\-any} \koodimargin{openany} asettaa
pääluvut alkamaan miltä tahansa seuraavalta sivulta.

Valitsin \koodi{open\-bib} \koodimargin{openbib} liittyy automaattiseen
lähdeluettelon muotoiluun. Jos tämä valitsin on mukana, automaattisessa
lähdeluettelon muotoilussa lisätään rivinvaihtoja lähdemerkinnän eri
osien kuten teoksen tekijöiden ja teoksen nimen jälkeen. Lähdemerkintöjä
ja lähdeluettelon laatimista käsitellään luvussa \ref{luku:lähteet}.

Matemaattisten kaavojen ladontaan liittyvässä
\koodi{equa\-tion}\-/ympäristössä kaavat ladotaan normaalisti
vaakasuunnassa sivun keskelle. Dokumenttiluokan valitsinta \koodi{fleqn}
\koodimargin{fleqn} käyttämällä kaavat ladotaan kuitenkin sivun
vasempaan reunaan. Kaavojen numerot sijoitetaan oletuksena sivun oikeaan
reunaan, mutta valitsimella \koodi{leqno} \koodimargin{leqno} ne saa
ladottua sivun vasempaan reunaan. Matematiikkatilaa käsitellään luvussa
\ref{luku:matematiikka}.

Kansilehden tai dokumentin perustietojen esitystapaan vaikutetaan
valitsimilla \koodi{title\-page} \koodimargin{titlepage} ja
\koodi{no\-title\-page}. \koodimargin{notitlepage} Latexissa on
yksinkertaiset komennot dokumentin perustietojen eli pääotsikon,
tekijöiden nimien ja päiväyksen latomiseen (luku \ref{luku:kansilehti}),
ja näillä valitsimilla vaikutetaan siihen, ladotaanko perustiedot omalle
sivulleen (\koodi{title\-page}) vaiko varsinaisen sisältösivun alkuun
(\koodi{no\-title\-page}). Oletus\-asetus vaihtelee eri
dokumenttiluokissa.

Oletuksena sivun tekstit ladotaan yhdelle palstalle
(\koodi{one\-column}), \koodimargin{onecolumn} mutta valitsimella
\koodi{two\-column} \koodimargin{twocolumn} teksti ladotaan kahdelle
palstalle. Nämä valitsimet vaikuttavat myös sivun marginaaleihin.
Latexin perusosat eivät hallitse useampaa kuin kaksi palstaa, mutta
\paketti{multicol}\-/makropaketin avulla saa enemmänkin. Palstoja
käsitellään luvussa \ref{luku:palstat}.

Dokumenttiluokassa \koodi{slides} toimii \koodi{clock}\-/valitsin,
\koodimargin{clock} joka latoo kellon\-ajan piirtoheitinkalvon loppuun
\koodi{\keno note}\-/komennon yhteydessä. Tämä valitsin kuulunee samaan
paikkaan kuin piirtoheittimet ja \koodi{slides}\-/luokkakin:
kierrätykseen.

\subsection{Muita dokumenttiluokkia}

Kuka tahansa voi tehdä ja julkaista omia dokumenttiluokkia, ja niinpä
perusdokumenttiluokkien lisäksi onkin saatavilla monenlaisia luokkia.
Tässä käsitellään vain joitakin.

Luokka \koodi{memoir} on Latexin \koodi{book}\-/luokkaan perustuva,
ominaisuuksiltaan laajennettu luokka, joka sopii yleiskäyttöön. Tähän
luokkaan on sisällytetty monia dokumentin rakenteeseen ja ulkoasuun
liittyviä toimintoja, joihin yleensä tarvitaan erillisiä makropaketteja
tai muuten lisäkoodia. Sen sijaan, että ratkoisi dokumentin rakenteen ja
asettelun kysymyksiä erillisten makropakettien avulla, saattaisi olla
helpompaa lukea (lähes) pelkästään vain \koodi{memoir}\-/luokan
ohjekirjaa ja toteuttaa asiat yhtenäisen järjestelmän avulla.

\koodi{beamer}\-/luokka on monipuolinen ja huippuunsa viritetty luokka
esi\-tys\-gra\-fii\-kan eli dia\-esi\-tys\-ten tekemiseen. Vastaava
mutta hieman helppokäyttöisempi luokka on \koodi{pow\-er\-dot}. Nämä
luokat ovat eräänlaisia Latexin vastineita esimerkiksi
\englanti{Libreoffice Impress}\-/{} ja \englanti{Microsoft Powerpoint}
\=/ohjelmille.

Pienempiin, rajattuihin erityistarpeisiin on olemassa useita luokkia.
Esimerkiksi yksisivuisten taitettavien lehtisten kuten tapahtuman
käsi\-ohjel\-mien tekemiseen soveltuu \koodi{leaf\-let}\-/luokka.
\textsc{cd}\-/levyjen kansia voi tehdä \koodi{cd}\-/luokan avulla.
Kuvitettuja seinäkalentereita vartenkin on tehty oma luokkansa,
\koodi{wall\-cal\-en\-dar}. Kitaran tablatuureja eli otelautakuvaan
perustuvia nuotteja voi tehdä \koodi{gui\-tar\-tabs}\-/luokan avulla.

Kaikenlaista on siis olemassa. Saatavilla oleviin dokumenttiluokkiin voi
tutustua esimerkiksi \englanti{Comprehensive Tex Archive Network}
(\textsc{ctan}) \=/verkkosivun avulla.%
\footnote{\url{https://ctan.org/topic/class}}

\section{Sivu}
\label{luku:sivuasetukset}

Latex\-/dokumentit muodostuvat aina peräkkäisistä sivuista, eli
taustalla kummittelee paperi\-arkkeihin perustuva julkaisumuoto, vaikka
dokumenttia ei varsinaisesti tulostettaisi tai painettaisi paperille.
Tämän vuoksi melkein aina täytyy määrittää sivun asetukset kuten
paperikoko ja marginaalit. Ne tehdään \paketti{geometry}\-/paketin
avulla, jota käsitellään luvussa \ref{luku:sivun_mitat}. Joskus
halutaan muokata sivun ylä- tai alatunnistetta eli verrattain pysyviä
tunnistetietoja, jotka toistuvat joka sivulla ylä- tai alareunassa.
Niiden muokkaamiseen käytetään \paketti{fancy\-hdr}\-/pakettia, jonka
ohjeita on luvussa \ref{luku:yla_ala_tunnisteet}.

\subsection{Sivun koko ja marginaalit}
\label{luku:sivun_mitat}

Paperin kokoon ja marginaaleihin pääsee vaikuttamaan
\paketti{geometry}\-/paketin\avctan{geometry} avulla. Halutut asetukset
voi kertoa paketin lataamisen yhteydessä. Seuraavassa esimerkissä
asetetaan paperikoko (\koodi{a4\-paper} eli \textsc{a4}-koko), ylä- ja
alamarginaalin pituus (\koodi{top}, \koodi{bottom}) sekä vasemman ja
oikean marginaalin pituus (\koodi{left}, \koodi{right}).

\begin{koodilohkosis}
  \usepackage[a4paper, top=20mm, bottom=30mm,
    left=20mm, right=20mm]{geometry}
\end{koodilohkosis}

Vaihtoehtoisesti asetukset voi ilmaista erikseen \koodi{\keno
  geometry}\-/komennon avulla seuraavalla tavalla:

\begin{koodilohkosis}
  \usepackage{geometry}
  \geometry{a4paper, top=20mm, bottom=30mm, left=20mm, right=20mm}
\end{koodilohkosis}

Mikäli myöhemmin dokumentissa täytyy vaihtaa sivun asettelua, käytetään
komentoa \koodi{\keno new\-geom\-etry}. Alkuperäiset asetukset
palautetaan komennolla \koodi{\keno re\-store\-geom\-etry}.

\begin{koodilohkosis}
  \newgeometry{top=…, bottom=…, …} % Uudet asetukset.
  \restoregeometry     % Palautetaan alkuperäiset asetukset.
\end{koodilohkosis}

Valmiiksi määriteltyjä standardipaperikokoja on useita.
\textsc{iso}\-/standardin mukaiset koot \textsc{a0}--\textsc{a6}
valitaan valitsimilla kuten \koodimargin{*paper} \koodi{a3paper},
\koodi{a4paper} tai \koodi{a5paper}. Samoin käytetään myös kokoja
\textsc{b0}--\textsc{b6} ja \textsc{c0}--\textsc{c6}, esimerkiksi
\koodi{b2paper} tai \koodi{c6paper}. Lisäksi on valittavissa useita
japanilaisia ja yhdysvaltalaisia standardeja käyttämällä valitsimia
kuten \koodi{b0j}--\koodi{b6j}, \koodi{ansi\-a\-paper} tai
\koodi{letter\-paper}.

Mikäli standardit koot eivät riitä, voi sivun mitat määrittää vapaasti
\koodi{paper\-size}\-/valitsimella, \koodimargin{papersize} jolle
annetaan arvoksi leveys- ja korkeusmitta.

\begin{koodilohkosis}
  \geometry{papersize={10cm, 16cm}}
\end{koodilohkosis}

Sivu on oletuksena pysty\-asen\-nossa (\koodi{por\-trait}),
\koodimargin{por\-trait} mutta sen voi asettaa vaaka\-/asentoon
valitsimella \koodi{land\-scape}. \koodimargin{land\-scape} Tämä asetus
on voimassa koko dokumentin ajan. Jos haluaa asettaa vain yksittäisiä
sivuja vaaka\-/asentoon, täytyy käyttää
\paketti{pdf\-lscape}\-/pakettia\avctan{pdflscape} ja sen tarjoamaa
ympäristöä.

Sivun asetusten suunnittelussa voi olla avuksi valitsin
\koodi{show\-frame}, \koodimargin{show\-frame} joka piirtää viivat
marginaalien kohdalle ja merkitsee myös ylä- ja alatunnisteiden sekä
marginaalihuomautusten rajoja.

Taulukkoon \ref{tlk:sivun_marginaalit} on koottu tärkeimpiä valitsimia
marginaalien mittojen asettamiseksi. Valitsimille annetaan arvoksi Texin
mittayksikkö, jotka ovat taulukossa \ref{tlk:mittayksikot}
(s.~\pageref{tlk:mittayksikot}). Kaksipuolisessa
\koodimargin{twoside=\katk true} \koodimargin{twoside=\katk false}
asettelussa (\koodi{two\-side=\katk true}) sivut muodostavat aukeaman
eli on erikseen vasemmanpuoleinen ja oikeanpuoleinen sivu. Tällöin vasen
ja oikea marginaali vuorottelevat, ja niitä on havainnollisempaa kutsua
sisä- ja ulkomarginaaliksi. Marginaalien määrittelyssä voi käyttää
valitsimen \koodi{left} sijasta valitsinta \koodi{inner}, ja vastaavasti
\koodi{right}\-/valitsin voidaan korvata \koodi{outer}\-/valitsimella.
Teknisesti näillä ei ole mitään eroa, mutta nimet ovat ihmisille
havainnollisempia.

\providecommand{\rivi}{}
\renewcommand{\rivi}[3]{\koodi{#1} & \koodi{#2} & #3 \\}

\leijutlk{
  \begin{tabular}{lll}
    \toprule
    \multicolumn{2}{l}{\ots{Valitsin}} & \ots{Merkitys} \\
    \midrule
    \rivi{left}{inner}{vasen marginaali tai sisämarginaali}
    \rivi{right}{outer}{oikea marginaali tai ulkomarginaali}
    \rivi{top}{}{ylämarginaali}
    \rivi{bottom}{}{alamarginaali}
    \bottomrule
  \end{tabular}
}{
  \caption{\paketti{geometry}\-/paketin valitsimia sivun marginaalien
    määrittelemiseen}
  \label{tlk:sivun_marginaalit}
}

Sivun tekstialueen koon ja marginaalit voi määrittää myös
suhteellisesti. Voisi esimerkiksi määrittää, että leveyssuunnassa
tekstialue täyttää 0,7\=/kertaisesti (70\,\%) sivun leveyden ja loput
jää marginaaleille. Marginaalien keskinäiset suhteetkin voi ilmaista
suhdelukuna: esimerkiksi vasemman (sisä) ja oikean (ulko) marginaalin
suhde voisi olla 2:3. Suhteellisessa tavassa ei tarvitse ottaa kantaa
sivun kokoon eikä muihinkaan varsinaisiin mittoihin, vaan samat
tekstialueen ja marginaalien suhteet säilyvät, vaikka sivukokoa
muuttaisikin. Suhteellisia mittoja koskevia valitsimia on koottu
taulukkoon \ref{tlk:sivun_marginaalit_suhd}.

\providecommand{\rivi}{}
\renewcommand{\rivi}[2]{\koodi{#1} & #2 \\}

\leijutlk{
  \begin{tabular}{ll}
    \toprule
    \ots{Valitsin} & \ots{Merkitys} \\
    \midrule
    \rivi{hscale}{tekstialueen osuus sivun leveydestä}
    \rivi{vscale}{tekstialueen osuus sivun korkeudesta}
    \rivi{hmarginratio}{vasemman (sisä) ja oikean (ulko) marginaalin suhde}
    \rivi{vmarginratio}{ylä- ja alamarginaalin suhde}
    \bottomrule
  \end{tabular}
}{
  \caption{\paketti{geometry}\-/paketin valitsimia sivun tekstitilan ja
    marginaalien suhteiden määrittämiseen. Osuudet (\koodi{*hscale})
    ilmaistaan prosenttikertoimella (esim. \koodi{0.7}). Suhteet
    (\koodi{*marginratio}) ilmaistaan suhdelukuna (esim. \koodi{2:3})}
  \label{tlk:sivun_marginaalit_suhd}
}

Klassisessa kirja\-typo\-grafiassa, jossa teksti ladotaan yhdelle
palstalle, marginaalien suuruusjärjestys on suurimmasta pienimpään
seuraavanlainen: ala-, ulko-, ylä- ja sisämarginaali. Suhdeluvut samassa
järjestyksessä: 32, 28, 20, 17. \paketti{geometry}\-/paketin
valitsimilla tämä ilmaistaan seuraavasti:

\begin{koodilohkosis}
  \geometry{hmarginratio=17:28, vmarginratio=20:32}
\end{koodilohkosis}

Klassisia suhteita ei nyky\-aikana yleensä noudateta kovin tarkasti,
mutta niistä kannattaa ymmärtää yleinen ajatus. Alamarginaalin pitäisi
olla hieman suurempi kuin ylämarginaali, koska muuten tekstialue tuntuu
pudonneen sivulla alas. Alamarginaalissa (alatunnisteessa) on yleensä
sivunumero. Kirjan sivuja katsotaan pareittain eli aukeamina, joten
sisämarginaaleja on kaksi vierekkäin. Siksi sisämarginaalit yksittäin
ajateltuna ovat pienemmät kuin ulkomarginaalit. Lisäksi ulkomarginaaleja
voidaan käyttää huomautusten kirjoittamiseen, mikä on melko yleinen
käytäntö tietokirjoissa.

Marginaalihuomautukset (luku \ref{luku:marginaalihuomautukset})
sijaitsevat oletuksena sivujen ulkomarginaalissa tai oikeanpuoleisessa
marginaalissa. Huomautuspalstan leveys asetetaan valitsimella
\koodi{margin\-par\-width}, \koodimargin{margin\-parwidth} ja palstan
etäisyys sivun varsinaisesta tekstialueesta määritellään valitsimella
\koodi{margin\-par\-sep}. \koodimargin{margin\-parsep} Kumpikin valitsin
tarvitsee argumentiksi mitan. Jos haluaa vaihtaa huomautukset sivun
vastakkaiseen marginaaliin, lisätään mukaan valitsin
\koodi{reverse\-margin\-par}.

Perus Latex osaa latoa tekstin yhdelle \koodimargin{onecolumn} tai
kahdelle \koodimargin{twocolumn} palstalle, ja
\paketti{geometry}\-/paketin valitsimella \koodi{one\-column} tai
\koodi{two\-column} asetetaan, kumpi tila on oletuksena päällä. Kesken
dokumentin voi vaihtaa yksipalstaiseen tilaan komennolla \koodi{\keno
  one\-column} tai kaksipalstaiseen tilaan komennolla \koodi{\keno
  two\-column}. Käyttämällä
\paketti{multicol}\-/pakettia\avctan{multicol} voi olla useampiakin kuin
kaksi palstaa. Palstoja käsitellään tarkemmin luvussa
\ref{luku:palstat}.

Valitsimen \koodi{column\-sep} \koodimargin{column\-sep} avulla
asetetaan palstojen välinen etäisyys. Tämä valitsin on asettaa mitan
\koodi{\keno column\-sep}, jota voi muokata myös komennolla \koodi{\keno
  set\-length}, kuten muitakin Latexin mittoja (luku \ref{luku:mitat}).

\subsection{Leikkuuvarat}

Sivu voi olla ulkoisesti erikokoinen kuin sisäisesti. On siis
mahdollista asettaa sivu esimerkiksi \textsc{a4}\-/kokoiseksi ja
käsitellä marginaalit ja muut sivun mitat \textsc{a4}-koon mukaan, mutta
ulkoisesti tai fyysisesti sivu onkin osana suurempaa sivua tai
paperi\-arkkia. Tällaista tarvitaan ainakin silloin, kun halutaan
merkitä leikkuuvarat dokumentin painamista varten.

Painokoneen paperi\-arkkien leikkauskohta ei välttämättä osu täsmälleen
samaan kohtaan pdf\-/tiedoston sivun reunan kanssa, ja siksi
dokumentissa reunaan saakka yltävät kuvat asetetaan varmuuden vuoksi
hieman ylikokoiseksi. Sivun reunaan saakka aiotut kuvat siis yltävät
lähde-pdf:ssä pari millimetriä varsinaisen sivu\-alueen ulkopuolelle eli
leikkuuvaran puolelle. Tällä varmistetaan, että painamisen jälkeen
leikatuissa paperi\-arkeissa kuva varmasti yltää reunaan saakka.

Jos dokumenttiin tarvitaan sivun ulkopuoliset leikkuuvarat, määritellään
dokumentin ulommaiset mitat edelleen samalla tavalla kuin
tavallisestikin eli esimerkiksi valitsimella \koodi{paper\-size} (luku
\ref{luku:sivun_mitat}). \koodimargin{layout} \koodimargin{layout\-size}
Sen sijaan sivun sisäiset mitat täytyy määritellä toisella tavalla,
käyttämällä valitsinta \koodi{lay\-out} tai \koodi{layout\-size}.

\begin{esimerkki*}
\begin{koodilohko}
  \geometry{
    papersize={220mm, 307mm},
    layout=a4paper,           % tai: layoutsize={210mm, 297mm}
    layoutoffset={5mm, 5mm},
    showcrop
  }
\end{koodilohko}
\caption{Sivun ulkoisten ja sisäisten mittojen sekä leikkuvaarojen
  määrittäminen}
\label{esim:leikkuuvarat}
\end{esimerkki*}

Esimerkissä \ref{esim:leikkuuvarat} käytetään sisäisesti \textsc{a4}\-/
kokoista (210 × 297~mm) sivua, mutta sivulle on määritetty joka puolelle
5\,mm:n leikkuuvarat. Niinpä ulkoisesti sivu on 10\,mm leveämpi ja
korkeampi, eli ulkoiset mitat ovat 220 × 307~mm. Valitsimella
\koodi{layout\-offset} asetetaan sisäisen sivun etäisyys ulkoisen sivun
vasemmasta ylänurkasta. Esimerkissä on mukana myös valitsin
\koodi{show\-crop}, joka merkitsee sisäisen ja ulkoisen sivun rajakohdan
eli leikkuuvaran rajan. Merkinnät näkyvät vain sivun nurkissa
leikkuuvaran puolella, joten ne eivät päädy lopulliseen
painotuotteeseen.

\subsection{Ylä- ja alatunnisteet}
\label{luku:yla_ala_tunnisteet}

\paketti{geometry}\-/paketin asetuksiin kuuluu pari valitsinta, joilla
vaikutetaan ylä- ja alatunnisteiden mittoihin. Valitsimella \koodi{head}
ilmaistaan ylätunnisteen korkeus ja valitsimella \koodi{head\-sep} sen
etäisyys sivun tekstipalstasta. Alatunnisteen peruslinjan etäisyys
tekstipalstasta säädetään valitsimella \koodi{foot\-skip}. Taulukkoon
\ref{tlk:yla_ala_tunnistemitat} on koottu näiden valitsimien merkitys,
ja seuraavassa on niiden käyttämisestä esimerkki. Mukana on myös
valitsin \koodi{show\-frame}, joka piirtää sivulle apuviivoja. Se auttaa
sivun mittojen suunnittelussa.

\begin{koodilohkosis}
  \geometry{head=24bp, headsep=8bp, footskip=12mm, showframe}
\end{koodilohkosis}

\leijutlk{
  \begin{tabular}{ll}
    \toprule
    \ots{Valitsin} & \ots{Merkitys} \\
    \midrule
    \koodi{head} & ylätunnisteen korkeusmitta \\
    \koodi{headsep} & ylätunnisteen etäisyys tekstipalstasta \\
    \koodi{footskip} & alatunnisteen peruslinjan etäisyys tekstipalstasta \\
    \bottomrule
  \end{tabular}
}{
  \caption{\paketti{geometry}\-/paketin valitsimet ylä- ja
    alatunnisteiden mittojen asettamiseen}
  \label{tlk:yla_ala_tunnistemitat}
}

\subsubsection{Sivutyylit}

Latexin perusosat eivät sisällä kovin kummoista keinovalikoimaa ylä- ja
alatunnisteiden muokkaamiseen, mutta pari hyödyllistä sivutyyliä on
kuitenkin mukana. Ylä- ja alatunnisteet määräytyvät sivutyylin
perusteella, ja haluttu tyyli asetetaan voimaan komennolla \koodi{\keno
  page\-style}:

\begin{koodilohkosis}
  \pagestyle{plain}
\end{koodilohkosis}

Edellä mainittu sivutyyli \koodi{plain} latoo alatunnisteeseen
sivunumeron. Se on yleensä oletustyyli. \koodimargin{plain} Sivunumero
on peräisin laskurista \koodi{page} ja sen arvon tulostavasta komennosta
\koodi{\keno the\-page} (luku \ref{luku:laskurit}). Toinen hyödyllinen
tyyli on \koodi{empty}, \koodimargin{empty} joka nimensä mukaisesti
tarkoittaa tyhjää, eli ylä- eikä alatunnisteeseen ei ladota mitään.

Yksittäiselle sivulle voi asettaa muusta dokumentista poikkeavan
sivutyylin komennolla \koodi{\keno this\-page\-style}. Komento siis
vaikuttaa vain sillä hetkellä ladottavan sivun tyyliin, ja sen jälkeen
palataan taas voimassa olevaan tyyliin, joka on aiemmin määritelty
komennolla \koodi{\keno page\-style}.

\begin{koodilohkosis}
  \thispagestyle{empty}
\end{koodilohkosis}

Sivutyyli \koodi{head\-ings} \koodimargin{headings} latoo
ylätunnisteeseen aukeaman vasemmanpuoleisille sivuille esimerkiksi
kirjan pääluvun nimen ja oikeanpuoleisille sivuille meneillään olevan
alaluvun nimen. Mainitut lukujen nimet tulevat sivun sisäreunaan;
ulkoreunaan ladotaan sivunumero.

Teknisesti ja sisäisesti tämä on toteutettu siten, että pääluvun
aloittava otsikkokomento (esim. \koodi{\keno chapter}) automaattisesti
määrittelee joka kerta uudelleen komennon \koodi{\keno left\-mark}, niin
että se sisältää pääluvun nimen. Sivuja ladottaessa Latex sitten latoo
ylätunnisteeseen sen, mitä \koodi{\keno left\-mark}\-/komento sattuu
tulostamaan. Vastaavasti alaluvun otsikkokomento (esim. \koodi{\keno
  section}) määrittelee uudelleen komennon \koodi{\keno right\-mark},
niin että se sisältää alaluvun nimen. Tämän komennon tulostama teksti
ladotaan aukeaman oikeanpuoleisille sivuille.

Jos haluaa itse vaikuttaa ylätunnisteen tekstiin, voi käyttää sivutyyliä
\koodi{my\-head\-ings} \koodimargin{my\-head\-ings} sekä komentoa
\koodi{\keno mark\-both}, jolla määritellään aukeaman vasemmanpuoleisen
ja oikeanpuoleisen sivun ylätunnisteen teksti. Tämä komento on
tarkoitettu suoritettavaksi päälukujen yhteydessä. Komennolla
\koodi{\keno mark\-right} määritellään pelkästään oikeanpuoleisen sivun
teksti, ja komento on tarkoitettu suoritettavaksi aina alalukujen
yhteydessä.

\begin{koodilohkosis}
  \markboth{vasen}{oikea}  % määrittelee: \leftmark ja \rightmark
  \markright{oikea}        % määrittelee: \rightmark
\end{koodilohkosis}

Sivunumeroinnin tyyliin voi vaikuttaa esimerkiksi komennolla
\koodi{\keno page\-number\-ing}, jonka argumentiksi annetaan
numerointityylin nimi. Ne on koottu taulukkoon
\ref{tlk:sivu_numerointityylit}.

\begin{koodilohkosis}
  \pagenumbering{roman}
\end{koodilohkosis}

Edellä mainittu komento määrittelee käytännössä uudelleen komennon
\koodi{\keno the\-page}, joka on tarkoitettu juuri sivunumerolaskurin
latomiseen. Lisätietoa sivunumeroista ja muista laskureista on luvussa
\ref{luku:laskurit}.

\providecommand{\rivi}{}
\renewcommand{\rivi}[2]{\koodi{#1} & #2 \\}

\leijutlk{
  \begin{tabular}{ll}
    \toprule
    \ots{Tyyli} & \ots{Merkitys} \\
    \midrule
    \rivi{arabic}{arabialaiset luvut: 1, 2, 3\dots}
    \rivi{roman}{roomalaiset luvut: i, ii, iii\dots}
    \rivi{Roman}{roomalaiset luvut: I, II, III\dots}
    \rivi{alph}{kirjaimet: a, b, c\dots\ (vain 1--26)}
    \rivi{Alph}{kirjaimet: A, B, C\dots\ (vain 1--26)}
    \bottomrule
  \end{tabular}
}{
  \caption{Sivunumerointityylit \koodi{\keno
      page\-number\-ing}\-/komennon argumentiksi}
  \label{tlk:sivu_numerointityylit}
}

\subsubsection{Fancyhdr}

Monipuolisemmin ylä- ja alatunnisteita voi muokata paketin
\paketti{fancy\-hdr}\avctan{fancyhdr} toimintojen avulla. Silloin
sivutyylinä voi olla myös \koodi{fancy}: \koodimargin{fancy}

\begin{koodilohkosis}
  \usepackage{fancyhdr}
  \pagestyle{fancy}
\end{koodilohkosis}

Kun käytössä on sivutyyli \koodi{fancy}, voi ylä- ja alatunnisteiden
sisällön asettaa vapaasti komennolla \koodi{\keno fancy\-hf}. Komennon
argumenttien merkitys on seuraavanlainen:

\begin{koodilohkosis}
  \fancyhf[paikka]{sisältö}
\end{koodilohkosis}

Valinnainen argumentti \koodi{paikka} kertoo, mihin paikkaan tai
paikkoihin \koodi{sisältö} sijoitetaan. Vaihtoehtoina on ylä- tai
alatunniste, pariton tai parillinen sivu, sivun vasen reuna, keski\-osa
tai oikea reuna. Nämä vaihtoehdot ja niitä vastaavat valitsimet on
koottu taulukkoon \ref{tlk:fancyhf_paikat}. Saman komennon avulla voi
määrittää useitakin paikkoja, kun ne erottaa pilkulla, esimerkiksi
seuraavalla tavalla:

\providecommand{\rivi}{}
\renewcommand{\rivi}[2]{\koodi{#1} & #2 \\}

\leijutlk{
  \begin{tabular}{cl}
    \toprule
    \ots{Valitsin} & \ots{Merkitys} \\
    \midrule
    \rivi{H}{ylätunniste (header)}
    \rivi{F}{alatunniste (footer)}
    \rivi{E}{parillinen sivu, vasen (even)}
    \rivi{O}{pariton sivu, oikea (odd)}
    \rivi{L}{sivun vasen reuna (left)}
    \rivi{C}{sivun keskelle (center)}
    \rivi{R}{sivun oikea reuna (right)}
    \bottomrule
  \end{tabular}
}{
  \caption{\koodi{\keno fancy\-hf}\-/komennon valitsimia ylä- tai
    alatunnisteen paikan määrittämiseen}
  \label{tlk:fancyhf_paikat}
}

\begin{koodilohkosis}
  \fancyhf{}  % Tyhjennetään ylä- ja alatunnisteet.
  \fancyhf[HEL,HOR]{\thepage}
\end{koodilohkosis}

Edellä mainittu komento sijoittaa sivunumeron (\koodi{\keno the\-page})
ylätunnisteeseen (\koodi{H}) parillisten sivujen (\koodi{E}) vasempaan
reunaan (\koodi{L}) ja parittomien sivujen (\koodi{O}) oikeaan reunaan
(\koodi{R}). Käytännössä siis aukeaman ulkoreunoihin ladotaan
sivunumerot. Seuraava esimerkki sijoittaa ajatusviivoilla (\==)
reunustetun sivunumeron kaikille sivuille alatunnisteeseen (\koodi{F})
sivun keskelle (\koodi{C}):

\begin{koodilohkosis}
  \fancyhf[FC]{-- \thepage\ --}
\end{koodilohkosis}

Makropaketin \paketti{fancy\-hdr} avulla voi myös määritellä Latexin
sivutyylejä toisenlaiseksi tai luoda kokonaan omia sivutyylejä. Nämä
tehdään komennolla \koodi{\keno fancy\-page\-style}, jonka ensimmäinen
argumentti on sivutyylin nimi ja toinen argumentti on sivutyylin
määritelmä. Määritelmä sisältää tarvittavat \koodi{\keno
  fancy\-hf}\-/komennot, joilla ylä- ja alatunnisteet määritellään.

Seuraava esimerkki tekee Latexin \koodi{plain}\-/sivutyylistä saman kuin
\koodi{fancy}\-/tyylin, eli sekin noudattaa \koodi{\keno
  fancy\-hf}\-/komennolla määriteltyjä ylä- ja alatunnisteita:

\begin{koodilohkosis}
  \fancypagestyle{plain}{}
\end{koodilohkosis}

Seuraava esimerkki määrittelee kokonaan oman sivutyylin:

\begin{koodilohkosis}
  \fancypagestyle{omatyyli}{
    \fancyhf{}
    \fancyhf[FEL,FOR]{\thepage}
  }
\end{koodilohkosis}

Ylä- ja alatunniste voidaan erottaa tekstipalstasta vaakasuuntaisella
viivalla, jonka leveyttä on mahdollista muuttaa määrittelemällä
uudelleen komennot \koodi{\keno head\-rule\-width} ja \koodi{\keno
  foot\-rule\-width}. Komennon määritelmäksi kirjoitetaan Latexin mitta.
Seuraavassa esimerkissä asetetaan yhden typografisen pisteen (1\,bp)
levyiset viivat. Mitan voisi asettaa myös nollaksi (0\,bp), jolloin
erotinviiva katoaa kokonaan näkyvistä.

\begin{koodilohkosis}
  \renewcommand{\headrulewidth}{1bp} % ylätunnisteen erotinviiva
  \renewcommand{\footrulewidth}{1bp} % alatunnisteen erotinviiva
\end{koodilohkosis}

Mikäli haluaa omiin ylätunnisteisiin esimerkiksi päälukujen ja
alalukujen nimiä, täytyy tunnisteisiin sisällyttää aiemmin kuvatut
\koodi{\keno left\-mark}- ja \koodi{\keno right\-mark}\-/komennot. Ensin
mainittu sisältää pääluvun nimen ja jälkimmäinen alaluvun nimen.

\begin{koodilohkosis}
  \fancyhf[HEL]{\leftmark}
  \fancyhf[HOR]{\rightmark}
\end{koodilohkosis}

Latex latoo pää- ja alalukujen nimet oletuksena versaalikirjaimilla eli
isoilla kirjaimilla. Jos ne haluaa johonkin toiseen muotoon, täytyy itse
määritellä uudelleen komennot \koodi{\keno chapter\-mark}, \koodi{\keno
  section\-mark} tai \koodi{\keno sub\-section\-mark} (vain kaksi
näistä) ja käyttää määritelmässä komentoja \koodi{\keno mark\-both} ja
\koodi{\keno mark\-right}. Esimerkkiin \ref{esim:fancyhdr_koko} on
koottu varsin kokonaisvaltainen koodi omien ylä- ja alatunnisteiden
toteutukseen.

\begin{esimerkki*}
\begin{koodilohko}
  \documentclass{book}
  \usepackage{fancyhdr}

  % Päälukujen (\chapter) aloitussivu käyttää plain-sivutyyliä.
  % Tässä määritellään se uudestaan.
  \fancypagestyle{plain}{
    \fancyhf{}
    \fancyhf[FC]{-- \thepage\ --}
    \renewcommand{\headrulewidth}{0bp}
    \renewcommand{\footrulewidth}{0bp}
  }

  % fancy-sivutyylin asetukset:
  \fancyhf{}
  \fancyhf[HEL]{\leftmark}
  \fancyhf[HOR]{\rightmark}
  \fancyhf[FC]{-- \thepage\ --}
  \renewcommand{\headrulewidth}{1bp}
  \renewcommand{\footrulewidth}{0bp}

  \begin{document}

  \pagestyle{fancy}

  % Päälukujen (\chapter) yhteydessä komento \markboth{…}{…} määrittää
  % sekä \leftmark- että \rightmark-komennot. Tässä jälkimmäinen
  % määritellään tyhjäksi.
  \renewcommand{\chaptermark}[1]{%
    \markboth{\chaptername\ \thechapter: #1}{}}

  % Alalukujen (\section) yhteydessä komento \markright{…} määrittää
  % vain \rightmark-komennon.
  \renewcommand{\sectionmark}[1]{\markright{\thesection\ #1}}
\end{koodilohko}
\caption{Omien ylä- ja alatunnisteiden toteuttaminen}
\label{esim:fancyhdr_koko}
\end{esimerkki*}

\section{Fontit}
\label{luku:kirjaintyypit}

Fontit ja niiden asettaminen on Latexissa melko monimutkainen
kokonaisuus, koska fonteilla on paljon ominaisuuksia ja niihin
vaikutetaan monilla eri asetuksilla ja abstraktiotasoilla. Aika monta
asiaa pitää ymmärtää, jotta voi tehokkaasti työskennellä Latexin
fonttien kanssa.

Fontti jo itsessään on moniselitteinen käsite, joka vaatii typografiassa
usein täsmentäviä ilmauksia. Sana \emph{fontti} voi tarkoittaa
kokonaista kirjainperhettä eli yhteensopivien kirjainleikkausten
muodostamaa kokonaisuutta. Samaan kirjainperheeseen kuuluu yleensä
ainakin neljä eri leikkausta: tavallinen, \textit{kursiivi},
\textbf{lihavoitu} ja \textbf{\textit{lihavoitu kursiivi}}. Joihinkin
perheisiin kuuluu leikkauksia paljon enemmänkin, kuten useita eri
vahvuuksia. Joissakin puheissa sana \emph{fontti} tarkoittaa vain yhtä
kirjainleikkausta, ja silloin koko perheeseen viitataan ehkä sanalla
fonttiperhe.

Tässä oppaassa käytetään \emph{fontti}\-/sanaa yleisnimityksenä Latexin
kirjaintyyppeihin liittyville asetuksille. Se tarkoittaa kirjainperhettä
tai siihen kuuluvaa yksittäistä leikkausta sekä asetuksia, jotka
liittyvät niihin. Silloin kun merkitystä pitää täsmentää, käytetään
suomenkielisiä nimiä kirjainperhe ja kirjainleikkaus. Sen sijaan sana
\emph{kirjasin} on jätetty kokonaan pois. Se tarkoittaa vanhassa
metalliladonnassa ja mekaanisissa kirjoituskoneissa metallisen
ladontakappaleen eli kirjakkeen päähän valettua kirjaimen tai muun
merkin kohokuviota, joka painaa mustejäljen paperille.

Kuten Latexissa yleensäkin myös fonttien kanssa kannattaa käyttää
korkean abstraktiotason komentoja, jotka piilottavat yksityiskohdat ja
teknisen toteutuksen. Latexin fonttitoiminnot on suunniteltu juuri
siihen: matalan tason font\-ti\-ase\-tuk\-set määritellään mieluiten
vain kerran dokumentin esittelyosassa, ja sen jälkeen käytetään
pelkästään korkean tason komentoja.

Latexin fonttitekniikka rakentuu eri\-/ikäisistä kerroksista ja
tekniikoista. Fontteja on aikoinaan tehty
\englanti{Metafont}\-/nimisellä\avctan{metafont} kielellä, jolla
kuvataan merkkien muodot. \englanti{Metafont} on myös tietokoneohjelma,
joka tuottaa kuvauskielen perusteella bittikarttafontteja eli
pikseleistä koostuvia fontteja. On käytetty myös kehittyneempää
\englanti{Metapost}\-/kuvauskieltä\avctan{metapost} ja \=/ohjelmaa,
joilla on tuotettu vek\-tori\-gra\-fiik\-ka\-font\-te\-ja \textsc{eps}-
eli \englanti{Encapsulated Post Script} \=/muodossa ja muutettu niitä
edelleen \englanti{Post Script Type~1} \=/fonteiksi. Myöhemmin mukaan
ovat tulleet nyky\-aikai\-set \englanti{True Type}- ja \englanti{Open
  Type} \=/fontit, ja niihin tämä opas keskittyy.

\subsection{Fontin valinta}
\label{luku:fontin_valinta}

Latexin fonttien perus\-toiminnot rakentuvat kolmen erityyppisen
kirjainperheen varaan:

\begin{nluetelma}

\item peruskirjainperhe eli dokumentin pääasiallinen kirjainperhe, joka
  on kirja\-typo\-gra\-fias\-sa usein antiikva eli pääteviivallinen
  (\englanti{serif, roman})%
  \footnote{Antiikva (lat. \emph{antiquus} 'vanha') perustuu antiikin
    Roomassa käytettyihin kirjainmuotoihin. Ne olivat pääteviivallisia,
    mutta pääteviivat sinänsä eivät ole ainoa antiikvan piirre. Toinen
    tärkeä ominaisuus ovat erivahvuiset kirjainten viivat.}

\item groteski eli pääteviivaton (\englanti{sans serif, gothic})%
  \footnote{Groteskiin (ransk. \emph{grotesque} 'kummallinen') kuuluu
    pääteviivojen puuttumisen lisäksi lähes tasavahvuiset kirjainten
    viivat. Tämän oppaan groteskifontissa on kuitenkin selvästi
    antiikvamaiset kaksivahvuiset viivat, joten se on eräänlainen
    antiikvan ja groteskin välimuoto.}

\item tasalevyinen kirjoituskoneen kaltainen perhe
  (\englanti{type\-writer, mono\-spaced, tele\-type}).

\end{nluetelma}

Kuvassa \ref{kuva:kirjainperhetyypit} ovat tässä oppaassa käytetyt kolme
eri kirjainperhettä. Leipätekstissä käytetään antiikvaa, otsikoissa ja
kuvateksteissä groteskia ja koodi\-esi\-mer\-keis\-sä tasalevyistä.
Kirjoituskoneen kaltainen tasalevyinen kirjainperhe on tässä tapauksessa
tyypiltään antiikva eli pääteviivallinen, mutta se voisi olla muutakin.
Tasalevyisyys on sen kirjainperheen tärkein määrittävä tekijä Latexin
asetusten näkökulmasta.

\leijukuva{
  {\rmfamily\addfontfeatures{ScaleAgain=5}Amf}
  \hfill
  {\sffamily\addfontfeatures{Scale=5}Amf}
  \hfill
  {\ttfamily\addfontfeatures{FakeStretch=1, Scale=4.5}Amf}
}{
  \caption{Vasemmalla pääteviivallinen, keskellä pääteviivaton ja
    oikealla tasalevyinen pääteviivallinen kirjainperhe}
  \label{kuva:kirjainperhetyypit}
}

Joidenkin fonttien käyttöönottoon on tehty oma makropakettinsa, joten
sellaiset fontit voi ladata dokumentin esittelyosassa komennolla
\koodi{\keno usepackage}. Fonttikohtaisia makropaketteja on olemassa
varsinkin vanhalle fonttitekniikalle (\englanti{Metafont, Post Script
  Type~1}) mutta myös matematiikkatilan (luku \ref{luku:matematiikka})
fonttiasetuksille ja joillekin kir\-jain\-perhe\-koko\-nai\-suuk\-sille.

Valmiita makropaketteja on kuitenkin vain harvoille fonteille, ja
käytännössä lähes aina \englanti{True Type}- ja \englanti{Open Type}
\=/muodossa olevat kirjainperheet otetaan käyttöön
\paketti{fontspec}\-/paketin komennoilla alla olevan esimerkin
mukaisesti.

\begin{koodilohkosis}
  \setmainfont{TeX Gyre Termes}[Scale=1]
  \setsansfont{TeX Gyre Heros} [Scale=MatchLowercase]
  \setmonofont{TeX Gyre Cursor}[Scale=MatchLowercase]
\end{koodilohkosis}

Edellisessä esimerkissä \englanti{TeX Gyre Termes, Heros} ja
\englanti{Cursor} ovat kirjainperheiden nimiä. Fonttitiedostojen
tulee olla asennettuna käyttöjärjestelmän normaalien käytäntöjen
mukaisesti tai Latex\-/jakelun käytäntöjen mukaisesti.

Kirjainperheiden käyttöönoton yhteydessä voi määritellä lukuisia
asetuksia kuten ligatuureja, gemenanumeroita, optisia kokoja ja muita
fontin ominaisuuksia. Edellisessä esimerkissä käytetään vain
\koodi{Scale}\-/valitsinta, jolla fontin voi skaalata haluttuun kokoon.

Peruskirjainperheen (\koodi{\keno set\-main\-font}) skaalaukseksi
asetetaan \koodi{Scale=1}, eli sille ei tehdä mitään, ja koko valitsimen
voisi jättää pois. Sen sijaan kahdella muulla kirjainperheellä
(\koodi{\keno set\-sans\-font}, \koodi{\keno set\-mono\-font}) käytetään
ker\-roin\-ase\-tus\-ta \koodi{MatchLowercase}, joka skaalaa fontin
siten, että gemenakirjaimet eli pienet kirjaimet ovat yhtä korkeita kuin
peruskirjainperheessä. Mikäli skaa\-laus\-ase\-tus
\koodi{MatchLowercase} ei tuota ihan toivottua tulosta, voi
kirjainperheen skaalausta hienosäätää vielä
\koodi{Scale\-Again}\-/valitsimella seuraavaan tapaan:

\begin{koodilohkosis}
  \setmonofont{TeX Gyre Cursor}
  [Scale=MatchLowercase, ScaleAgain=.97]
\end{koodilohkosis}

Kirjainperheen määrittelyn yhteydessä ei yleensä tarvitse antaa kuin
kirjainperheen nimi, sillä \paketti{fontspec}\-/paketti ja kääntäjät
osaavat automaattisesti ladata perheeseen sisältyviä eri
fonttitiedostoja kuten pysty\-asen\-toi\-sen leikkauksen, kursiivin ja
lihavoinnin. On kuitenkin mahdollista määritellä kirjainperheeseen
kuuluvia leikkausten nimiä tai fonttitiedostoja erikseen. Tällainen on
tarpeen esimerkiksi silloin, kun kirjainperhe sisältää useita eri
vahvuuksia ja halutaan itse määritellä, mikä niistä tulee
perusvahvuudeksi ja mikä lihavoiduksi.

Esimerkki \ref{esim:fontit_leik_omin} selventää, kuinka kirjainperheen
eri leikkausten nimet tai fonttitiedostot määritellään. Kullekin
leikkaukselle voi määrittää myös omat asetuksensa
\koodi{Fea\-tures}\-/loppuisella valitsimella. Samaa asiaa
havainnollistetaan myös konkreettisemmin esimerkissä
\ref{esim:fontit_leik_omin_kayt}. Leikkauksen nimessä voi käyttää tähteä
(\koodi{*}), joka korvautuu kirjainperheen nimellä (\englanti{Macklin
  Text}).

\begin{esimerkki*}
\begin{koodilohko}
  \setmainfont{…}[
    UprightFont={…},     UprightFeatures={…},
    ItalicFont={…},      ItalicFeatures={…},
    BoldFont={…},        BoldFeatures={…},
    BoldItalicFont={…},  BoldItalicFeatures={…},
    SlantedFont={…},     SlantedFeatures={…},
    BoldSlantedFont={…}, BoldSlantedFeatures={…},
    SmallCapsFont={…},   SmallCapsFeatures={…}]
\end{koodilohko}
\caption{Kirjainperheeseen sisältyvien leikkausten nimien ja
  kirjainleikkauskohtaisten ominaisuuksien määrittely}
\label{esim:fontit_leik_omin}
\end{esimerkki*}

\begin{esimerkki*}
\begin{koodilohko}
  \setmainfont{Macklin Text}[
    UprightFont    = {* Light},
    ItalicFont     = {* Light Italic},
    BoldFont       = {* Medium},
    BoldItalicFont = {* Medium Italic}]
\end{koodilohko}
\caption{Eri leikkausten nimien määrittely \englanti{Macklin Text}
  \=/kirjainperheelle. Leikkauksen nimessä tähti (\koodi{*}) korvautuu
  automaattisesti koko perheen nimellä}
\label{esim:fontit_leik_omin_kayt}
\end{esimerkki*}

Jos edellä kuvatut kolme kirjainperhettä (\koodi{\keno set\-main\-font},
\koodi{\keno set\-sans\-font} ja \koodi{\keno set\-mono\-font}) eivät
riitä, on \paketti{fontspec}\-/paketissa komennot lisäperheiden ja
\=/leikkausten määrittämiseen. Uusi perhe määritellään seu\-raa\-vasti:

\begin{koodilohkosis}
  \newfontfamily{\hienoperhe}{TeX Gyre Schola}[…]
\end{koodilohkosis}

Komento \koodi{\keno new\-font\-family} toimii samalla tavalla kuin
aiemmin esitellyt \koodi{\keno set\-main\-font} ym. komennot, mutta
lisäksi ensimmäisellä argumentilla nimetään komento, jolla kirjainperhe
otetaan käyttöön. Edellisessä esimerkissä luodaan komento \koodi{\keno
  hieno\-perhe}, joka kytkee päälle \englanti{TeX Gyre Schola}
\=/nimisen kirjainperheen.

Jos ei tarvita kokonaista perhettä vaan yksi leikkaus riittää, käytetään
komentoa \koodi{\keno new\-font\-face}. Seuraavassa esimerkissä
määriteltävä komento \koodi{\keno hieno\-leikkaus} ottaa käyttöön
lihavoidun (bold) kirjainleikkauksen perheestä \englanti{TeX Gyre
  Schola}.

\begin{koodilohkosis}
  \newfontface{\hienoleikkaus}{TeX Gyre Schola Bold}[…]
\end{koodilohkosis}

\subsection{Fontin koko ja rivikorkeus}

Fonttien koot on tapana valita ja ilmaista typografisen pistemitan
avulla. Esimerkiksi 10--12 pistettä on tyypillinen leipätekstin
oletuskoko teks\-tin\-kä\-sit\-tely\-ohjel\-mis\-sa. Piste on
typografiassa mitta\-yksikkö, jonka pituus on määritelty eri tavoin eri
aikoina ja eri kulttuureissa.

Myös Latexissa fonttien koot voi määritellä pistemittojen avulla. Niitä
ja muitakin Latexin mit\-ta\-yk\-si\-köi\-tä käsitellään tarkemmin
luvussa \ref{luku:mitat}. Fonteissa ole\-tus\-mitta\-yk\-sik\-kö\-nä on
vanha pica\-/järjestelmän piste, jonka pituus on noin 0,3515
millimetriä. Sen lyhenne Latexissa on~\emph{pt}. Tämän oppaan
esimerkeissä käytetään kuitenkin Post Script \=/standardin mukaista,
julkaisuohjelmiin vakiintunutta uudempaa pica\-/pistettä, joka on hieman
edellistä pidempi: noin 0,3528 millimetriä. Latexissa sen lyhenne
on~\emph{bp}. Ero näiden kahden pistemitan välillä on hyvin pieni,
tavallisilla fonttiko'oilla käytännössä merkityksetön.

Kirjainleikkauksen koko mitataan merkistön ylimmän ja alimman kohdan
välillä, esimerkiksi k\=/kirjaimen ylimmän pisteen ja y\=/kirjaimen
alimman pisteen välillä. Lisäksi mittaan luetaan mukaan merkistön ylä-
ja alapuolella oleva pieni tyhjä tila, jonka fontin suunnittelija on
määritellyt.

Matalalla tasolla fonttien kokoon vaikuttaa Latexissa eräs yllättävä
asia. Nimittäin dokumenttiluokalle (luku \ref{luku:dokumenttiluokat})
voi antaa valitsimen, jolla koko asetetaan. Vaihtoehtoja on Latexin
normaaleissa dokumenttiluokissa vain kolme: \koodi{10pt} (oletus),
\koodi{11pt} ja \koodi{12pt}. Dokumenttiluokan koko\-asetus vaikuttaa
myös sivun marginaaleihin, koska Latex pyrkii pitämään rivin
merkkimäärän lukijalle sopivana: yhdelle riville ei kannata latoa ihan
mahdottomasti merkkejä, koska rivin seuraaminen vaatii enemmän
keskittymistä.

Fontin koon määrittäminen dokumenttiluokan valitsimella ehkä kuuluu jo
vähän menneisyyteen, mutta voi sitä edelleen käyttää, jos se riittää ja
sillä saa halutun lopputuloksen. Yleensä lienee järkevää jättää
dokumenttiluokan fonttiasetus oletukseksi (\koodi{10pt}) ja käyttää koon
asettamiseen luvuissa \ref{luku:fontti_suhteellinen} ja
\ref{luku:fontti_absoluuttinen} kerrottuja tapoja. Sivun marginaalien ja
muiden mittojen määrittämiseen on ohjeita luvussa
\ref{luku:sivuasetukset}.

Fonttiasetuksiin kuuluu fontin koon lisäksi toinenkin mitta: rivikorkeus
(\koodi{\keno base\-line\-skip}). Se on peräkkäisten rivien
peruslinjojen välinen etäisyys. Fontin koko ja rivikorkeus määritellään
saman\-aikaisesti, koska ne ovat saman \koodi{\keno fontsize}\-/komennon
argumentteja. Esimerkki:

\begin{koodilohkosis}
  \fontsize{10bp}{12bp} \selectfont
\end{koodilohkosis}

Ensimmäinen argumentti on fontin kokomitta ja toinen on rivikorkeus.
Mitta\-yksiköt voivat olla mitä tahansa Latexin mittoja, ja oletuksena
käytetään pt\-/pistemittaa, jos yksikköä ei ole mainittu. Komento
\koodi{\keno select\-font} on mukana, koska vasta sen myötä matalan
tason fonttikomennot tulevat voimaan. Korkean tason fonttikomennot (luku
\ref{luku:fontit_korkea}) suorittavat sen automaattisesti.

Rivikorkeus on vähintään sama kuin fontin koko, mutta yleensä se
asetetaan pari pistettä suuremmaksi, jotta rivit eivät olisi liian
lähellä toisiaan. Esimerkissä \ref{esim:rivikorkeus} on kaksi erilaista
\koodi{\keno fontsize}\-/komentoa ja ladottu lopputulos.

\begin{esimerkki*}
\begin{koodilohko}
  \fontsize{8bp}{11bp}\selectfont Tässä on pienehkö leipätekstin
  fonttikoko ja suhteellisen suuri rivikorkeus. Pitkät rivit vaativat
  suuremman rivikorkeuden kuin lyhyet rivit.

  \fontsize{16bp}{17bp}\selectfont Tässä on melko suuri fontti ja
  suhteellisen pieni rivikorkeus. Suuri fontti ja lyhyet rivit eivät
  tarvitse kovin suurta rivikorkeutta.
\end{koodilohko}
\begin{tulos}
  \fontsize{8bp}{11bp}\selectfont Tässä on pienehkö leipätekstin
  fonttikoko ja suhteellisen suuri rivikorkeus. Pitkät rivit vaativat
  suuremman rivikorkeuden kuin lyhyet rivit.

  \fontsize{16bp}{17bp}\selectfont Tässä on melko suuri fontti ja
  suhteellisen pieni rivikorkeus. Suuri fontti ja lyhyet rivit eivät
  tarvitse kovin suurta rivikorkeutta.
\end{tulos}
\caption{Fontin koon ja rivikorkeuden asettaminen ja vaikutus}
\label{esim:rivikorkeus}
\end{esimerkki*}

Toinen tekstirivien peruslinjojen väliseen etäisyyteen vaikuttava asetus
on \koodi{\keno baselinestretch}. Se on desimaalilukukerroin, jolla
nykyinen rivikorkeus kerrotaan. Kerroin asetetaan helpoimmin komennolla
\koodi{\keno linespread}.\footnote{Toinen tapa: \koodi{\keno
    renewcommand\{\keno baselinestretch\}\{kerroin\}}}

\begin{koodilohkosis}
  \fontsize{10bp}{12bp} \linespread{1.3} \selectfont
\end{koodilohkosis}

Edellä oleva esimerkki asettaa fontin kooksi 10 pistettä ja
rivikorkeudeksi 12 pistettä. \koodi{\keno linespread}\-/komennolla
asetetun kertoimen vuoksi rivien peruslinjojen väliseksi etäisyydeksi
tulee lopulta 1,3 kertaa 12 pistettä eli 15,6 pistettä. Ei ole väliä,
kummassa järjestyksessä \koodi{\keno fontsize}- ja \koodi{\keno
  linespread}\-/komennot annetaan. Asetukset tulevat voimaan vasta
\koodi{\keno select\-font}\-/komennon jälkeen.

Käytännössä \koodi{\keno linespread} sopii rivikorkeuden yleistason
hienosäätöön esimerkiksi dokumentin esittelyosassa. Tilannekohtainen
rivikorkeus on parasta asettaa \koodi{\keno fontsize}\-/komennolla.

\subsection{Korkean tason komennot}
\label{luku:fontit_korkea}

Latexissa on joukko korkean tason fonttikomentoja, jotka on tarkoitettu
käytettäväksi sen jälkeen, kun matalan tason asetukset on kerran
määritetty. Taulukossa \ref{tlk:fonttimallikomennot} on komennot
kirjainperheen ja kirjainleikkauksen valintaan. Joka rivillä ensin
mainittu komento (esim. \koodi{\keno rm\-fam\-i\-ly}) vaikuttaa
tekstiin, joka tulee komennon jälkeen. Vaikutus\-alue rajoittuu nykyisen
ympäristön (luku \ref{luku:ymparistot}) sisään tai aaltosulkeilla (luku
\ref{luku:aaltosulkeet}) rajatun alueen sisään. Rivillä toisena olevalle
komennolle (esim. \koodi{\keno text\-rm\{\ldots\}}) annetaan yksi
argumentti, ja komennon vaikutus koskee vain argumenttina olevaa
tekstiä.

\providecommand{\rivi}{}
\renewcommand{\rivi}[4]{%
  \koodi{\keno #1} & \koodi{\keno #2\{\ldots\}} & #3 & #4 \\}

\leijutlk{
  \begin{tabular}{llll}
    \toprule
    \multicolumn{2}{l}{\ots{Komento}}
    & \multicolumn{2}{l}{\ots{Merkitys}} \\

    \midrule
    \rivi {rmfamily} {textrm} {\rmfamily perhe}
    {perus, yl. antiikva, serif, roman}
    \rivi {sffamily} {textsf} {\sffamily perhe}
    {groteski, sans serif, gothic}
    \rivi {ttfamily} {texttt} {\ttfamily perhe}
    {tasalevyinen, typewriter}

    \midrule
    \rivi {mdseries} {textmd} {\mdseries leikkaus}
    {tavallinen vahvuus, medium}
    \rivi {bfseries} {textbf} {\bfseries leikkaus}
    {lihavoitu, bold}

    \midrule
    \rivi {upshape} {textup} {\upshape leikkaus}
    {pystyasento, tavallinen}
    \rivi {itshape} {textit} {\itshape leikkaus}
    {kursiivi, italic}
    \rivi {slshape} {textsl} {\slshape leikkaus}
    {kalteva, slanted, oblique}
    \rivi {scshape} {textsc} {\scshape leikkaus}
    {pienversaali, kapiteeli, small caps}
    \bottomrule
  \end{tabular}
}{
  \caption{Komennot kirjainperheen ja kirjainleikkauksen valintaan.
    Perustila on \koodi{\keno rm\-family}, \koodi{\keno md\-series} ja
    \koodi{\keno up\-shape}}
  \label{tlk:fonttimallikomennot}
}

Taulukossa on ensimmäisillä riveillä kirjainperhekomennot (3\,kpl),
jotka vaihtavat koko perheen kaikkine leikkauksineen. Niiden jälkeen
tulevat kirjainleikkauskomennot, jotka valitsevat toisen leikkauksen
samasta perheestä. Kirjainleikkauksen asetukset jaetaan kahteen ryhmään:
\englanti{\emph{series}} 'sarja' ja \englanti{\emph{shape}} 'muoto'.
Kummastakin ryhmästä on valittuna aina yksi ominaisuus, eli
samanaikaisesti voi olla voimassa esimerkiksi \koodi{\keno bf\-se\-ries}
(\textbf{lihavoitu}) ja \koodi{\keno it\-shape} (\textit{kursiivi}), ja
tuloksena on \textbf{\itshape lihavoitua kursiivia}.

Useimmissa fonteissa kursiivileikkaus (\koodi{\keno it\-shape}) ja
kalteva leikkaus (\koodi{\keno sl\-shape}) tuottavat saman
lopputuloksen, mutta käsitteellisesti ne ovat eri asia. Kursiivi on aina
muodoltaan erilainen leikkaus, joka hieman mukailee
käsi\-ala\-kir\-joi\-tusta, joskaan kirjaimia ei ole sidottu toisiinsa.
Sen sijaan kalteva leikkaus on tavallisen eli pys\-ty\-asen\-toi\-sen
leikkauksen kallistettu versio. Kallistus voi olla kirjainmuotoilijan
piirtämä leikkaus, tai kallistus on voitu toteuttaa mekaanisesti.
Kallistuksen voi tehdä myös Latexissa (luku \ref{luku:fontit_muut}).

Komennot fontin koon valintaan ovat taulukossa
\ref{tlk:fonttikokokomennot}. Taulukko kertoo myös, mitä fontin
pistekokoa (pt) mikäkin komento tarkoittaa oletuksena. Oletus riippuu
Latexin dokumenttiluokkien (luku \ref{luku:dokumenttiluokat})
fonttikokovalitsimista \koodi{10pt}, \koodi{11pt} ja \koodi{12pt}.

\leijutlk{
  \begin{tabular}{lr@{}lr@{}lr@{}l}
    \toprule
    \ots{Komento}
    & \multicolumn{2}{c}{\ots{10pt}}
    & \multicolumn{2}{c}{\ots{11pt}}
    & \multicolumn{2}{c}{\ots{12pt}} \\
    \midrule
    \koodi{\keno tiny} & 5 && 6 && 6 \\
    \koodi{\keno scriptsize} & 7 && 8 && 8 \\
    \koodi{\keno footnotesize} & 8 && 9 && 10 \\
    \koodi{\keno small} & 9 && 10 && 10&,95 \\
    \koodi{\keno normalsize} & 10 && 10&,95 & 12 \\
    \koodi{\keno large} & 12 && 12 && 14&,4 \\
    \koodi{\keno Large} & 14&,4 & 14&,4 & 17&,28 \\
    \koodi{\keno LARGE} & 17&,28 & 17&,28 & 20&,74 \\
    \koodi{\keno huge} & 20&,74 & 20&,74 & 24&,88 \\
    \koodi{\keno Huge} & 24&,88 & 24&,88 & 24&,88 \\
    \bottomrule
  \end{tabular}
}{
  \caption{Fonttien oletuspistekoot dokumenttiluokkien valitsimilla
    \koodi{10pt}, \koodi{11pt} ja \koodi{12pt}}
  \label{tlk:fonttikokokomennot}
}

% \pagebreak[3]

Kaikille korkean tason fonttikomennoille on olemassa myös samanniminen
ympäristönsä. Seuraavassa esimerkissä on kaksi fontteihin vaikuttavaa
ympäristöä sisäkkäin.

% \pagebreak[3]

\begin{koodilohkosis}
  \begin{footnotesize}
    \begin{scshape}
      Tämä teksti on pientä pienversaalia.
    \end{scshape}
  \end{footnotesize}
\end{koodilohkosis}

\begin{tulossis}
  \begin{footnotesize}
    \begin{scshape}
      Tämä teksti on pientä pienversaalia.
    \end{scshape}
  \end{footnotesize}
\end{tulossis}

% \pagebreak[3]

\subsection{Koot suhteellisesti}
\label{luku:fontti_suhteellinen}

Dokumentin fonttien koot on helpointa määrittää siten, että asettaa
ensin peruskirjainperheen koon ja antaa muiden fonttien määräytyä
suhteessa siihen. Esimerkki \ref{esim:fontti_suhteellinen} selventää,
kuinka se tapahtuu. Alussa otetaan käyttöön dokumenttiluokka
\koodi{article} ja annetaan sille valitsin \koodi{10pt}, joka määrittää
fonttikooksi 10 pistettä. Se on dokumenttiluokan ole\-tus\-ase\-tus,
jota ei tarvitsisi edes kirjoittaa näkyviin. Esimerkin toisella rivillä
otetaan \paketti{fontspec}\-/paketti käyttöön.

Peruskirjainperheen (rivi~4) koko skaalataan 1,4\-/kertaiseksi, eli
pistekooksi tulee 1,4 kertaa 10 pistettä eli 14 pistettä (pt).
Normaalikokoinen peruskirjainperhe on ainoa, jonka pistekoko tiedetään.
Kaikkien muiden koot täytyisi selvittää laskemalla.

Groteski eli pääteviivaton kirjainperhe (rivi~5) ja tasalevyinen perhe
(rivi~6) skaalataan samankorkuiseksi kuin perusperhe. Vertailukohtana
ovat gemenat eli pienaakkoset (\koodi{MatchLowercase}). Näiden kahden
kirjainperheen pistekokoa ei tiedetä. Se ei välttämättä ole sama kuin
perusfontissa, koska fonttien pistekoko mitataan ylimmän ja alimman
kohdan välillä ja koska fonttien mittasuhteet ovat erilaisia.

\begin{esimerkki*}
\begin{koodilohko}
  \documentclass[10pt]{article} % 10pt on oletus
  \usepackage{fontspec}

  \setmainfont{TeX Gyre Termes}[Scale=1.4]
  \setsansfont{TeX Gyre Heros} [Scale=MatchLowercase]
  \setmonofont{TeX Gyre Cursor}[Scale=MatchLowercase]
  \linespread{1.45}
\end{koodilohko}
\caption{Fonttikokojen määrittäminen suhteessa peruskirjainperheeseen}
\label{esim:fontti_suhteellinen}
\end{esimerkki*}

Viimeisellä rivillä oleva \koodi{\keno linespread}\-/komento on tärkeä.
Se asettaa rivikorkeuden kertoimeksi 1,45. Kertoimen täytyy olla
vähintään yhtä suuri kuin peruskirjainperheen skaalauskerroin (1,4),
jotta rivivälit ovat riittävän suuret. Näiden asetusten jälkeen
dokumentissa käytetään korkeamman tason komentoja fonttien valintaan,
esimerkiksi fonttikoon valintakomentoja \koodi{\keno small},
\koodi{\keno normalsize}, \koodi{\keno large} (taulukko
\ref{tlk:fonttikokokomennot}).

Edellä kuvatussa suhteellisessa kirjainperheiden koon määrittelyssä on
sellainen ongelma tai kummallisuus, että Latex koko ajan luulee, että
peruskirjainperhe on normaalikokoisena 10 pistettä (pt). Latexin matalan
tason fonttikomennot eivät tiedä kirjainperheen skaalauskertoimesta, ja
siksi esimerkiksi komentojen

\begin{koodilohkosis}
  \fontsize{10bp}{12bp} \selectfont
\end{koodilohkosis}

tuloksena ei todellisuudessa ole 10 pisteen (bp) fontti, vaan mukaan
lasketaan myös kirjainperheen skaalauskerroin. Tämän vuoksi \koodi{\keno
  fontsize}\-/komennon käyttö menee aika oudoksi. Argumenttina annettu
kokomitta ei pidä paikkaansa.

Jos korkean tason font\-ti\-koko\-komen\-to\-jen (taulukko
\ref{tlk:fonttikokokomennot}) lisäksi tarvitaan jotakin muuta kokoa,
voisi mahdollisesti \koodi{\keno fontsize}\-/komennon sijasta käyttää
\paketti{fontspec}\-/paketin tarjoamaa komentoa ja tilanteeseen sopivaa
skaalauskerrointa esimerkiksi seuraavalla tavalla:

\begin{koodilohkosis}
  {\addfontfeatures{Scale=3.2} Poikkeuksellisen isoa tekstiä}
\end{koodilohkosis}

Jos edellä mainitut kummallisuudet eivät häiritse eikä ole tarvetta
määritellä fontteja tarkasti tietyn pistekoon mukaiseksi, on
suhteellinen määrittelytapa todella helppo. Kaikki dokumentin fontit
määräytyvät perusfontin skaalauskertoimen kautta. Tämä tapa sopii hyvin
varsinkin dokumentin sisällön kirjoittamisvaiheeseen, jossa ehkä
halutaan vain nopeasti asettaa dokumentti suurin piirtein järkevän
näköiseksi. Myöhemmin voi määrittää koot tarkemmin niin sanotun
absoluuttisen menetelmän avulla, jota käsitellään seuraavassa luvussa.

\subsection{Koot absoluuttisesti}
\label{luku:fontti_absoluuttinen}

Absoluuttinen fonttien koonmääritystapa tarkoittaa sitä, että koot
asetetaan tietyn kokoiseksi käyttämällä esimerkiksi pistemittoja ja että
kirjaimet myös päätyvät lopulliseen dokumenttiin juuri sen kokoisena.
Tämä tapa on myös teknisesti eheä, eli Latexin eri osat ovat samaa
mieltä siitä, minkäkokoisesta fontista on kyse. Näin ei ollut
suhteellisen tavan kanssa (luku \ref{luku:fontti_suhteellinen}).

Joskus yrityksen, oppilaitoksen tai muun julkaisijan ohjeissa
määritellään tarkasti, mitä fontteja käytetään ja mikä on leipätekstin
ja otsikoiden fonttikoko. Silloin tarvitaan tässä luvussa kuvattua tapaa
fonttien asettamiseen.

\begin{esimerkki*}
\begin{koodilohko}
  \documentclass{article}
  \usepackage{fontspec}

  % Leipätekstiin samankokoiset fontit
  \setmainfont{TeX Gyre Termes}
  \setsansfont{TeX Gyre Heros} [Scale=MatchLowercase]
  \setmonofont{TeX Gyre Cursor}[Scale=MatchLowercase]

  % Muualle sans ja mono ilman skaalausta
  \newfontfamily{\sffamilyabs}{TeX Gyre Heros}
  \newfontfamily{\ttfamilyabs}{TeX Gyre Cursor}

  \linespread{1} % ei välttämättä tarvita

  % Kaikki tarvittavat fonttikoot ja komennot
  \renewcommand{\footnotesize}{\fontsize{10bp}{12bp}\selectfont}
  \renewcommand{\small}       {\fontsize{12bp}{14bp}\selectfont}
  \renewcommand{\normalsize}  {\fontsize{14bp}{17bp}\selectfont}
  \renewcommand{\large}       {\fontsize{17bp}{19bp}\selectfont}
  \renewcommand{\Large}       {\fontsize{20bp}{22bp}\selectfont}
  \normalsize % jotta tulee heti voimaan eikä vasta tekstiosassa
\end{koodilohko}
\caption{Fonttikokojen määrittäminen pistekoon avulla}
\label{esim:fontti_absoluuttinen}
\end{esimerkki*}

Esimerkistä \ref{esim:fontti_absoluuttinen} selviää perus\-ajatus.
Peruskirjainperhe (rivi~5) otetaan käyttöön ilman skaalausta (eli
\koodi{Scale=1}), minkä vuoksi koon voi jatkossa asettaa täsmälleen
kohdalleen \koodi{\keno fontsize}\-/komennolla. Samaa ei tehdä groteskin
eikä tasalevyisen fontin kanssa (rivit 6--7), vaan käytetään skaalausta
\koodi{MatchLowercase}, jotta tekstikappaleessa kaikki kirjainperheet
näyttävät samankokoisilta. Tässä menetetään mahdollisuus määrittää
näiden kirjainperheiden koko täsmällisesti pistemitan avulla. Jos siihen
on tarvetta esimerkiksi otsikoissa, voidaan käyttää rivien 10--11
komentoja. Niillä luodaan uudet kirjainperheet, jotka ovat käytännössä
samoja mutta ilman skaalausta.

Uusien skaalaamattomien kirjainperheiden komentojen nimiksi on valittu
\koodi{\keno sf\-fam\-i\-ly\-abs} ja \koodi{\keno tt\-fam\-i\-ly\-abs}
(vrt. \koodi{\keno sffamily} ja \koodi{\keno ttfamily}, taulukko
\ref{tlk:fonttimallikomennot}), ja näillä komennoilla kirjainperheet
kytketään päälle. Jos esimerkiksi jonkin julkaisun vaatimuksiin kuuluu,
että otsikossa täytyy olla 16 pisteen lihavoitu TeX Gyre Heros
\=/kirjainleikkaus, voi esimerkissä \ref{esim:fontti_absoluuttinen}
olevien asetusten pohjalta antaa otsikolle seuraavat komennot:

\begin{koodilohkosis}
  \sffamilyabs\fontsize{16bp}{18bp}\bfseries
\end{koodilohkosis}

Esimerkin \ref{esim:fontti_absoluuttinen} riveillä 16--20 määritellään
uudelleen Latexin korkean tason komennot, joilla fonttikoot asetetaan.
Oletus\-arvot tulevat dokumenttiluokasta (luku
\ref{luku:dokumenttiluokat}), mutta jos ne eivät ole sopivia, täytyy
vähintäänkin määritellä komento \koodi{\keno normal\-size} mutta sen
lisäksi kaikki ne koot, joita omassa dokumentissa tarvitaan. Tässä
esimerkissä normaali koko asetetaan 14 pisteen kokoiseksi.

Jokaiselle fonttikoolle määritetään riveillä 16--20 myös oma
rivikorkeus, ja se on tarkoitus asettaa sopivaksi juuri kyseiselle
koolle. Rivikorkeuteen vaikuttaa myös kerroin \koodi{\keno
  baselinestretch}, joka asetetaan komennolla \koodi{\keno linespread}.
Sitä ei välttämättä tarvitse käyttää, koska kirjainperheitä ei ole
skaalattu ja koska rivikorkeus asetetaan aina \koodi{\keno
  fontsize}\-/komennolla. \koodi{\keno linespread} on kuitenkin kätevä
komento rivikorkeuden säätämiseen yleisesti kaikkialla.

Fonttikokojen määrittelyn lopuksi rivillä 21 suoritetaan komento
\koodi{\keno normal\-size}, jotta se tulee heti voimaan. Dokumentin
esittelyosassa voidaan käyttää fonttikokoon viittaavia mittoja
\koodi{em} ja \koodi{ex}, ja ne viittaavat nyt tähän kokoon.
\koodi{\keno normal\-size}\-/komento suoritetaan kyllä myöhemmin
automaattisesti dokumentin tekstiosan eli \koodi{document}\-/ympäristön
alussa.

Edellä kuvatun absoluuttisen koonmääritystavan etuna on se, että
kirjoittaja hallitsee fonttien kokoa ja rivikorkeuksia tarkasti ja että
julkaisuun saadaan juuri ne mitat, jotka halutaan tai vaaditaan. Tapa on
myös teknisesti eheä eli toimii Latexin sisäisen logiikan näkökulmasta
oikein. Haittana voi pitää sitä, että kaikki koot täytyy määritellä
erikseen.

\subsection{Fonttien oletus\-asetuksia}

Oletuksena%
\koodimargin{\keno setmainfont} \koodimargin{\keno setsansfont}
Latex\-/dokumentin peruskirjainperheessä (\koodi{\keno set\-main\-font})
ja pääteviivattomassa kirjainperheessä (\koodi{\keno set\-sans\-font})
on päällä muun muassa seuraavat asetukset:%

\begin{koodilohkosis}
  Ligatures={TeX, Common}
  HyphenChar={-}
\end{koodilohkosis}

\koodi{TeX}\-/ligatuurit tarkoittavat lainausmerkkien ja ajatusviivojen
tuottamiseen tarkoitettuja Texin erikoismerkkejä kuten \koodi{''} ja
\koodi{\==}, joita käsitellään luvuissa \ref{luku:lainausmerkit} ja
\ref{luku:yhdys_ajatus_miinus}. Ne eivät ole varsinaisia luonnollisen
kielen eivätkä typografisia ligatuureja vaan kuuluvat ainoastaan
Tex\-/kielen merkintätapoihin. \koodi{Common}\-/ligatuurit sen sijaan
ovat oikeita typografisia ligatuureja kuten fi, ff ja fl, ja niitä
käsitellään tarkemmin luvussa \ref{luku:typo_liga}. Molemmat edellä
mainitut ligatuurityypit saa pois päältä seuraavalla asetuksella:

\begin{koodilohkosis}
  Ligatures={TeXReset, NoCommon}
\end{koodilohkosis}

Valitsin \koodi{Hyphen\-Char} asettaa tavutusmerkin kyseiselle
kirjainperheelle. Oletuksena se on yhdysmerkki (\=/), mutta merkin
vaihtaminen muuksi kuin yhdysmerkiksi toimii vain Xelatex\-/kääntäjän
kanssa, ei esimerkiksi Lualatexilla. Sen sijaan kaikilla kääntäjillä
tavutuksen voi kytkeä kirjainperheeltä pois, kun antaa arvoksi
\koodi{None}. Tavutusta käsitellään perusteellisemmin luvussa
\ref{luku:tavutus}.

Tasalevyinen%
\koodimargin{\keno setmonofont} kirjainperhe (\koodi{\keno
  set\-mono\-font}) toimii oletuksena hieman eri tavalla. Niissä muun
muassa ei ole lainausmerkkien ja ajatusviivojen kirjoittamiseen
tarkoitetut Tex\-/ligatuurit päällä. Oletusasetuksia ovat muun muassa
seuraavat:

\begin{koodilohkosis}
  Ligatures=Common
  HyphenChar=None
\end{koodilohkosis}

Yleensä tasalevyisestä kirjainperheestä kannattaa kytkeä typografiset
ligatuurit pois päältä asetuksella \koodi{Liga\-tures=\katk No\-Common}.
Tasalevyisen fontin ajatukseen nimenomaan kuuluu, että merkit ovat
samanlevyisiä eikä yhden merkin tilaan sovi sulloa useampaa kirjainta.

Oletuksena tavutus on kytketty pois päältä, koska tasalevyistä fonttia
käytetään tavallisesti tietokoneisiin liittyvien koodien tai vastaavien
ilmausten latomiseen, eikä niitä haluta yleensä tavuttaa. Tavutuksen saa
kuitenkin päälle antamalla arvoksi yhdysmerkin
(\koodi{Hyphen\-Char=\katk \{\=/\}}) tai Xelatex\-/kääntäjällä minkä
tahansa merkin.

Komennolla%
\koodimargin{\keno default\-font\-features} \koodi{\keno
  default\-font\-features} voi asettaa (joidenkin) kirjainperheiden
oletusasetukset, kun komennon suorittaa ennen kirjainperheiden
määrittelyä.

\begin{koodilohkosis}
  \defaultfontfeatures[\rmfamily,\sffamily]{Ligatures={TeX, Common},
    Numbers=Lowercase}
\end{koodilohkosis}

Komennon valinnaisella argumentilla voi rajata, mitä kirjainperheitä
oletusasetukset koskevat. Valinnaiseen argumenttiin kirjoitetaan yksi
tai useampia pilkulla erotettuja komentoja, joilla kirjainperheet
kytketään päälle: \koodi{\keno rmfamily}, \koodi{\keno sffamily},
\koodi{\keno ttfamily} (taulukko \ref{tlk:fonttimallikomennot},
s.~\pageref{tlk:fonttimallikomennot}) tai komennolla \koodi{\keno
  new\-font\-family} määritelty fonttikomento (luku
\ref{luku:fontin_valinta}).

\subsection{Typografiset ligatuurit}
\label{luku:typo_liga}

Typografiset ligatuurit ovat fontissa olevia yhdistelmämerkkejä, joissa
on typografisista syistä yhdistetty kaksi tai useampia kirjaimia yhteen
merkkiin.%
\footnote{Typografisten ligatuurien lisäksi on olemassa myös
  luonnollisten kielten ligatuureja, jotka muodostavat kieleen kuuluvan
  kirjaimen, kuten æ norjan kielessä. Niillä on jokin luonnolliseen
  kieleen liittyvä merkitys, eikä eri merkkejä ei ole yhdistetty
  typografisista syistä.} Tällaisia ligatuureja käytettiin jo
metalliladonnassa, eli samassa metallikirjakkeessa saattoi olla enemmän
kuin yksi kirjain.

Typografisten ligatuurien tarkoituksena on tuottaa tyylikkäämpi
lopputulos kuin saataisiin erillisten kirjainten avulla. Syynä on
esimerkiksi se, että erilliset peräkkäiset kirjaimet eivät ole aina
keskenään yhteensopivia. Kirjainten välistys voi olla ongelmallista:
sopivalle etäisyydelle asetettaessa kirjainten osat voivat mennä
rumannäköisesti päällekkäin. Riippuu fontista, mitkä ligatuurit ovat
tarpeellisia ja mitkä ligatuurimerkit on ylipäätään toteutettu fontin
merkistöön. Tavallisia an\-tiik\-va\-kir\-jain\-leik\-kaus\-ten
ligatuureja ovat fi, ff, ffi, fl ja ffl, mutta jotkin fontit sisältävät
muitakin. Kuvaan \ref{kuva:ligatuurit} on koottu esimerkkejä.

\leijukuva{
  \erikoisfontti
  \addfontfeatures{Scale=3.5, Ligatures={Common, Historic}}
  fi ff ffi fl ffl Th fb st ct
}{
  \caption{Tavalliset f\=/alkuiset typografiset ligatuurit, vähän
    harvinaisemmat Th ja fb sekä erikseen päälle kytkettävät
    historialliset ligatuurit st ja ct}
  \label{kuva:ligatuurit}
}

Latex hoitaa tavallisten typografisten ligatuurien latomisen
automaattisesti, eli lähdedokumenttiin ei kannata kirjoittaa
Unicode\-/merkistön typografisia ligatuurimerkkejä (esimerkiksi
\uctunnus{u+fb01 latin small ligature fi}) vaan ihan tavallisia
erillisiä kirjaimia. \englanti{Open Type} \=/fontin suunnittelija on
päättänyt meidän puolestamme, mitkä kir\-jain\-yh\-dis\-tel\-mät on
parasta latoa ligatuurin avulla, ja ole\-tus\-ase\-tuk\-sil\-la Latex
noudattaa niitä ohjeita.

Jos kuitenkin yksittäisen ligatuurin muodostumisen haluaa estää, voi
kirjainten väliin kirjoittaa komennon \koodi{\keno
  text\-comp\-word\-mark}, joka tekee näkymättömän, juuri tähän
tarkoitukseen olevan merkin \uctunnus{u+200c zero width non-joiner}.

% \pagebreak[3]

\begin{koodilohkosis}
  fi f\textcompwordmark i
\end{koodilohkosis}

\begin{tulossis}
  fi f\textcompwordmark i
\end{tulossis}

Mikäli tavallisia ligatuureja ei halua käyttöön lainkaan, on parasta
valita jo kirjainperheen tai \=/leikkauksen käyttöönotossa asetus
\koodi{Liga\-tures=\katk No\-Com\-mon}. Väliaikaisesti fontin asetuksiin
voi vaikuttaa komennolla \koodi{\keno add\-font\-fea\-tures}, joka sekin
on \paketti{fontspec}\-/pakettiin sisältyvä komento.

\begin{koodilohkosis}
  {\addfontfeatures{Ligatures=NoCommon} fi fl}
\end{koodilohkosis}

Tavallisten ligatuurien lisäksi \englanti{Open Type} \=/fontit voivat
sisältää myös harvinaisempia ligatuureja, jotka täytyy erikseen kytkeä
päälle. Niiden tarkoituksena on esimerkiksi erityinen koristeellisuus
tai historiallisen kirjoitustavan jäljittely. Harvinaisia ligatuureja ei
ole tarkoitus käyttää joka tilanteessa vaan ainoastaan erityisestä
syystä. Kuvassa \ref{kuva:ligatuurit} ja tässäkin tekstissä olevat {%
  \newcommand{\hlig}[1]{{\erikoisfontti
      \addfontfeatures{Ligatures=Historic}#1}}%
  \hlig{st}- ja \hlig{ct}\-/ligatuurit%
} on saatu fontin asetuksella \koodi{Liga\-tures=\katk His\-toric}.
Joissakin fonteissa sama tehdään asetuksella \koodi{Liga\-tures=\katk
  Dis\-cre\-tionary}. Useitakin ligatuurityyppejä voi kytkeä päälle
samanaikaisesti:

\begin{koodilohkosis}
  Ligatures={TeX, Required, Common, Historic, Discretionary,
    Contextual}
\end{koodilohkosis}

Harva fontti sisältää kaikkia ligatuurityyppejä, eikä se ole
tarkoituskaan. Jotkin ligatuurit kuuluvat vain tiettyyn typografian
aikakauteen tai kirjaintyyliin. Open Type \=/fontin ominaisuuksia voi
selvittää käyttöjärjestelmän komentotulkissa komennolla
\koodi{otf\-info}. Komennon argumentiksi annetaan muun muassa
fonttitiedoston nimi.

\subsection{Numeroiden muoto}

Varsinkin kirjatypografiassa on tavallista käyttää pääasiassa
gemenanumeroita ({\gemenanum 1967}) eikä versaalinumeroita
({\versaalinum 1967}), koska gemenanumerot sopivat leipätekstin
gemenakirjainten kanssa paremmin yhteen. Versaalinumerot puolestaan
erottuvat paremmin ja sopivat esimerkiksi taulukoihin, joissa on paljon
lukuja. Näihin asetuksiin vaikutetaan fontin asetuksella
\koodi{Numbers}. Tosin kaikissa fonteissa ei gemenanumeroita edes ole.

\begin{koodilohkosis}
  Numbers=Lowercase % gemenanumerot
  Numbers=Uppercase % versaalinumerot (oletus)
\end{koodilohkosis}

Jotkin koodi-ilmaukset sisältävät versaalikirjaimia ja numeroita
sekaisin. Gemenanumerot eivät kuitenkaan sovi yhteen versaalikirjainten
kanssa, koska merkkien koko\-ero on häiritsevän suuri. Ei siis näin:
RJ45, R2D2. Gemenanumeroiden kanssa täytyy käyttää pienversaalia eli
kapiteelia: \textsc{rj45}, \textsc{r2d2}. Toinen vaihtoehto on käyttää
pelkästään versaaleja: {\versaalinum RJ45, R2D2}.

Silloin kun käytetään numeroita teknisten koodien ilmaisemiseen, voi
olla tarpeen merkitä numero nolla poikkiviivalla
({\addfontfeatures{Numbers={Uppercase, SlashedZero}} 0}), jottei se
sekoitu O\=/kirjaimeen. Nollaan saadaan poikkiviiva seuraavalla
asetuksella, jos vain fontissa on tämä ominaisuus:

\begin{koodilohkosis}
  Numbers=SlashedZero
\end{koodilohkosis}

Kun numeroita ladotaan taulukkoon, voidaan haluta käyttää tasalevyisiä
numeroita, jotta ne sijoittuvat allekkain samalle linjalle. Joissakin
fonteissa on tarjolla tavallisten vaihtelevan levyisten numeroiden
lisäksi myös tasalevyiset. Numeroiden leveyteen vaikutetaan seuraavilla
asetuksilla:

\begin{koodilohkosis}
  Numbers=Monospaced   % tasalevyiset numerot
  Numbers=Proportional % vaihtelevan levyiset numerot (oletus)
\end{koodilohkosis}

\subsection{Muita asetuksia}
\label{luku:fontit_muut}

Tässä luvussa käsitellään harvemmin tarvittavia mutta välillä
hyödyllisiä asetuksia, jotka eivät ole sidoksissa fonttitiedoston
ominaisuuksiin. Nämä asetukset muokkaavat fontin toimintaa kokonaan
Texin tai kääntäjien puolella.

Valitsimella%
\koodimargin{Fake\-Stretch} \koodi{Fake\-Stretch} voi venyttää tai
kutistaa merkkejä leveyssuunnassa. Arvoksi annetaan
desimaalilukukerroin, joka on suhdeluku alkuperäiseen leveyteen nähden.
Seuraavassa havainnollistava esimerkki:

\begin{koodilohkosis}
  esimerkki \\
  {\addfontfeatures{FakeStretch=1.3} esimerkki}
\end{koodilohkosis}

\begin{tulossis}
  esimerkki \\
  {\addfontfeatures{FakeStretch=1.3} esimerkki}
\end{tulossis}

Kirjainleikkauksen leventäminen tekee tekstistä samalla lihavampaa,
koska kirjainten viivat tulevat vahvemmiksi leveyssuunnassa.
Korkeussuunnassa vahvuus säilyy ennallaan, joten kirjainten
viivakontrasti muuttuu. Kirjainleikkauksen kutistaminen vaikuttaa
lihavuuteen päinvastaisesti. Tällainen mekaaninen fontin
''korjaileminen'' ei välttämättä tuota typografisesti kovin hyvää jälkeä
mutta voi sopia lievästi käytettynä esimerkiksi otsikoihin. Tämän oppaan
tasalevyistä kirjainperhettä on hieman kutistettu, koska alkuperäinen on
kohtuuttoman leveä ({\ttfamily\addfontfeatures{FakeStretch=1}
  esimerkki}) verrattuna muiden kirjainperheiden leveyteen.

Jos%
\koodimargin{Fake\-Bold} \koodimargin{Fake\-Slant} kirjainperheeseen ei
sisälly sopivaa lihavoitua tai kaltevaa leikkausta, voi sellaiset
koettaa tehdä myös keinotekoisesti \koodi{Fake\-Bold}- ja
\koodi{Fake\-Slant}\-/valitsimien avulla. Niille annetaan arvoksi
desimaalilukukerroin. Valitettavasti \koodi{Fake\-Bold} toimii vain
Xelatex\-/kääntäjän kanssa.

\begin{koodilohkosis}
  pysty {\addfontfeatures{FakeSlant=.2} kalteva}
\end{koodilohkosis}

\begin{tulossis}
  pysty {\addfontfeatures{FakeSlant=.2} kalteva}
\end{tulossis}

Mekaanisen lihavoinnin tai kallistuksen saa osaksi kirjainperhettä, kun
asettaa kirjainperheen määrittelyn yhteydessä halutun kirjainleikkauksen
valitsimella \koodi{Bold\-Font} tai \koodi{Slanted\-Font} ja määrittää
niille erityisiä ominaisuuksia valitsimella \koodi{Bold\-Fea\-tures} tai
\koodi{Slanted\-Fea\-tures}. Seuraava esimerkki asettaa dokumentin
perusfontille kaltevan leikkauksen. Tämän jälkeen komento \koodi{\keno
  sl\-shape} (taulukko \ref{tlk:fonttimallikomennot},
s.~\pageref{tlk:fonttimallikomennot}) valitsee \textsl{kaltevan}
leikkauksen, joka on siis eri asia kuin \textit{kursiivi} (\koodi{\keno
  it\-shape}).

\begin{koodilohkosis}
  \setmainfont{…}[
    SlantedFont={…}, % tähän pystyasentoinen leikkaus
    SlantedFeatures={FakeSlant=.2}]
\end{koodilohkosis}

Fontin%
\koodimargin{Word\-Space} kanssa käytettäviä sanavälejä voi säätää
\koodi{Word\-Space}\-/valitsimella, jonka arvoksi annetaan
desimaalilukukerroin eli suhdeluku normaaliin verrattuna. Arvona voi
olla myös kolme eri kerrointa, jolloin mukana on lisäksi sanavälin
venymisen rajat. Tämä asetus on tehtävä kirjainperheen tai
\=/leikkauksen määrittelyn yhteydessä, eli se ei toimi esimerkiksi
\koodi{\keno add\-font\-features}\-/komennon kanssa. Katso tietoa
sanaväleistä myös luvusta \ref{luku:sanavali} tai tekstikappaleiden
latomista käsittelevästä luvusta \ref{luku:kappale}.

Fontti\-asetusten valitsimella%
\koodimargin{Letter\-Space} \koodi{Letter\-Space} säädetään merkkien
välistystä eli niiden välistä tyhjää tilaa. Arvoksi annetaan
positiivinen tai negatiivinen prosenttiluku, joka ilmaisee alkuperäiseen
lisättävän osuuden. Asetus \koodi{Letter\-Space=\katk 8} tuottaa siis 8
prosenttia leveämmät merkkien välit.

Välistyksen tiivistäminen voi sopia suuriin otsikoihin, kun taas
harventaminen voi sopia yksittäisiin versaali\-/{} tai
pienversaalikirjaimilla ladottaviin sanoihin. Näitä korostuskeinoja
käsitellään luvussa \ref{luku:korostus}, mutta seuraavassa on esimerkki,
kuinka se teknisesti toteutetaan:

\begin{koodilohkosis}
  \scshape normaali \\
  {\addfontfeatures{LetterSpace=8} harvennus}
\end{koodilohkosis}

\begin{tulossis}
  \scshape normaali \\
  {\addfontfeatures{LetterSpace=8} harvennus}
\end{tulossis}

Jos harvennuksen haluaa automaattisesti mukaan kirjainperheeseen
kuuluvaan pienversaaliin, käytetään valitsinta
\koodi{Small\-Caps\-Features}:

\begin{koodilohkosis}
  \setmainfont{…}[SmallCapsFeatures={LetterSpace=8}]
\end{koodilohkosis}

\section{Kieli}
\label{luku:kieliasetukset}

Melkein aina Latex\-/dokumenttiin täytyy ladata kielipaketti ja sen
mukana asetukset tiettyjä kieliä varten. Kieliasetukset sisältävät
ainakin tavutussäännöt (luku \ref{luku:tavutus}) sekä kielelle
mukautettuja nimiä dokumentin eri osille. Esimerkiksi sisällysluettelon
ja kirjallisuusluettelon otsikot tulevat kieliasetuksista, samoin
leijuvien taulukoiden ja kuvien nimet ''\tablename'' ja ''\figurename''.
Myös muita asetuksia tai komentoja saattaa tulla kieliasetusten mukana,
mutta ne vaihtelevat eri kielissä.

Kielipaketteja on kaksi -- \paketti{babel}\avctan{babel} ja
\paketti{polyglossia}\avctan{polyglossia} \==, ja käyttäjän täytyy
valita niistä jompikumpi. Pakettien historia ja kehitys on suunnilleen
seuraavanlainen: \paketti{babel} on paljon vanhempi, ja monet vanhat
oppaat ja esimerkit käsittelevät pelkästään sitä. Kun Latex siirtyi
Unicode\-/aikaan Xelatex\-/kääntäjän ja \paketti{fontspec}\-/paketin
myötä, \paketti{babel} ei pysynyt kehityksessä mukana. Syntyi
\paketti{polyglossia}, joka hallitsee Unicoden sekä muitakin kuin
latinalaiseen kirjaimistoon perustuvia kieliä ja kirjoitusjärjestelmiä.
\paketti{babel}\-/paketin kehitys ei kuitenkaan pysähtynyt, ja nykyään
myös se toimii Unicode\-/merkistön kanssa ainakin latinalaiseen
kirjaimistoon perustuvien kielten osalta.

Suomen kielen kannalta on aika lailla sama, kumpaa kielipakettia
käyttää. Meidän näkökulmastamme ''erikoisemmat'' kielet ja
kirjoitusjärjestelmät voivat vaatia \paketti{polyglossia}\-/paketin sekä
Lualatex\-/{} tai Xelatex\-/kääntäjän käyttöä. \paketti{babel} sisältää
enemmän ominaisuuksia, esimerkiksi omien komentojen ja muiden viritysten
tekemiseen; \paketti{polyglossia} on yksinkertaisempi paketti, jonka
kehitys tuntuisi keskittyvän vain ydintehtävään.

Seuraavissa alaluvuissa käsitellään kummankin kielipaketin tärkeimmät
toiminnot eli kielen valintaan liittyvät asiat. Yleinen ajatus on se,
että Latex\-/dokumentin esittelyosassa ladataan kielipaketti ja
määritellään dokumentin pääasiallinen kieli ja mahdolliset muut kielet.
Jos dokumentin tekstiosa sisältää muita kuin pääasiallista kieltä,
täytyy käyttää erityisiä komentoja tai ympäristöjä, joilla kerrotaan
Latexille, mistä kielestä on kyse.

\subsection{Polyglossia}

Kielipaketti \paketti{polyglossia} on tyypillinen valinta, jos halutaan
varmistaa, että Unicode\-/merkistöä (\textsc{utf\=/8}\-/merkistökoodaus)
voi käyttää vapaasti. Samalla se tarkoittaa, että kääntäjän on oltava
Lualatex tai Xelatex. Kielipaketin käyttöönotto dokumentin
esittelyosassa näyttää seuraavanlaiselta:

\begin{koodilohkosis}
  \usepackage{polyglossia}
  \setdefaultlanguage{finnish}
  \setotherlanguage{english}
  \setotherlanguage{greek}
\end{koodilohkosis}

Eri kielillä on erilaisia valinnaisia asetuksia, jotka täytyy selvittää
\paketti{polyglossia}\-/paketin ohjekirjasta. Asetukset liittyvät
esimerkiksi kielen kirjoitusjärjestelmän alueelliseen tai
historialliseen vaihteluun. Yleinen moniin kieliin sopiva valitsin on
\koodi{babel\-short\-hands}, joka lisää erilaisia, lähinnä tavutukseen
liittyviä komentoja (luku \ref{luku:tavutus}). Suomen kielen voisi siis
ottaa käyttöön myös seuraavalla tavalla:

\begin{koodilohkosis}
  \setdefaultlanguage[babelshorthands]{finnish}
\end{koodilohkosis}

Dokumentin tekstiosa käyttää kieltä, joka määriteltiin komennolla
\koodi{\keno set\-default\-lan\-guage}. Muita dokumentin esittelyosassa
määriteltyjä kieliä voi käyttää väliaikaisesti komennolla, joka alkaa
kirjaimilla \koodi{\keno text} ja jatkuu kielen nimellä, esimerkiksi
\koodi{\keno text\-english} tai \koodi{\keno text\-greek}.

\begin{koodilohkosis}
  Englannin sana \textenglish{shorthand} tarkoittaa 'pikakirjoitusta'.
\end{koodilohkosis}

Toinen vaihtoehto on käyttää kielen nimen mukaista ympäristöä:

\begin{koodilohkosis}
  \begin{greek}
    ...
  \end{greek}
\end{koodilohkosis}

Tietynkieliseksi merkitty teksti voi näyttää ladotussa dokumentissa ihan
samalta kuin muukin teksti. Tavutuksessa kuitenkin käytetään eri
kielissä eri asetuksia, ja joissakin kielissä voi olla myös pieniä
typografisia yksityiskohtia eri tavalla.

Käyttäjä voi määritellä eri kielille eri fontin. Oletuksena käytetään
peruskirjainperhettä, mikä samalla tarkoittaa, että kielen vaihtuessa
pois oletuskielestä suoritetaan \koodi{\keno rmfamily}\-/komento
(taulukko \ref{tlk:fonttimallikomennot},
s.~\pageref{tlk:fonttimallikomennot}). Tätä havainnollistaa seuraava
esimerkki, jossa \koodi{\keno text\-english}\-/komennon vaikutuksen
ajaksi tulee käyttöön perusfontti \koodi{\keno rmfamily} eikä ympärillä
oleva pääteviivaton \koodi{\keno sffamily}.

\begin{koodilohkosis}
  \sffamily
  pääteviivaton \textenglish{main font} pääteviivaton
\end{koodilohkosis}

\begin{tulossis}
  \sffamily pääteviivaton {\rmfamily main font} pääteviivaton
\end{tulossis}

Erikielisten tekstikatkelmien fonttiin voi vaikuttaa määrittelemällä
komennon, jonka nimessä on ensin kielen nimi ja lopuksi sana
\koodi{font}, esimerkiksi \koodi{\keno english\-font} tai \koodi{\keno
  greek\-font}. Komennon määritelmään kirjoitetaan yleensä
kirjainperheeseen tai \=/leikkaukseen vaikuttavia komentoja.

Seuraavassa esimerkissä \koodi{\keno english\-font}\-/komento
määritellään tyhjäksi, mikä saa aikaan sen, että englanninkieliseksi
merkitty teksti ei muuta fonttia millään tavalla vaan käytetään samaa
kirjainperhettä kuin muutenkin siinä kohdassa dokumenttia.

\begin{koodilohkosis}
  \newcommand{\englishfont}{}
\end{koodilohkosis}

Mikäli haluaa jollekin kielelle kokonaan eri kirjainperheen, kannattaa
käyttää \paketti{fontspec}\-/paketin komentoa \koodi{\keno
  new\-font\-fam\-i\-ly} (luku \ref{luku:fontin_valinta}) ja määritellä
kielen fonttikomennot sillä. Tällainen on tarpeen ainakin silloin, kun
dokumentin peruskirjainperhe ei sisällä kyseisen kielen kirjaimia.

\begin{koodilohkosis}
  \newfontfamily{\greekfont}{GFS Artemisia}[Scale=MatchLowercase]
\end{koodilohkosis}

% Seuraat eivät tunnu toimivan:

% \newfontfamily{\greekfontsf}{GFS Neohellenic} [Scale=MatchLowercase]
% \newfontfamily{\greekfonttt}{DejaVu Sans Mono}[Scale=MatchLowercase]
%
% Edellisen esimerkin \koodi{fontsf}\-/loppuinen komento tarkoittaa
% pääteviivatonta kirjainperhettä ja \koodi{fonttt}\-/loppuinen
% tasalevyistä perhettä.

% \textenglish{englantia \textsf{englantia} englantia}

\subsection{Babel}

Vanha kunnon \paketti{babel} toimii useiden eri Latex\-/kääntäjien
kanssa. Dokumentit kirjoitettiin ennen 8\=/bittisillä merkistöillä
(kuten \textsc{iso-8859\=/1}), jotka sisältävät vain reilut kaksisataa
merkkiä%
\footnote{Teknisesti 8\=/bittiset merkistöt sisältävät
  2\textsuperscript8 eli 256 merkkipaikkaa, mutta osa merkeistä on
  teknisiä ohjauskoodeja, jotka eivät liity ihmiskieliin.} %
ja soveltuvat tietyn rajallisen kielijoukon kirjoittamiseen. Nykyään
\paketti{babel} toimii myös Unicode\-/merkistön ja
\textsc{utf\=/8}\-/merkistökoodauksen kanssa ainakin latinalaiseen
kirjaimistoon perustuvien kielten osalta.

Kieliasetukset otetaan käyttöön \paketti{babel}\-/paketissa seuraavan
esimerkin tavoin. Paketin valinnaiseen argumenttiin kirjoitetaan
ladattavien kielten nimet ja viimeisenä mainitaan se kieli, joka
halutaan pääasialliseksi kieleksi.

\begin{koodilohkosis}
  \usepackage[english,greek,finnish]{babel}
\end{koodilohkosis}

Pääasiallisen kielen voi valita myös \koodi{main}\-/valitsimella:

\begin{koodilohkosis}
  \usepackage[main=finnish,english,greek]{babel}
\end{koodilohkosis}

Dokumentin tekstissä yksittäiset vieraskieliset sanat tai ilmaukset
merkitään komennolla \koodi{\keno foreign\-lan\-guage}. Komennon
ensimmäinen argumentti on kielen nimi ja toinen on sillä kielellä
ladottava teksti.

\begin{koodilohkosis}
  Englannin sana \foreignlanguage{english}{shorthand} tarkoittaa
  'pikakirjoitusta'.
\end{koodilohkosis}

Komennon sijasta voi käyttää ympäristöä \koodi{other\-lan\-guage}, joka
vaihtaa kieltä ympäristön ajaksi.

\begin{koodilohkosis}
  \begin{otherlanguage}{greek}
    ...
  \end{otherlanguage}
\end{koodilohkosis}

Kielen vaihtamista voi helpottaa \koodi{\keno babel\-tags}\-/komennolla,
joka määrittelee lyhempiä komentoja ja ympäristöjä kielen vaihtamiseen.
Komentoa käytetään seuraavan esimerkin tavoin. Sen jälkeen voi käyttää
englanninkielisen tekstin merkitsemiseen komentoa \koodi{\keno
  text\-eng\{\ldots\}} tai ympäristöä \koodi{eng}.

\begin{koodilohkosis}
  \babeltags{eng = english}
\end{koodilohkosis}

Oletuskieli voidaan vaihtaa kesken dokumentin komennolla \koodi{\keno
  select\-lan\-guage}. Komennon argumentiksi annetaan kielen nimi,
esimerkiksi seuraavalla tavalla:

\begin{koodilohkosis}
  \selectlanguage{english}
\end{koodilohkosis}

Eri kielille on mahdollista asettaa eri kirjainperheet \koodi{\keno
  babel\-font}\-/komennolla. Tämä komento korvaa
\paketti{fontspec}\-/paketin fontinvalintakomennot (luku
\ref{luku:fontin_valinta}) ja muodostaa uuden korkeamman tason komennon,
joka sisältää myös kielen. Jos siis käyttää komentoa \koodi{\keno
  babel\-font}, ei saa samanaikaisesti käyttää komentoja \koodi{\keno
  set\-main\-font}, \koodi{\keno set\-sans\-font} eikä \koodi{\keno
  set\-mono\-font}.

Oman dokumentin kirjainperheet voitaisiin määrittää \koodi{\keno
  babel\-font}\-/komennolla esimerkin \ref{esim:babelfont} tavoin. Ensin
esimerkissä määritellään peruskirjainperhe (\koodi{rm}), pääteviivaton
perhe (\koodi{sf}) ja tasalevyinen perhe (\koodi{tt}). Sen jälkeen
määritellään kreikan kielessä (\koodi{greek}) käytettävä
peruskirjainperhe ja pääteviivaton perhe.

\begin{esimerkki*}
\begin{koodilohko}
  \babelfont{rm}{TeX Gyre Termes}
  \babelfont{sf}[Scale=MatchLowercase]{TeX Gyre Heros}
  \babelfont{tt}[Scale=MatchLowercase]{TeX Gyre Cursor}

  \babelfont[greek]{rm}[Scale=MatchLowercase]{GFS Artemisia}
  \babelfont[greek]{sf}[Scale=MatchLowercase]{GFS Neohellenic}
\end{koodilohko}
\caption{\koodi{\keno babel\-font}\-/komennon käyttö dokumentin
  kirjainperheiden valintaan ja kielikohtaisten kirjainperheiden
  valintaan}
\label{esim:babelfont}
\end{esimerkki*}

Esimerkissä ennen fontin nimeä (esim. TeX Gyre Heros) oleva valinnainen
argumentti on sama kuin \paketti{fontspec}\-/paketin
fontinvalintakomennoissa. Sen avulla määritellään kyseisen
kirjainperheen asetuksia. Lisätietoa voi lukea fontteja käsittelevästä
luvusta \ref{luku:kirjaintyypit} ja \paketti{fontspec}\-/paketin
ohjekirjasta.\avctan{fontspec}

\section{Tavutus}
\label{luku:tavutus}

Tex tavuttaa eli katkaisee sanoja automaattisesti rivien lopussa, jotta
se saa tekstikappaleet näyttämään tasapainoisilta. Lähtökohtaisesti
tavutus määräytyy kielikohtaisten tavutussääntöjen ja \=/asetusten
perusteella, mutta kirjoittaja voi tehdä poikkeuksia kirjoittamalla
tavutusvihjeitä. Käytännössä tavutusvihjeitä tarvitaan välillä.

Kielen valintaa ja yleisiä kieliasetuksia käsitellään tarkemmin luvussa
\ref{luku:kieliasetukset}, mutta mainitaan tässäkin, että suomen kieli
ja sen mukainen tavutus saadaan päälle, kun dokumentin esittelyosaan
kirjoittaa seuraavat komennot:

\begin{koodilohkosis}
  \usepackage{polyglossia}
  \setdefaultlanguage{finnish}
\end{koodilohkosis}

Tavutusta käsitellään tässä yhteydessä lähinnä
\paketti{polyglossia}\-/kielipaketin näkökulmasta. Toinen kielipaketti
\paketti{babel} toimii joissakin tavutukseen liittyvissä asioissa eri
tavalla, ja pakettien eroja mainitaan tekstin lomassa.

\subsection{Yleiset tavutussäännöt}

Texin automaattinen tavutus ei perustu varsinaiseen sanojen eikä
taivutusmuotojen tunnistamiseen vaan yksinkertaisiin kirjainpohjaisiin
sääntöihin. Säännöt pyrkivät kuvaamaan kielen tavujen rakenteen ja
huomioimaan myös typografiaan liittyviä suosituksia.

Automaattinen tavutus auttaa paljon, mutta se ei yksinään riitä, koska
se tekee välillä virheitä tai tuottaa muuten suositusten vastaista
jälkeä. Kirjoittajan täytyy kirjoittaa välillä eli tavutusvihjeitä. Yksi
tapa tavutusvihjeiden kirjoittamiseen on \koodi{\keno
  hyphenation}\-/komento, jolla määritellään yksittäisten sanojen
tavutuskohdat kaikkialla dokumentissa. Seuraava esimerkki selventää
komennon käyttöä:

\begin{koodilohkosis}
  \hyphenation{
    ala-indek-si alku-osa
    nimen-omaan
    typo-gra-fi-nen
  }
\end{koodilohkosis}

Komennon perään aaltosulkeiden sisään kirjoitetaan sanoja, jotka
erotetaan toisistaan sanaväleillä. Sanoihin kirjoitetaan yhdysmerkki
niihin kohtiin, joista sanan katkaiseminen on sallittua. Jos sanassa
itsessään on yhdysmerkki, sen tavutusta ei voi käsitellä tällä
komennolla. Luvussa \ref{luku:tavutuksen_merkit} kerrotaan muita tapoja.

\koodi{\keno hyphenation}\-/komennon voi sijoittaa dokumentin
esittelyosaan tai tekstiosaan, mutta sijainti vaikuttaa sen toimintaan.
Jos komennon sijoittaa dokumentin esittelyosaan ennen kuin mitään kieltä
on ladattu tai valittu, se vaikuttaa kaikkien sanojen tavutukseen
kielestä riippumatta. Jos komennon sijoittaa dokumentin tekstiosaan eli
kielen valitsemisen jälkeen, se vaikuttaa vain kyseisen kielen eli
yleensä dokumentin pääasiallisen kielen tavutukseen.

\subsection{Yksittäisten sanojen tavutus}
\label{luku:tavutuksen_merkit}

Tietyt sanassa mukana olevat merkit kytkevät muut tavutussäännöt pois
päältä ja muuttavat sanan tavutuksen yksilölliseksi. Jos sanassa on
mukana yksikin tavutusvihje (\koodi{\keno\=/}), yhdysmerkki
(\koodi{\=/}), lyhyt ajatusviiva (\mbox{\koodi{--}}) tai pitkä
ajatusviiva (\mbox{\koodi{---}}), sana katkaistaan vain näiden kohdalta
(\koodi{\keno\=/}) tai jälkeen.%
\footnote{\paketti{polyglossia}\-/kielipaketti ja Tex toimivat tekstissä
  kuvatulla tavalla. Sen sijaan \paketti{babel}\-/paketti määrittelee
  ainakin suomen kielelle tavutusvihjeen (\koodi{\keno\=/}) siten, että
  se sallii sanan tavutuksen muistakin kohdista kuin tavutusvihjeen
  kohdalta. Tavutusvihjeen molemmin puolin sanan osat tavutetaan
  yleisten sääntöjen mukaisesti, ellei tavutuksen estäviä merkkejä kuten
  yhdysmerkkejä tai ajatusviivoja ole. \paketti{babel}\-/paketissa on
  myös tavutusvihje \koodi{\textquotedbl\textbar}, joka estää tavutuksen
  muualta.}

Myös Unicoden ajatusviivamerkit \uctunnus{u+2013 en dash} ja
\uctunnus{u+2014 em dash} toimivat, mutta ne käyttäytyvät tavutuksen
kannalta eri tavalla Lualatex\-/{} ja Xelatex\-/kääntäjillä.
Yhteensopivuussyistä kannattanee välttää Unicoden ajatusviivoja
Latex\-/lähdetiedostossa.

\leijutlk{
  \begin{tabular}{lll}
    \toprule
    \ots{Lähde}
    & \ots{Tavutus}
    & \ots{Merkitys} \\
    \midrule
    \koodi{matkustaa}
    & mat\tavukohta kus\tavukohta taa
    & tavutus kaikista kohdista \\
    \koodi{matkus\keno-taa}
    & matkus\tavukohta taa
    & vain tavutusvihjeen kohdalta \\
    \koodi{matka-aika}
    & matka-\tavukohta aika
    & vain yhdysmerkin jälkeen \\
    \koodi{matka-ai\keno-ka}
    & matka-\tavukohta ai\tavukohta ka
    & vain yhdysmerkki ja tavutusvihje \\
    \koodi{Oulu--Rovaniemi}
    & Oulu--\tavukohta Rovaniemi
    & vain ajatusviivan jälkeen \\
    \koodi{Oulu--Rova\keno-niemi}
    & Oulu--\tavukohta Rova\tavukohta niemi
    & vain ajatusviiva ja tavutusvihje \\
    \koodi{matka-}
    & matka-
    & ei tavutuskohtia \\
    \koodi{-aika}
    & -\tavukohta aika
    & vain yhdysmerkin jälkeen \\
    \bottomrule
  \end{tabular}
}{
  \caption{Tavutusvihjeen, yhdysmerkin ja ajatusviivan vaikutus
    tavutukseen}
  \label{tlk:tex-tavutus}
}

Taulukossa \ref{tlk:tex-tavutus} on esimerkkejä tavutusvihjeiden,
yhdysmerkin ja ajatusviivan vaikutuksesta. Ensimmäisessä sarakkeessa on
esimerkkisana siinä muodossa kuin se kirjoitetaan lähdetiedostoon.
Toisessa sarakkeessa on ladottu sana, johon on pystyviivalla merkittynä
mahdolliset tavutuskohdat.

Taulukon viimeinen rivi paljastaa suomen kielen kannalta ongelmallisen
tilanteen. Esimerkiksi ilmauksessa \emph{matkasuunnitelma ja
  \mbox{-aika}} ei riviä saa katkaista sanassa \emph{\mbox{-aika}}
olevan yhdysmerkin jälkeen, koska rivin loppuun jäisi yksinäinen
yhdysmerkki. Latexin peruskeinoilla sana täytyy laittaa näkymättömään
laatikkoon, joka pitää merkit yhdessä: \koodi{\keno mbox\{-aika\}}.
Toinen vaihtoehto on sitovan yhdysmerkin käyttö, jota käsitellään
seuraavassa alaluvussa.

\subsection{Tavutuksen sallivia ja sitovia merkkejä}

Unicode\-/merkistön sitova yhdysmerkki \uctunnus{u+2011 non\-/breaking
  hyphen} näkyy tavallisena yhdysmerkkinä, mutta se estää sanan
katkaisemisen yhdysmerkin vierestä. \uctunnus{u+2011}\-/merkkiä voi
käyttää Xelatex\-/kääntäjän kanssa, mutta Lualatex\-/kääntäjä kadottaa
koko merkin. Yhteensopivuussyistä ei kannata käyttää Unicoden sitovaa
yhdysmerkkiä, sillä muitakin vaihtoehtoja on.

Makropaketti \paketti{extdash}\avctan{extdash} tuo uusia komentoja ja
mahdollisuuksia tavutuksen hallintaan. Komennot ovat sellaisia kuin
\koodi{\keno Hyph\-dash} ja \koodi{\keno En\-dash}, mutta niille on
saatavilla myös lyhemmät muodot, jos paketin lataa käyttämällä
\koodi{short\-cuts}\-/valitsinta.

\begin{koodilohkosis}
  \usepackage[shortcuts]{extdash}
\end{koodilohkosis}

Paketti sisältää kaksi lisä\-vaihto\-ehtoa kolmelle viivavälimerkille
eli yhdysmerkille, lyhyelle ajatusviivalle ja pitkälle ajatusviivalle.
Kun Texin viivavälimerkit (luku \ref{luku:tavutuksen_merkit}) aina
estävät tavutuksen muualta kuin välimerkin jälkeen,
\paketti{extdash}\-/paketin perus\-vaihto\-ehdot sallivat tavutuksen
muualtakin. Lisäksi kaikille kolmelle viivavälimerkille on sitova
versio, joka estää tavutuksen välimerkin jälkeen (mutta sallii muualta).

Taulukossa \ref{tlk:extdash} ovat \paketti{extdash}\-/paketin tärkeimmät
komennot ja niiden merkitykset. Taulukossa \ref{tlk:extdash-vertailu}
vertaillaan \paketti{extdash}\-/paketin komentoja Texin vastaaviin.

\leijutlk{
  \begin{tabular}{ll}
    \toprule
    \ots{Komento} & \ots{Merkitys} \\
    \midrule
    \koodi{\keno -/} & tavutuksen salliva yhdysmerkki \\
    \koodi{\keno =/} & sitova, tavutuksen salliva yhdysmerkki \\
    \koodi{\keno --} & tavutuksen salliva lyhyt ajatusviiva \\
    \koodi{\keno ==} & sitova, tavutuksen salliva lyhyt ajatusviiva \\
    \koodi{\keno ---} & tavutuksen salliva pitkä ajatusviiva \\
    \koodi{\keno ===} & sitova, tavutuksen salliva pitkä ajatusviiva \\
    \bottomrule
  \end{tabular}
}{
  \caption{\paketti{extdash}-paketin komentoja}
  \label{tlk:extdash}
}

\leijutlk{
  \begin{tabular}{llll}
    \toprule
    \ots{Lähde} & \ots{Tavutus}
    & \ots{Lähde} & \ots{Tavutus} \\
    \midrule
    \koodi{matka-aika}
                & matka-\tavukohta aika
                & \koodi{Oulu--Rovaniemi}
                & Oulu--\tavukohta Rovaniemi \\
    \koodi{matka\keno -/aika}
                & mat\tavukohta ka-\tavukohta ai\tavukohta ka
                & \koodi{Oulu\keno --Rovaniemi}
                & Ou\tavukohta lu--\tavukohta Ro\tavukohta va\tavukohta
                  nie\tavukohta mi \\
    \koodi{matka\keno =/aika}
                & mat\tavukohta ka-ai\tavukohta ka
                & \koodi{Oulu\keno ==Rovaniemi}
                & Ou\tavukohta lu--Ro\tavukohta va\tavukohta
                  nie\tavukohta mi \\
    \koodi{matka-}
                & matka-
                & \koodi{-aika}
                & -\tavukohta aika \\
    \koodi{matka\keno -/}
                & mat\tavukohta ka-
                & \koodi{\keno =/aika}
                & -ai\tavukohta ka \\
    \bottomrule
  \end{tabular}
}{
  \caption{Texin ja \paketti{extdash}-paketin komentojen vertailua}
  \label{tlk:extdash-vertailu}
}

On tärkeää huomioida, että \paketti{extdash}\-/paketin komennot ovat
todellakin normaaleja komentoja. Se tarkoittaa, että komennon jälkeiset
sanavälit syödään pois. Tämä asia saattaa unohtua seuraavanlaisessa
tilanteessa, jossa käytetään tavutuksen sallivaa yhdysmerkkikomentoa:

% \pagebreak[3]

\begin{koodilohkosis}
  matka\-/ ja aika\-/arvio
\end{koodilohkosis}

\begin{tulossis}
  matka\-/ ja aika\-/arvio
\end{tulossis}

Ensimmäisen yhdysmerkkikomennon jälkeinen sanaväli hävisi, ja syntyi
virheellinen sana \emph{matka-ja}. Sanavälin saa säilymään, kun
kirjoittaa komennon perään aaltosuljeparin tai kenoviivan ja sanavälin.

% \pagebreak[3]

\begin{koodilohkosis}
  matka\-/{} ja aika\-/arvio \\
  matka\-/\ ja aika\-/arvio
\end{koodilohkosis}

\begin{tulossis}
  matka\-/{} ja aika\-/arvio \\
  matka\-/\ ja aika\-/arvio
\end{tulossis}

\subsection{Tavutus sanan reunasta}

Asetukset \koodi{\keno left\-hy\-phen\-min=N} ja \koodi{\keno
  right\-hy\-phen\-min=N} vaikuttavat tavutukseen sanan reunoissa.
Argumentti \koodi{N} on positiivinen kokonaisluku, ja se määrittelee,
kuinka monta merkkiä vähintään sanan vasemmasta tai oikeasta reunasta
pidetään yhdessä. Oletus\-arvot ovat kielikohtaisia ja määritellään
\paketti{polyglossia}\-/{} ja \paketti{babel}\-/paketeissa. Suomen
kielessä kumpikin asetus on kaksi (2) merkkiä.

Nämä asetukset alustetaan kielikohtaisiin oletus\-arvoihin aina, kun
kieliasetukset tulevat voimaan. Näin on esimerkiksi dokumentin
aloittavan \koodi{document}\-/ympäristön alussa tai kielen vaihtuessa.
Tästä seuraa, että jos asetuksia ha\-luaa muuttaa, täytyy ne asettaa
\koodi{document}\-/ympäristön alussa tai aina kielen vaihtamisen
jälkeen.

Omat kieli\-asetukset saa mukaan automaattisesti, kun lisää muutokset
kielikohtaisiin alustuskomentoihin alla olevan esimerkin mukaisesti.
Tällä tavoin omat asetukset tulevat voimaan samalla kuin muutkin
kieliasetukset, esimerkiksi kielen vaihtuessa.

\begin{koodilohkosis}
  \addto{\captionsfinnish}{
    \lefthyphenmin=3
    \righthyphenmin=3
  }
\end{koodilohkosis}

Esimerkissä oleva komento \koodi{\keno add\-to} on
\paketti{polyglossia}\-/{} ja \paketti{babel}\-/paketin ominaisuus, ja
tässä käsitellään suomen kielen asetuksia (\koodi{\keno
  cap\-tions\-finnish}).

\subsection{Muita tavutusasetuksia ja -vinkkejä}
\label{luku:tavutus_muut}

Aiemmin mainittu \paketti{extdash}\-/makropaketti sisältää tavutuksen
hallintaan liittyviä välimerkkejä, mutta sellaisia on myös
kielipaketeissa \paketti{polyglossia} ja \paketti{babel}. Kielipakettien
englanninkielisissä ohjekirjoissa niitä kutsutaan nimellä
\emph{\englanti{short\-hands}}.

\paketti{babel}\-/paketti tuo suomen kieleen sitovan, tavutuksen
sallivan yhdysmerkin \koodi{\textquotedbl\=/}, joka toimii samoin kuin
\paketti{extdash}\-/paketin komento \koodi{\keno=/}. Lisäksi on
tavutusvihje (\koodi{\textquotedbl\textquotedbl}), joka ei tee
yhdysmerkkiä tavutuskohtaan. Sitä voi käyttää joidenkin teknisten
ilmausten tavutusvihjeenä, jotta ilmaus säilyy täsmälleen samanlaisena
myös rivien katkaisemisessa. \paketti{babel}\-/paketin toiminnot
vaihtelevat eri kielten välillä.

\paketti{polyglossia}\-/pakettiin saa samat lisätoiminnot ja eräitä
muitakin, kun paketin lataa käyttämällä valitsinta
\koodi{babel\-short\-hands}. Edellä mainittujen ''Baabelin lyhenteiden''
lisäksi tulee yhdysmerkki \koodi{\textquotedbl\textasciitilde}, joka on
sitova ja samalla kaiken tavutuksen estävä yhdysmerkki. Tälle merkille
ei ole vastinetta \paketti{extdash}\-/paketissa. Pari muutakin
lainausmerkillä alkavaa, tavutukseen liittyvää merkkiä on mukana.

Varsinainen%
\koodimargin{\keno discretionary} tavutuksen peruskomento on
\koodi{\keno discretionary}, joka mahdollistaa omanlaisten
tavutuskohtien määrittelyn. Komento kirjoitetaan sanassa juuri siihen
kohtaan, johon tavutuskohta halutaan. Komennolle annetaan kolme
argumenttia järjestyksessä seuraavasti:

\begin{nluetelma}
\item katkaisutilanteessa rivin loppuun ladottavat merkit
\item katkaisutilanteessa seuraavan rivin alkuun ladottavat merkit
\item katkaisemattomaan sanaan ladottavat merkit.
\end{nluetelma}

Normaali tavutuskohta sanaan \emph{tavu} määriteltäisiin alla olevan
esimerkin tavoin:

\begin{koodilohkosis}
  ta\discretionary{-}{}{}vu
\end{koodilohkosis}

Edellisessä esimerkissä komennon ensimmäinen argumentti on yhdysmerkki,
koska rivin loppuun tietenkin halutaan yhdysmerkki silloin, kun sana
katkaistaan tästä kohdasta. Toinen argumentti on tyhjä, koska seuraavan
rivin alkuun ei kirjoiteta suomen kielessä mitään ylimääräistä. Myös
kolmas argumentti on tyhjä, koska katkaisemattomaan sanaan ei haluta
mitään merkkiä tavujen väliin.

\koodi{\keno discretionary}\-/komennolla voi luoda myös tavutuskohtia,
joihin ei ilmesty yhdysmerkkiä eikä mitään muutakaan merkkiä
katkaisutilanteessa. Se saadaan aikaan jättämällä kaikki argumentit
tyhjäksi. Tällainen sopii tavutusvihjeeksi teknisiin ilmauksiin, joihin
ei selvyyden vuoksi haluta mitään ylimääräisiä merkkejä edes sanan
katkaisutilanteessa.

\begin{koodilohkosis}
  \discretionary{}{}{}
\end{koodilohkosis}

Joissakin kielissä sanan katkaiseminen yhdysmerkin kohdalta vaatii, että
rivin loppuun kirjoitetaan yksi yhdysmerkki ja seuraavan rivin alkuun
toinen. Näin ilmaistaan, että sanassa on pysyvä yhdysmerkki eikä vain
väliaikaisesti katkaisun merkkinä. Tällaisia kieliä varten saattaa
kielipaketissa (tai muualla) olla omat yhdysmerkkitoiminnot, mutta
edellä kuvatun tavutuskohdan saa myös seuraavalla tavalla:

\begin{koodilohkosis}
  \discretionary{-}{-}{-}
\end{koodilohkosis}

Tavutuksen suunnittelussa ja tutkimisessa voi auttaa
\paketti{show\-hy\-phens}\-/paketti,\avctan{showhyphens} jonka
lataamalla kaikki tavutuskohdat tulevat näkyviin. Dokumentin kaikkien
sanojen tavutuskohtiin piirretään ohut punainen pystyviiva. Tämä paketti
hyödyntää Lualatex\-/kääntäjän ominaisuuksia, eikä se siis toimi muiden
kääntäjien kanssa.

\subsection{Suomen kielen tavutus}

Texin kirjainyhdistelmiin perustuvat säännöt eivät yksinään riitä suomen
kieleen, ja esimerkiksi yhdyssanojen rajakohdat tuottavat usein
ongelmia. Sana \emph{alku\-osa} katkaistaan sääntöjen mukaan kohdista
\emph{al-kuo-sa}. Se on kyllä oikein tavurakenteen kannalta mutta
käytännössä ongelmallinen. Tässä ei ole kyse \emph{uo}\-/diftongista,
vaan yhdyssanan rajalla on myös tavutuskohta (\emph{al-ku-o-sa}).
Lisäksi sanaa ei saa katkaista siten, että siitä jää yksittäinen kirjain
eri riville (\emph{o-sa}).

Parasta olisi katkaista suomen kielen yhdyssanat vain yhdys\-osien
välistä (\emph{alku-osa}). Muualtakin voi katkaista (\emph{al-ku-osa}),
kunhan sanasta eikä sen yhdys\-osasta ei jää yksittäinen kirjain eri
riville. Mielellään ei katkaista myöskään kahden vokaalin välistä, jos
ne kuuluvat samaan sanaan (\emph{kau-emmin}). Joskus halutaan välttää
myös niin sanottuja orpotavuja eli sitä, että tekstikappaleen
viimeiselle riville jää vain yksi tavu.

Käytännössä siis suomenkielinen teksti ja hyvä typografia vaativat
välillä tavutusvihjeiden kirjoittamista. Yhdyssanojen osien väliin
tarvitaan tavutusvihje silloin, kun jälkimmäinen osa alkaa vokaalilla
tai useammalla kuin yhdellä konsonantilla. Joitakin tällaisia tapauksia
Tex osaa tavuttaa oikein ilman tavutusvihjeitäkin, mutta etukäteen sitä
ei tiedä, ellei ole kokemusta.

\begin{koodilohkosis}
  alku\-osa pusku\-traktori
\end{koodilohkosis}

Yhdysmerkin tai ajatusviivan sisältävät pitkät yhdyssanat voivat vaatia
tavutuskohtien lisäämistä, koska Texin yhdysmerkki ja ajatusviivat
estävät tavutuksen muualta kuin näiden merkkien jälkeen. Ilman
tavutuskohtien lisäämistä Texillä ei ehkä ole riittävästi vaihtoehtoja
tekstikappaleen rivittämiseen. Voi syntyä liian suuria sanavälejä, tai
joistakin riveistä tulee ylipitkiä, eli ne yltävät marginaalin puolelle.

Tavutuskohtia voi lisätä sopiviin kohtiin omilla tavutusvihjeillä
(\koodi{\keno\=/}). Vaihtoehtoisesti kaikki yleisten tavutussääntöjen
mukaiset tavutuskohdat saa käyttöön \paketti{extdash}\-/paketin
komennoilla (taulukko \ref{tlk:extdash}). Seuraavassa esimerkissä on
tavutuksen hallintaa sanalle \emph{Molo\-tov--Ribben\-trop-sopi\-mus}:

\begin{koodilohkosis}
  Molo\-tov--Ribben\-trop-sopi\-mus % tavutusvihjeet
  Molotov\--Ribben\-trop\-/sopimus  % tavutuksen sallivat välimerkit
\end{koodilohkosis}

\koodi{\keno discretionary}\-/komentoa (luku \ref{luku:tavutus_muut})
voi hyödyntää suomen kielen sanoissa silloin, kun niissä on heittomerkki
erottamassa kahta tavurajan molemmin puolin olevaa samaa vokaalia,
esimerkiksi sanoissa \emph{vaa'an} ja \emph{liu'uttaa}. Normaalisti Tex
ei katkaise heittomerkin kohdalta lainkaan, eikä se olisi suomen
kielessä suositeltavaakaan, koska vokaalien välistä ei mielellään
katkaista sanaa. Jos tavutuksen kuitenkin haluaa myös heittomerkin
kohdalle, täytyy huolehtia, että tavutustilanteessa heittomerkki poistuu
ja sen paikalle tulee yhdysmerkki rivin loppuun. Sanan \emph{vaa'an}
voisi siis kirjoittaa seuraavalla tavalla:

\begin{koodilohkosis}
  vaa\discretionary{-}{}{'}an
\end{koodilohkosis}

Komennon kolmas argumentti on heittomerkki, koska se pitää latoa
tavurajalle silloin, kun sanaa ei katkaista tästä kohdasta. Mikäli
tällaisia tarvitsee paljon, on järkevää määritellä sitä varten
yksinkertaisempi komento, jota sitten käytetään sanoissa heittomerkin
sijasta.

\begin{koodilohkosis}
  \newcommand{\hm}{\discretionary{-}{}{'}}
  vaa\hm an
\end{koodilohkosis}

Suomen kielessä käytetään heittomerkkiä myös taivutuspäätteen, liitteen
tai johtimen edellä silloin, kun sanavartalon kir\-joi\-tus\-asu päättyy
konsonanttiin mutta ääntö\-asu vokaaliin, esimerkiksi \emph{show'ssa}.
Näissä tilanteissa ei ole kyse tavurajasta vaan morfeemirajasta eli
merkityksellisten osien rajakohdasta. Tavurajakin voi sattua samaan
paikkaan, mutta tavutettaessa heittomerkki säilyy: \emph{show'-hun}.%
\footnote{Asiaa ei yleensä mainita kielenhuolto\-/oppaissa. Tieto
  perustuu Kielikello\-/lehden 2/2006 artikkeliin:
  \kulmaurl{https://www.kielikello.fi/-/lainausmerkit-}. Viittauspäivä
  6.7.2020.} Mikäli tällainen tavutuskohta halutaan mukaan, käytetään
sanassa tavallista tavutusvihjettä: \koodi{show'\keno\=/hun}. Mieluummin
ei kuitenkaan katkaista sanoja heittomerkin kohdalta.

\subsection{Tavutus pois päältä}

Tavutuksen voi kytkeä kokonaan pois päältä
\paketti{polyglossia}\-/kielipaketin komennolla%
\koodimargin{\keno disable\-hyphenation} \koodi{\keno
  dis\-able\-hy\-phen\-ation}. Tavutuksen saa takaisin päälle komennolla
\koodi{\keno en\-able\-hy\-phen\-ation}.

Toinen vaihtoehto on käyttää fontin asetusta \koodi{Hyphen\-Char=\katk
  None} samalla, kun ottaa käyttöön tietyn kirjainperheen. Oletuksena
tavutus on pois päältä tasalevyisestä fontista, eli esimerkiksi
\koodi{\keno text\-tt\{…\}}\-/komennon argumenttina olevaa tekstiä ei
tavuteta. Fontteja ja niiden asetuksia käsitellään luvussa
\ref{luku:kirjaintyypit}.

Käytännössä tavutus menee pois päältä myös silloin, kun tekstikappaleet
tasaa vain vasempaan reunaan eli tekee oikealle liehureunan komennolla
\koodi{\keno ragged\-right}. Tekstikappaleiden tasaamista ja palstan
muotoa käsitellään luvussa \ref{luku:kappaleen_tasaus}.
