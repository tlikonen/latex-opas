% Tekijä:   Teemu Likonen <tlikonen@iki.fi>
% Lisenssi: Creative Commons Nimeä-JaaSamoin 4.0 Kansainvälinen
%           (CC BY-SA 4.0)

\chapter{Merkintäkieli}

Latex on merkintäkieli, mikä tarkoittaa, että se sisältää omat tapansa
dokumentin rakenteen ja sisällön kuvaamiseen. Kaikkea ei kirjoiteta
lähdedokumenttiin sellaisenaan, vaan täytyy käyttää tiettyjä kielen
sääntöjen mukaisia merkintätapoja tai komentoja. Tässä luvussa
käsitellään merkintäkielen perus\-asioita.

\section{Merkistö}

Latex\-/dokumenttiin voi kirjoittaa tekstiä Unicode\-/merkistöllä ja sen
\textsc{utf}\=/8\/-koodauksella, jos kääntäjänä on Unicoden osaava
ohjelma kuten Lualatex tai Xelatex. Pääasiassa siis merkit kirjoitetaan
sellaisenaan lähdedokumenttiin, mutta on kuitenkin kaikenlaisia
poikkeuksia, ja niitä käsitellään tässä alaluvussa.

\subsection{Varatut erikoismerkit}

Muutamalla merkillä on perus Latexissa erikoismerkitys, eikä niitä voi
käyttää normaalilla tavalla. Merkit ovat seuraavat:

\begin{koodilohkosis}
  % $ ^ _ # & { } ~ \
\end{koodilohkosis}

Useimmat näistä merkeistä voi suojata erikoismerkitykseltään
kirjoittamalla niiden eteen kenoviivan (\koodi{\keno}). Tildeä
(\textasciitilde), sirkumfleksia (\textasciicircum) eikä kenoviivaa
itseään ei voi suojata pelkän kenoviivan avulla, koska kenoviivan kanssa
ne muodostavat eräitä muita komentoja. Taulukossa
\ref{tlk:merkkien_suojaus} on koottuna, kuinka edellä mainitut
erikoismerkit suojataan eli saadaan ladottua dokumenttiin sellaisenaan.

\leijutlk{
  \begin{tabular}{cll}
    \toprule
    \ots{Merkki} & \multicolumn{2}{l}{\ots{Kirjoittaminen}} \\
    \midrule
    \koodi{\%} & \koodi{\keno\%} \\
    \koodi{\$} & \koodi{\keno\$} & \koodi{\keno textdollar} \\
    \koodi{\^{}} & \koodi{\keno\^{}\{\}} & \koodi{\keno textasciicircum} \\
    \koodi{\_} & \koodi{\keno\_} & \koodi{\keno textunderscore} \\
    \koodi{\#} & \koodi{\keno\#} \\
    \koodi{\&} & \koodi{\keno\&} \\
    \koodi{\{} & \koodi{\keno\{} & \koodi{\keno textbraceleft} \\
    \koodi{\}} & \koodi{\keno\}} & \koodi{\keno textbraceright} \\
    \koodi{\~{}} & \koodi{\keno\~{}\{\}} & \koodi{\keno textasciitilde} \\
    \koodi{\keno} && \koodi{\keno textbackslash} \\
    \bottomrule
  \end{tabular}
}{
  \caption{Varattujen erikoismerkkien kirjoittaminen}
  \label{tlk:merkkien_suojaus}
}

Jotkin makropaketit määrittelevät muitakin erikoismerkkejä. Esimerkiksi
kieli\-asetuksiin (luku \ref{luku:kieliasetukset}) liittyvät
\paketti{polyglossia}\-/{} ja \paketti{babel}\-/paketit voivat
määritellä pari lainausmerkillä (\koodi{\textquotedbl}) alkavaa,
tavutuksen hallintaan liittyvää komentoa.

\subsection{Sanaväli}
\label{luku:sanavali}

Välilyönti, sarkainmerkki ja yksi rivinvaihto ovat kaikki tavallisia
sanavälejä Latex\-/dokumentissa, ja näillä kolmella on sama merkitys.
Esimerkiksi rivin lopussa oleva rivinvaihto tarkoittaa samaa kuin
sanojen välissä oleva välilyönti. Välilyöntejä ja sarkainmerkkejä voi
kirjoittaa useita peräkkäin, mutta ne ovat sama asia kuin yksi väli.

\pagebreak[3]

\begin{koodilohkosis}
  Nämä      kaikki
       ovat            vain
  sanoja  peräkkäin  ja               kuuluvat
      samaan kappaleeseen.
\end{koodilohkosis}

\begin{tulossis}
  Nämä kaikki ovat vain sanoja peräkkäin ja kuuluvat samaan
  kappaleeseen.
\end{tulossis}

Sanavälien leveys ei ole vakio. Silloin kun tekstipalsta tasataan
molemmista reunoista -- kuten tämänkin oppaan leipätekstissä \==,
rivillä olevia sanavälejä venytetään sopivasti, jotta tekstipalstan
molemmat reunat saadaan tasaiseksi. Tietynlevyisiä vaakasuuntaisia
välejä saa tehtyä komennolla \koodi{\keno hspace} (luku
\ref{luku:mitat}).

\subsection{Kappaleen vaihtuminen}

Tyhjä rivi tarkoittaa kappaleen vaihtumista. Rivi on tyhjä silloin, kun
se ei sisällä mitään muuta kuin rivinvaihdon tai kun se sisältää vain
välilyöntejä tai sarkainmerkkejä ja lopuksi rivinvaihdon. Tyhjiä rivejä
voi olla useita peräkkäin, mutta ne tarkoittavat samaa kuin yksi tyhjä
rivi. Uuden tekstikappaleen voi aloittaa myös komennolla \koodi{\keno
  par}.

\begin{koodilohkosis}
  Nämä rivit kuuluvat
  samaan kappaleeseen.

  Tässä on toinen tekstikappale.
  Nyt ei oteta kantaa siihen, miten
  rivit ja kappaleet muotoillaan.
\end{koodilohkosis}

Ladotuissa teksteissä uuden tekstikappaleen alkaminen ilmaistaan usein
sisennetyllä rivillä, mutta sisennyksiä eikä muitakaan muotoiluja ei
tehdä tekstieditorissa välien avulla. Kappaleiden muotoiluun on omat
keinonsa, ja niistä käsitellään luvussa \ref{luku:kappale}.

\subsection{Kommentit}

Latex\-/dokumentissa prosentin merkki (\koodi{\%}) on kommenttimerkki,
jonka jälkeisen rivin\-osan kääntäjä jättää huomioimatta. Merkki on
tarkoitettu kirjoittajan omien kommenttien ja muistiinpanojen
kirjoittamiseen.

\begin{koodilohkosis}
  % Nyt ei tosin ole
  % mitään kommentoitavaa.
\end{koodilohkosis}

Kommenttimerkki vaikuttaa kääntäjään myös siten, että se syö kaikki
välilyönnit ja sarkainmerkit, jotka tulevat kyseisen kommentin jälkeen.
Tämän vuoksi kommenttimerkin avulla voi yhdistää eri riveillä olevan
tekstin. Seuraava esimerkki tuottaa ladottuna ehjän sanan \emph{Latex}.

\begin{koodilohkosis}
  La% Nämä rivit
    t% yhdistyvät.
      ex
\end{koodilohkosis}

\begin{tulossis}
  La% Nämä rivit
    t% yhdistyvät.
      ex
\end{tulossis}

\subsection{Aaltosulkeet}
\label{luku:aaltosulkeet}

Aaltosulkeet \mbox{\koodi{\{\}}} muodostavat eräänlaisen näkymättömän
ympäristön, jonka sisällä voi olla väliaikaisesti voimassa erilaiset
asetukset kuin ulkopuolella. Aaltosulkeiden sisällä suoritetut komennot,
uusien komentojen määrittelyt (luku \ref{luku:komennot}) tai asetetut
mittojen arvot (luku \ref{luku:mitat}) ovat voimassa vain kyseisen
ympäristön sisäpuolella. Seuraavassa esimerkissä aaltosulkeilla rajataan
kursivointikomennon \koodi{\keno it\-shape} vai\-ku\-tus\-aluetta.

\pagebreak[3]

\begin{koodilohkosis}
  tavallinen {\itshape kursiivi} tavallinen
\end{koodilohkosis}

\begin{tulossis}
  tavallinen {\itshape kursiivi} tavallinen
\end{tulossis}

\subsection{Sitova välilyönti}

Sitova välilyönti on samanlainen tyhjä merkki kuin tavallinenkin
välilyönti, mutta rivinvaihtoa ei sallita sen kohdalta. Sitovalla
välilyönnillä kannattaa estää esimerkiksi pienistä osista koostuvan
ilmauksen hajoaminen eri riveille (esimerkki: \emph{osa~5}). Latexissa
sitova välilyönti saadaan joko tildemerkillä (\koodi{\textasciitilde})
tai nimenomaan siihen tarkoitetulla merkillä, jonka Unicode\-/tunnus on
\uctunnus{u+00a0 no-break space}.

Nämä kaksi eri merkkiä, tilde ja \uctunnus{u+00a0}, toimivat hieman eri
tavoin. Molemmat estävät rivinvaihdon, mutta tildemerkki sallii välin
venymisen samalla tavalla kuin tavallinenkin sanaväli sallii (luku
\ref{luku:sanavali}). Sen sijaan merkki \uctunnus{u+00a0} on
vakiolevyinen eikä siis veny muiden sanavälien tapaan. Unicoden sitovaa
välilyöntiä \uctunnus{u+00a0} täytyy käyttää ainakin vuorosanaviivan
(\==) ja sitä seuraavan sanan välissä, koska se väli ei saa venyä.

\subsection{Ohuke}
\label{luku:ohuke}

Ohuke on tavallista sanaväliä kapeampi väli, ja se tehdään
komennolla~\koodi{\keno,} (kenoviiva ja pilkku). Ohukkeen leveys
Latexissa on \murtoluku{1/6} typografisen neliön leveydestä eli
em-mitasta (luku \ref{luku:mitat}). Ohuke on tasalevyinen ja sitova, eli
se ei veny muiden sanavälien tapaan, ja se estää rivinvaihdon. Siksi
ohuke sopii esimerkiksi pitkien lukujen ja puhelinnumeroiden
ryhmittelyyn paremmin kun sanaväli.

\begin{koodilohkosis}
  12\,750\,000
  J.\,R.\,R. Tolkien
\end{koodilohkosis}

Myös henkilön etunimen alkukirjainten välissä voi käyttää ohuketta, jos
tavallinen sanaväli vie kirjaimet turhan kauas toisistaan. Sukunimi
erotetaan kuitenkin aina sanavälillä. Joskus myös päiväyksissä käytetään
ohuketta järjestysluvun pisteiden jälkeen. Taulukossa \ref{tlk:ohuke}
vertaillaan sanaväliä, ohuketta ja yhteen kirjoittamista.

\leijutlk{
  \begin{tabular}{lrll}
    \toprule
    & \ots{Luku} & \ots{Päiväys} & \ots{Nimi} \\
    \midrule
    \otsrivi{Sanaväli} & 12 750 000 & \st{9. 5. 2020} & J. R. R. Tolkien \\
    \otsrivi{Ohuke} & 12\,750\,000 & 9.\,5.\,2020 & J.\,R.\,R. Tolkien \\
    \otsrivi{Yhteen} & 12750000 & 9.5.2020 & \st{J.R.R. Tolkien} \\
    \bottomrule
  \end{tabular}
}{
  \caption{Sanavälin, ohukkeen ja yhteen kirjoittamisen vertailu. Suomen
    kielen vastaiset kirjoitus\-asut on viivattu yli}
  \label{tlk:ohuke}
}

\subsection{Lainausmerkit ja heittomerkki}
\label{luku:lainausmerkit}

Näppäilemällä \textsc{shift} eli vaihtonäppäin ja 2 saadaan yleensä
lainausmerkin yleisversio, niin sanottu \textsc{ascii}\-/lainausmerkki
(\textquotedbl), mutta se ei taida olla minkään kielen varsinainen
lainausmerkki. On siis syytä käyttää oikeita lainausmerkkejä, ja se käy
Latexissa varsin helposti.

Eri kielissä lainausmerkkikäytännöt ovat erilaiset. Suomen kielessä
käytetään ''tällaisia'' lainausmerkkejä ja joskus >>tällaisia>>
kulmalainausmerkkejä. Jos lainauksen sisään tarvitaan lainaus, täytyy
sisempi lainaus kirjoittaa 'tällaisten' puolilainausmerkkien avulla.
Yksittäin käytettynä se on nimeltään heittomerkki. Englannin kielessä
lainauksen alussa ja lopussa on erilainen merkki, ja ``tässä'' siitä
esimerkki. Samoin on puolilainausmerkin kohdalla: `näin'.

Latexissa voi käyttää Unicode\-/merkistöä ja lähdedokumenttiin voi
kirjoittaa suoraan ne lainausmerkit, jotka halutaan ladottavaksi, mutta
edellä mainituille merkeille on myös omat komentonsa. Näppäimistöltä
kirjoitettava yleisheittomerkki (\koodi{'}) tuottaa ladottuna
automaattisesti oikean kaarevan heittomerkin ('). Kun kirjoittaa kaksi
heittomerkkiä peräkkäin (\koodi{''}), on lopputuloksena yksi kaareva
lainausmerkki (''). Kahdella suurempi kuin \=/merkillä (\koodi{>>})
saadaan kulmalainausmerkki~(>>).

\pagebreak[3]

\begin{koodilohkosis}
  ''Lainaus, jonka 'sisällä' on lainaus.'' \\
  >>Lainaus, jonka 'sisällä' on lainaus.>>
\end{koodilohkosis}

\begin{tulossis}
  ''Lainaus, jonka 'sisällä' on lainaus.'' \\
  >>Lainaus, jonka 'sisällä' on lainaus.>>
\end{tulossis}

Yllä mainitut riittävät suomen kieleen, mutta englantia ja muita kieliä
varten tarvitaan myös toisinpäin oleva merkki (``), joka tehdään
kahdella gra\-vis\-ak\-sen\-til\-la (\koodi{``}). Vastaava
puolilainausmerkki (`) tehdään yhdellä aksentilla (\koodi{`}). Joissakin
kielissä käytetään erilaisia kulmalainausmerkkejä lainauksen alussa ja
lopussa. Vasemmalle osoittava merkki (<<) tehdään kahdella pienempi kuin
\=/merkillä (\koodi{<<}).

Lainausmerkkien merkintätapoja ja komentoja on koottu taulukkoon
\ref{tlk:erikoismerkit-lainaus}
(s.~\pageref{tlk:erikoismerkit-lainaus}). Toisaalta kielikohtaiset
asetukset (luku \ref{luku:kieliasetukset}) voivat tuoda mukanaan myös
kielikohtaisia keinoja lainausmerkkien kirjoittamiseen. Lisäksi
makropaketti \paketti{cs\-quotes}\avctan{csquotes} sisältää
lainausmerkkeihin liittyviä komentoja ja kielikohtaista logiikkaa.

Joskus todella halutaan latoa yleislainausmerkki (\textquotedbl) tai
yleisheittomerkki (\textquotesingle). Ne saadaan komennoilla
\koodi{\keno text\-quote\-dbl} ja \koodi{\keno text\-quote\-single}.
Yksittäinen gra\-vis\-ak\-sent\-ti (\`{}) tehdään komennolla
\koodi{\keno `\{\}}.

Latexin omat lainausmerkkien ja ajatusviivojen merkintätavat saa
poistettua kokonaan käytöstä fontin asetuksella
\koodi{Liga\-tures=\-TeX\-Reset}. Asetus kytketään päälle esimerkiksi
komennolla \koodi{\keno add\-font\-fea\-tures}, joka sisältyy
\paketti{fontspec}\-/pakettiin. Mainittu asetus on oletuksena päällä
tasalevyisessä fontissa, jonka saa yksittäisiin sanoihin komennolla
\koodi{\keno text\-tt}. Fontteja käsitellään tarkemmin luvussa
\ref{luku:kirjaintyypit}.

\pagebreak[3]

\begin{koodilohkosis}
  {\addfontfeatures{Ligatures=TeXReset} `` '' >> '} \\
  \texttt{`` '' >> '}
\end{koodilohkosis}

\begin{tulossis}
  {\addfontfeatures{Ligatures=TeXReset} `` '' >> '} \\
  \texttt{`` '' >> '}
\end{tulossis}

\subsection{Yhdysmerkki, ajatusviiva ja miinusmerkki}

Yhdyssanan osien välissä käytettävä yhdysmerkki on Latexissa tavallinen
näppäimistöltä saatava yleis\-yh\-dys\-merk\-ki (\=/). Merkillä on
vaikutusta myös sanan tavutukseen (luku \ref{luku:tavutus}).

Ajatusviivaa tarvitaan esimerkiksi äärikohtien (27--29,
Oulu--Rova\-niemi), luetelmien, vuorosanojen ja virkkeen irrallisen
lisäysten merkitseminen. Suomen kielessä käytetään yleensä vain lyhyttä
ajatusviivaa \mbox{(--)}, joka tehdään Latexissa kahdella peräkkäisellä
yhdysmerkillä \mbox{(\koodi{--})}. Pitkä ajatusviiva \mbox{(---)}
tehdään kolmella yhdysmerkillä \mbox{(\koodi{---})}. Ajatusviivat
vaikuttavat sanan tavutukseen samoin kuin yhdysmerkki.

\pagebreak[3]

\begin{koodilohkosis}
  Oulu--Rovaniemi-yhteys
\end{koodilohkosis}

\begin{tulossis}
  Oulu--Rovaniemi-yhteys
\end{tulossis}

Myös Unicoden ajatusviivamerkit \uctunnus{u+2013 en dash} ja
\uctunnus{u+2014 em dash} toimivat, mutta tavutuksen kannalta ne
käyttäytyvät eri tavoin Lua\-latex- ja Xelatex\-/kääntäjillä.
Yhteensopivuussyistä on parasta tehdä ajatusviivat Latexin omilla
merkintätavoilla eikä Unicode\-/merkeillä.

Silloin kun todella täytyy latoa kaksi tai kolme peräkkäistä
yhdysmerkkiä, voi käyttää tasalevyistä fonttia (\koodi{\keno
  text\-tt\{\ldots\}}), joka oletuksena kytkee pois Latexin
ajatusviivatoiminnon. Saman asetuksen saa kyllä mihin tahansa fonttiin,
ja väliaikaisesti asetus kytketään seuraavasti.

\pagebreak[3]

\begin{koodilohkosis}
  {\addfontfeatures{Ligatures=TeXReset} -- ---}
\end{koodilohkosis}

\begin{tulossis}
  {\addfontfeatures{Ligatures=TeXReset} -- ---}
\end{tulossis}

Miinusmerkille ei Latexissa ole erityistä merkintätapaa muuten kuin
matematiikkatilassa (luku \ref{luku:matematiikka}). Lyhyttä ajatusviivaa
saa käyttää myös miinusmerkkinä, mutta vielä parempi olisi käyttää
varsinaista Unicoden miinusmerkkiä \uctunnus{u+2212 minus sign}, koska
se on fonteissa suunniteltu typografisesti yhteensopivaksi muiden
matemaattisten merkkien kanssa.

\subsection{Kolme pistettä eli ellipsi}

Ajatuksen katkeamista ja muuta sellaista ilmaisevalle kolmelle pisteelle
eli ellipsille (\ldots) on oma merkkinsä, ja fontissa se saattaa näyttää
hieman erilaiselta kuin kolme peräkkäistä pistemerkkiä. Tyypillisesti
ellipsimerkissä pisteet ovat hieman harvemmassa ja erottuvat toisistaan
paremmin kuin kolmena erillisenä merkkinä ladotut pisteet. Ellipsi
tehdään Latexissa komennoilla \koodi{\keno dots}, \koodi{\keno ldots},
\koodi{\keno text\-el\-lip\-sis} tai Unicode\-/merkillä \uctunnus{u+2026
  horizontal ellipsis}.

\subsection{Ylä- ja alaindeksi}

Yläindeksit (a\textsuperscript{2}) tehdään komennolla \koodi{\keno
  text\-super\-script} ja alaindeksit (a\textsubscript{2}) komennolla
\koodi{\keno text\-sub\-script}. Oletusasetuksilla Latex toteuttaa
indeksit mekaanisesti pienentämällä fonttia ja sijoittamalla pienennetyn
tekstin peruslinjan tai gemenalinjan tuntumaan. Lopputulos ei ole
typografisesti välttämättä kovin hyvä, koska fontin pienentäminen
ohentaa samalla merkkien viivoja ja ohuimmat hiusviivat voivat lähes
kadota.

\englanti{Open Type} \=/fontit sisältävät usein tuen oikeille ylä- ja
alaindekseille, jotka fontin suunnittelija on toteuttanut. Niitä
kannattaa käyttää, koska suunnittelija tuntee oman fonttinsa ja saa
todennäköisesti parempaa jälkeä kuin Latex mekaanisesti. \englanti{Open
  Type} \=/fonttien indeksit on kätevintä ottaa käyttöön
\paketti{real\-scripts}\-/paketin avulla.\avctan{realscripts}

Paketti \paketti{real\-scripts} määrittelee uudelleen Latexin ylä- ja
alaindeksikomennot, niin että ne ensisijaisesti pyrkivät käyttämään
\englanti{Open Type} \=/fontin ominaisuutta. Jos käytössä oleva fontti
ei sisällä haluttujen merkkien ylä- tai alaindeksiä,
\paketti{real\-scripts}\-/paketin komennot käyttävät automaattisesti
Latexin mekaanista keinoa. Paketti määrittelee pari muutakin hyödyllistä
komentoa, muun muassa tähdelliset versiot edellä mainituista:
\koodi{\keno text\-su\-per\-script*} ja \koodi{\keno
  text\-sub\-script*}. Nämä komennot toteuttavat aina mekaanisen ylä-
tai alaindeksin eli toimivat kuten Latexin alkuperäiset komennot.
Seuraavassa esimerkissä vertaillaan oikeita ja mekaanisia (tähdelliset)
ylä- ja alaindeksejä.

\pagebreak[3]

\begin{koodilohkosis}
  x\textsuperscript {ab36}
  x\textsuperscript*{ab36} \\
  H\textsubscript {2}SO\textsubscript {4}
  H\textsubscript*{2}SO\textsubscript*{4}
\end{koodilohkosis}

\begin{tulossis}
  x\textsuperscript {ab36}
  x\textsuperscript*{ab36} \\*
  H\textsubscript {2}SO\textsubscript {4}
  H\textsubscript*{2}SO\textsubscript*{4}
\end{tulossis}

Kuten esimerkki paljastaa, lopputuloksessa on eroa. Ensin mainitut ovat
fontin suunnittelijan versioita ja jälkimmäiset Latexin mekaanisesti
tekemiä. Mekaaninen ylä- ja ala\-in\-dek\-si\-toi\-min\-to ohentaa
merkkejä turhan paljon, eikä se ymmärrä poistaa gemenanumeroita
(3\,6\,2\,4) käytöstä vaan latoo ne sellaisenaan suunnilleen oikeaan
paikkaan.

Ylä- ja alaindeksejä käytettäessä on siis syytä ladata
\paketti{real\-scripts}\-/paketti ja käyttää indeksit hallitsevaa
\englanti{Open Type} \=/fonttia. Fonttien ominaisuuksia voi tutkia
käyttöjärjestelmän komentotulkissa komennolla \koodi{otf\-info}.
Toisaalta fonttiin sisältyviä ylä- ja alaindeksejä voi myös kirjoittaa
Unicode\-/merkistön avulla sellaisenaan. Lopputulos on sama.

\subsection{Tarkkeet ja erikoismerkit}
\label{luku:tarkkeet}

Latexissa on useita komentoja tarkkeellisten kirjainten
(\'a\,\v{s}\,\c{c}\,\~o) kirjoittamiseen sekä muille merkeille, joita ei
ehkä ihan helposti saa suoraan näppäimistöltä. Komentoja on koottu
taulukoihin \ref{tlk:tarkkeet}, \ref{tlk:erikoismerkit-lainaus} ja
\ref{tlk:erikoismerkit-muut}. Taulukon tarkekomennoissa on käytetty
a\=/kirjainta esimerkkinä, mutta tarke voi liittyä muihinkin kirjaimiin.
\marginaali{\TeX \\ \LaTeX} Merkit voi kirjoittaa
Latex\-/lähdedokumenttiin myös sellaisenaan, eli näiden komentojen
käyttö ei ole välttämätöntä. Tarke- ja erikoismerkkikomentojen lisäksi
on komennot ladontajärjestelmän logojen kirjoittamiseen: \koodi{\keno
  TeX} ja \koodi{\keno LaTeX}.

\providecommand{\rivi}{}
\renewcommand{\rivi}[3]{#2 & \koodi{\keno #1} & #3 \\}

\leijutlk{
  \begin{tabular}[t]{cll}
    \toprule
    \multicolumn{2}{l}{\ots{Merkki}} & \ots{Selitys} \\
    \midrule
    \rivi{`a}{\`a}{gravis}
    \rivi{'a}{\'a}{akuutti}
    \rivi{\^{}a}{\^a}{sirkumfleksi}
    \rivi{\~{}a}{\~a}{tilde}
    \rivi{\textquotedbl a}{\"a}{treema}
    \rivi{H\{a\}}{\H{a}}{kaksoisakuutti}
    \rivi{r\{a\}}{\r{a}}{yläympyrä}
    \rivi{v\{a\}}{\v{a}}{hattu}
    %\rivi{t\{ae\}}{\t{ae}}{sidontakaari}
    \rivi{u\{a\}}{\u{a}}{lyhyysmerkki}
    \rivi{=a}{\=a}{pituusmerkki}
    \rivi{b\{a\}}{\b{a}}{alaviiva}
    \rivi{c\{a\}}{\c{a}}{sedilji}
    \rivi{.a}{\.a}{yläpiste}
    \rivi{d\{a\}}{\d{a}}{alapiste}
    \rivi{k\{a\}}{\k{a}}{ogonek}
    \\
    \rivi{L}{\L}{poikkiviiva-L}
    \rivi{l}{\l}{poikkiviiva-l}
    \bottomrule
  \end{tabular}\hspace{1.3em}%
  \begin{tabular}[t]{cll}
    \toprule
    \multicolumn{2}{l}{\ots{Merkki}} & \ots{Selitys} \\
    \midrule
    \rivi{O}{\O}{poikkiviiva-O}
    \rivi{o}{\o}{poikkiviiva-o}
    \rivi{DJ}{\DJ}{poikkiviiva-D}
    \rivi{dj}{\dj}{poikkiviiva-d}
    \rivi{DH}{\DH}{versaali-eth}
    \rivi{dh}{\dh}{gemena-eth}
    \rivi{NG}{\NG}{versaali-äng}
    \rivi{ng}{\ng}{gemena-äng}
    \rivi{SS}{\SS}{versaali kaksois-s}
    \rivi{ss}{\ss}{gemena kaksois-s}
    \rivi{TH}{\TH}{versaali thorn}
    \rivi{th}{\th}{gemena thorn}
    \rivi{i}{\i}{pisteetön i}
    \rivi{j}{\j}{pisteetön j}
    \rivi{AE}{\AE}{AE-ligatuuri}
    \rivi{ae}{\ae}{ae-ligatuuri}
    \rivi{OE}{\OE}{OE-ligatuuri}
    \rivi{oe}{\oe}{oe-ligatuuri}
    \bottomrule
  \end{tabular}
}{
  \caption{Komentoja tarkkeellisten ja muiden kirjainten
    kirjoittamiseen}
  \label{tlk:tarkkeet}
}

\providecommand{\rivi}{}
\renewcommand{\rivi}[3]{#1 & \koodi{\keno #2} & #3 \\}

\leijutlk{
  \begin{tabular}{cll}
    \toprule
    \multicolumn{2}{l}{\ots{Merkki ja komennot}} & \ots{Selitys} \\
    \midrule
    \rivi{\textquotedblleft}{textquotedblleft `{}`}{vasen lainausmerkki}
    \rivi{\textquotedblright}{textquotedblright '{}'}{oikea lainausmerkki}
    \rivi{\textquotedbl}{textquotedbl}{yleislainausmerkki (\textsc{ascii})}
    \rivi{\textquoteleft}{textquoteleft \keno lq `}{vasen puolilainausmerkki}
    \rivi{\textquoteright}{textquoteright \keno rq '}{oikea
    puolilainausmerkki, heittomerkki}
    \rivi{\textquotesingle}{textquotesingle}{yleispuolilainausmerkki ja
    heittomerkki (\textsc{ascii})}
    \rivi{\guillemotleft}{guillemotleft <{}<}{vasen kulmalainausmerkki}
    \rivi{\guillemotright}{guillemotright >{}>}{oikea kulmalainausmerkki}
    \rivi{\guilsinglleft}{guilsinglleft}{vasen kulmapuolilainausmerkki}
    \rivi{\guilsinglright}{guilsinglright}{oikea
    kulmapuolilainausmerkki}
    \rivi{\quotedblbase}{quotedblbase}{rivinalinen lainausmerkki}
    \rivi{\quotesinglbase}{quotesinglbase}{rivinalinen puolilainausmerkki}
    \bottomrule
  \end{tabular}
}{
  \caption{Komentoja lainausmerkkien kirjoittamiseen}
  \label{tlk:erikoismerkit-lainaus}
}

\leijutlk{
  \begin{tabular}{cll}
    \toprule
    \multicolumn{2}{l}{\ots{Merkki ja komennot}} & \ots{Selitys} \\
    \midrule
    \rivi{\textendash}{textendash --}{lyhyt ajatusviiva}
    \rivi{\textemdash}{textemdash ---}{pitkä ajatusviiva}
    \rivi{\textexclamdown}{textexclamdown !`}{yläsalainen huutomerkki}
    \rivi{\textquestiondown}{textquestiondown ?`}{ylösalainen kysymysmerkki}
    \rivi{\textgreater}{textgreater}{suurempi kuin -merkki}
    \rivi{\textless}{textless}{pienempi kuin -merkki}
    \rivi{\ldots}{textellipsis \keno ldots \keno dots}{kolme pistettä, ellipsi}
    \rivi{\texteuro}{texteuro}{euron merkki}
    \rivi{\pounds}{textsterling \keno pounds}{punnan merkki}
    \rivi{\textdollar}{textdollar \keno \$}{dollarin merkki}
    \rivi{\S}{textsection \keno S}{pykälän merkki}
    \rivi{\P}{textparagraph \keno P}{kappaleen merkki}
    \rivi{\copyright}{textcopyright \keno copyright}{tekijänoikeusmerkki}
    \rivi{\textregistered}{textregistered}{rekisteröity tavaramerkki}
    \rivi{\texttrademark}{texttrademark}{tavaramerkki}
    \rivi{\dag}{textdagger \keno dag}{risti}
    \rivi{\ddag}{textdaggerdbl \keno ddag}{kaksoisristi}
    \rivi{\textasciicircum}{textasciicircum \keno \^{}\{\}}{sirkumfleksi}
    \rivi{\textasciitilde}{textasciitilde \keno \~{}\{\}}{tilde}
    \rivi{\textasteriskcentered}{textasteriskcentered}{rivinkeskinen
    asteriski, tähti}
    \rivi{\textbackslash}{textbackslash}{kenoviiva}
    \rivi{\textbar}{textbar}{pystyviiva}
    \rivi{\textbardbl}{textbardbl}{kaksoispystyviiva}
    \rivi{\textbraceleft}{textbraceleft \keno \{}{vasen aaltosulje}
    \rivi{\textbraceright}{textbraceright \keno \}}{oikea aaltosulje}
    \rivi{\textbullet}{textbullet}{luetelmaympyrä}
    \rivi{{\varafontti\textbigcircle}}{textbigcircle}{suuri ympyrä}
    % \rivi{\textcircled{a}}{textcircled\{\ldots\}}{ympyröity merkki}
    \rivi{\textleftarrow}{textleftarrow}{nuoli vasemmalle}
    \rivi{\textrightarrow}{textrightarrow}{nuoli oikealle}
    \rivi{\textordfeminine}{textordfeminine}{feminiininen järjestysluvun
    merkki}
    \rivi{\textordmasculine}{textordmasculine}{maskuliininen järjestysluvun
    merkki}
    \rivi{\textperiodcentered}{textperiodcentered}{rivinkeskinen piste}
    \rivi{\textunderscore}{textunderscore \keno\_}{alaviiva}
    \rivi{\textvisiblespace}{textvisiblespace}{näkyvä välilyönti}
    \bottomrule
  \end{tabular}
}{
  \caption{Komentoja erikoismerkkien kirjoittamiseen}
  \label{tlk:erikoismerkit-muut}
}

\section{Tavutus KESKEN}
\label{luku:tavutus}

Latex tavuttaa eli katkaisee sanoja automaattisesti rivien lopussa,
jotta se saisi rivit ja kappaleet näyttämään tasapainoisilta.
Lähtökohtaisesti tavutus määräytyy kielikohtaisten tavutussääntöjen ja
\=/asetusten perusteella, mutta kirjoittaja voi tehdä poikkeuksia
kirjoittamalla tavu\-tus\-vih\-jeitä. Käytännössä tavutusvihjeitä
tarvitaan välillä.

Kielen valintaa ja yleisiä kieli\-ase\-tuk\-sia käsitellään tarkemmin
luvussa \ref{luku:kieliasetukset}, mutta mainitaan tässäkin, että suomen
kieli ja sen mukainen tavutus saadaan päälle, kun dokumentin
esittelyosaan kirjoittaa seuraavat komennot.

\begin{koodilohkosis}
  \usepackage{polyglossia}
  \setmainlanguage{finnish}
\end{koodilohkosis}

Tavutusta käsitellään tässä vain \paketti{polyglossia}\-/kielipaketin
näkökulmasta. Toinen kielipaketti \paketti{babel} toimii hieman eri
tavalla, ja sitä varten pitäisi kirjoittaa melkein kokonaan toisenlainen
luku tähän oppaaseen.

\subsection{Yleiset tavutussäännöt}

Latexin automaattinen tavutus ei perustu varsinaiseen sanojen eikä
taivutusmuotojen tunnistamiseen vaan yksinkertaisiin kirjainpohjaisiin
sääntöihin. Säännöt pyrkivät kuvaamaan kielen tavujen rakenteen ja
huomioimaan myös typografiaan liittyviä suosituksia.

Automaattinen tavutus auttaa paljon mutta ei yksinään riitä, koska se
tekee välillä virheitä tai tuottaa muuten suositusten vastaista jälkeä.
Kirjoittajan apua siis tarvitaan välillä. Yksi tapa tavutusvihjeiden
kirjoittamiseen on \koodi{\keno hyphenation}\-/komento, jolla
määritellään yksittäisten sanojen tavutuskohdat kaikkialla dokumentissa.
Seuraava esimerkki selventää komennon käyttöä.

\begin{koodilohkosis}
  \hyphenation{
    alku-osa nimen-omaan
    typo-gra-fi-nen
  }
\end{koodilohkosis}

Komennon perään aaltosulkeiden sisään kirjoitetaan sanoja, jotka
erotetaan toisistaan sanaväleillä. Sanoihin kirjoitetaan yhdysmerkki
niihin kohtiin, joista sanan katkaiseminen on sallittua. Jos sanassa
itsessään on yhdysmerkki, sen tavutusta ei voi käsitellä tällä
komennolla. Luvussa \ref{luku:tavutuksen_merkit} kerrotaan muita tapoja.

\koodi{\keno hyphenation}\-/komennon voi sijoittaa dokumentin
esittelyosaan tai tekstiosaan, mutta sijainti vaikuttaa sen toimintaan.
Jos komennon sijoittaa dokumentin esittelyosaan ennen kuin mitään kieltä
on ladattu tai valittu, se vaikuttaa kaikkien sanojen tavutukseen
kielestä riippumatta. Jos komennon sijoittaa dokumentin tekstiosaan eli
kielen valitsemisen jälkeen, se vaikuttaa vain kyseisen kielen eli
yleensä dokumentin pääasiallisen kielen tavutukseen.

\subsection{Yksittäisten sanojen tavutus}
\label{luku:tavutuksen_merkit}

Tietyt sanassa mukana olevat merkit kytkevät muut tavutussäännöt pois
päältä ja muuttavat sanan tavutuksen yksilölliseksi. Jos sanassa on
mukana yksikin tavutusvihje (\koodi{\keno-}), yhdysmerkki (\koodi{-}),
lyhyt ajatusviiva (\mbox{\koodi{--}}) tai pitkä ajatusviiva
(\mbox{\koodi{---}}), sana katkaistaan vain näiden kohdalta
(\koodi{\keno-}) tai jälkeen.

Myös Unicoden ajatusviivamerkit \uctunnus{u+2013 en dash} ja
\uctunnus{u+2014 em dash} toimivat, mutta ne käyttäytyvät tavutuksen
kannalta eri tavalla Lualatex\-/{} ja Xelatex\-/kääntäjillä.
Yhteensopivuussyistä kannattanee välttää Unicoden ajatusviivoja.

\leijutlk{
  \begin{tabular}{lll}
    \toprule
    \ots{Lähde}
    & \ots{Tavutus}
    & \ots{Selitys} \\
    \midrule
    \koodi{matkustaa}
    & mat\tavukohta kus\tavukohta taa
    & tavutus kaikista kohdista \\
    \koodi{matkus\keno-taa}
    & matkus\tavukohta taa
    & vain tavutusvihjeen kohdalta \\
    \koodi{matka-aika}
    & matka-\tavukohta aika
    & vain yhdysmerkin jälkeen \\
    \koodi{matka-ai\keno-ka}
    & matka-\tavukohta ai\tavukohta ka
    & vain yhdysmerkki ja tavutusvihje \\
    \koodi{Oulu--Rovaniemi}
    & Oulu--\tavukohta Rovaniemi
    & vain ajatusviivan jälkeen \\
    \koodi{Oulu--Rova\keno-niemi}
    & Oulu--\tavukohta Rova\tavukohta niemi
    & vain ajatusviiva ja tavutusvihje \\
    \koodi{matka-}
    & matka-
    & ei tavutuskohtia \\
    \koodi{-aika}
    & -\tavukohta aika
    & vain yhdysmerkin jälkeen \\
    \bottomrule
  \end{tabular}
}{
  \caption{Tavutusvihjeen, yhdysmerkin ja ajatusviivan vaikutus
    tavutukseen}
  \label{tlk:tex-tavutus}
}

Taulukossa \ref{tlk:tex-tavutus} on esimerkkejä tavutusvihjeiden,
yhdysmerkin ja ajatusviivan vaikutuksesta. Ensimmäisessä sarakkeessa on
esimerkkisana siinä muodossa kuin se kirjoitetaan lähdetiedostoon.
Toisessa sarakkeessa on ladottu sana, johon on pystyviivalla merkittynä
mahdolliset tavutuskohdat.

Taulukon viimeinen rivi paljastaa suomen kielen kannalta ongelmallisen
tilanteen. Esimerkiksi ilmauksessa \emph{matkasuunnitelma ja
  \mbox{-aika}} ei riviä saa katkaista sanassa \emph{\mbox{-aika}}
olevan yhdysmerkin jälkeen, koska rivin loppuun jäisi yksinäinen
yhdysmerkki. Latexin peruskeinoilla sana täytyy laittaa näkymättömään
laatikkoon, joka pitää merkit yhdessä: \koodi{\keno mbox\{-aika\}}.
Toinen vaihtoehto on sitovan yhdysmerkin käyttö, jota käsitellään
seuraavassa alaluvussa, muun muassa.

\subsection{Tavutuksen sallivia ja sitovia merkkejä}
%\label{luku:tavutus_salsit}

Unicode\-/merkistön sitova yhdysmerkki \uctunnus{u+2011 non\-/breaking
  hyphen} näkyy tavallisena yhdysmerkkinä, mutta se estää sanan
katkaisemisen yhdysmerkin vierestä. \uctunnus{u+2011}\-/merkkiä voi
käyttää Xelatex\-/kääntäjän kanssa, mutta Lualatex\-/kääntäjä vain
kadottaa koko merkin. Yhteensopivuussyistä ei kannata käyttää Unicoden
sitovaa yhdysmerkkiä, sillä muitakin vaihtoehtoja on.

Makropaketti \paketti{extdash}\avctan{extdash} tuo uusia komentoja ja
mahdollisuuksia tavutuksen hallintaan. Komennot ovat sellaisia kuin
\koodi{\keno Hyph\-dash} ja \koodi{\keno En\-dash}, mutta niille on
saatavilla myös lyhemmät muodot, jos paketin lataa käyttämällä
\koodi{short\-cuts}\-/valitsinta.

\begin{koodilohkosis}
  \usepackage[shortcuts]{extdash}
\end{koodilohkosis}

Paketti sisältää kaksi lisä\-vaihto\-ehtoa kolmelle viivavälimerkille
eli yhdysmerkille, lyhyelle ajatusviivalle ja pitkälle ajatusviivalle.
Kun Latexin viivavälimerkit (luku \ref{luku:tavutuksen_merkit}) aina
estävät tavutuksen muualta kuin välimerkin jälkeen,
\paketti{extdash}\-/paketin perus\-vaihto\-ehdot sallivat tavutuksen
muualtakin. Lisäksi kaikille kolmelle viivavälimerkille on sitova
versio, joka estää tavutuksen välimerkin jälkeen (mutta sallii muualta).

Taulukossa \ref{tlk:extdash} ovat \paketti{extdash}\-/paketin tärkeimmät
komennot ja niiden merkitykset. Taulukossa \ref{tlk:extdash-vertailu}
vertaillaan \paketti{extdash}\-/paketin komentoja Latexin vastaaviin.

\leijutlk{
  \begin{tabular}{ll}
    \toprule
    \ots{Komento} & \ots{Merkitys} \\
    \midrule
    \koodi{\keno -/} & tavutuksen salliva yhdysmerkki \\
    \koodi{\keno =/} & sitova, tavutuksen salliva yhdysmerkki \\
    \koodi{\keno --} & tavutuksen salliva lyhyt ajatusviiva \\
    \koodi{\keno ==} & sitova, tavutuksen salliva lyhyt ajatusviiva \\
    \koodi{\keno ---} & tavutuksen salliva pitkä ajatusviiva \\
    \koodi{\keno ===} & sitova, tavutuksen salliva pitkä ajatusviiva \\
    \bottomrule
  \end{tabular}
}{
  \caption{\paketti{extdash}-paketin komentoja}
  \label{tlk:extdash}
}

\leijutlk{
  \begin{tabular}{llll}
    \toprule
    \ots{Lähde} & \ots{Tavutus}
    & \ots{Lähde} & \ots{Tavutus} \\
    \midrule
    \koodi{matka-aika}
                & matka-\tavukohta aika
                & \koodi{Oulu--Rovaniemi}
                & Oulu--\tavukohta Rovaniemi \\
    \koodi{matka\keno -/aika}
                & mat\tavukohta ka-\tavukohta ai\tavukohta ka
                & \koodi{Oulu\keno --Rovaniemi}
                & Ou\tavukohta lu--\tavukohta Ro\tavukohta va\tavukohta
                  nie\tavukohta mi \\
    \koodi{matka\keno =/aika}
                & mat\tavukohta ka-ai\tavukohta ka
                & \koodi{Oulu\keno ==Rovaniemi}
                & Ou\tavukohta lu--Ro\tavukohta va\tavukohta
                  nie\tavukohta mi \\
    \koodi{matka-}
                & matka-
                & \koodi{-aika}
                & -\tavukohta aika \\
    \koodi{matka\keno -/}
                & mat\tavukohta ka-
                & \koodi{\keno =/aika}
                & -ai\tavukohta ka \\
    \bottomrule
  \end{tabular}
}{
  \caption{Latexin ja \paketti{extdash}-paketin komentojen vertailua}
  \label{tlk:extdash-vertailu}
}

On tärkeää huomioida, että \paketti{extdash}\-/paketin komennot ovat
todellakin normaaleja komentoja. Se tarkoittaa, että komennon jälkeiset
sanavälit syödään pois eli ne katoavat. Tämä asiaa saattaa unohtua
seuraavanlaisessa tilanteessa, jossa käytetään tavutuksen sallivaa
yhdysmerkkikomentoa \koodi{\keno-/}.

\pagebreak[3]

\begin{koodilohkosis}
  matka\-/ ja aika\-/arvio
\end{koodilohkosis}

\begin{tulossis}
  matka\-/ ja aika\-/arvio
\end{tulossis}

Ensimmäisen yhdysmerkkikomennon jälkeinen sanaväli hävisi, ja syntyi
virheellinen sana \emph{matka-ja}. Sanavälin saa säilymään, kun
kirjoittaa komennon perään aaltosuljeparin tai kenoviivan ja sanavälin.

\pagebreak[3]

\begin{koodilohkosis}
  matka\-/{} ja aika\-/arvio \\
  matka\-/\ ja aika\-/arvio
\end{koodilohkosis}

\begin{tulossis}
  matka\-/{} ja aika\-/arvio \\
  matka\-/\ ja aika\-/arvio
\end{tulossis}

\subsection{Tavutus sanan reunasta}

Asetukset \koodi{\keno left\-hy\-phen\-min=N} ja \koodi{\keno
  right\-hy\-phen\-min=N} vaikuttavat tavutukseen sanan reunoissa.
Argumentti \koodi{N} on positiivinen kokonaisluku, ja se määrittelee,
kuinka monta merkkiä vähintään sanan vasemmasta tai oikeasta reunasta
pidetään yhdessä. Oletus\-arvot ovat kielikohtaisia ja määritellään
\paketti{polyglossia}\-/{} ja \paketti{babel}\-/paketeissa. Suomen
kielessä kumpikin asetus on kaksi (2) merkkiä.

Nämä asetukset alustetaan kielikohtaisiin oletus\-arvoihin aina, kun
kie\-li\-ase\-tuk\-set tulevat voimaan. Näin on esimerkiksi dokumentin
aloittavan \koodi{document}\-/ympäristön alussa tai kielen vaihtuessa.
Tästä seuraa, että jos asetuksia ha\-luaa muuttaa, täytyy ne asettaa
\koodi{document}\-/ympäristön alussa tai aina kielen vaihtamisen
jälkeen.

Omat kieli\-asetukset saa mukaan automaattisesti, kun lisää muutokset
kielikohtaisiin alustuskomentoihin alla olevan esimerkin mukaisesti.
Tällä tavoin omat asetukset tulevat voimaan samalla kuin muutkin
kie\-li\-ase\-tuk\-set.

\begin{koodilohkosis}
  \addto{\captionsfinnish}{
    \lefthyphenmin=3
    \righthyphenmin=3
  }
\end{koodilohkosis}

Esimerkissä oleva komento \koodi{\keno add\-to} on
\paketti{polyglossia}\-/{} ja \paketti{babel}\-/paketin ominaisuus, ja
tässä käsitellään suomen kielen asetuksia (\koodi{\keno
  cap\-tions\-finnish}).

\subsection{Tavutusvinkkejä suomen kieleen}

Latexin kirjainyhdistelmiin perustuvat säännöt eivät yksinään riitä
suomen kieleen, ja esimerkiksi yhdyssanojen rajakohdat tuottavat usein
ongelmia. Sana \emph{alku\-osa} katkaistaan Latexin sääntöjen mukaan
kohdista \mbox{\emph{al-kuo-sa}}. Se on kyllä oikein tavurakenteen
kannalta mutta käytännössä ongelmallinen: myös yhdyssanan rajalla on
tavutuskohta (\emph{al-ku-o-sa}), ja sanaa ei pitäisi katkaista siten,
että siitä jää yksittäinen kirjain eri riville (\emph{o-sa}).

Parasta olisi katkaista suomen kielen yhdyssanat vain yhdys\-osien
välistä (\emph{alku-osa}). Muualtakin voi katkaista (\emph{al-ku-osa}),
kunhan sanasta eikä sen yhdys\-osasta ei jää yksittäinen kirjain eri
riville. Mielellään ei katkaista myöskään kahden vokaalin välistä, jos
ne kuuluvat samaan sanaan (\emph{kau-emmin}). Joskus halutaan välttää
myös niin sanottuja orpotavuja eli sitä, että tekstikappaleen
viimeiselle riville jää vain yksi tavu.

Käytännössä siis suomenkielinen teksti ja hyvä typografia vaativat
välillä tavutusvihjeiden kirjoittamista. Yhdyssanojen osien väliin
tarvitaan tavutusvihje silloin, kun jälkimmäinen osa alkaa vokaalilla
tai useammalla kuin yhdellä konsonantilla. Joitakin tällaisia tapauksia
Latex osaa tavuttaa oikein ilman tavutusvihjeitäkin, mutta etukäteen
sitä ei välttämättä tiedä.

\begin{koodilohkosis}
  alku\-osa pusku\-traktori
\end{koodilohkosis}

Pitkät yhdysmerkin tai ajatusviivan sisältävät yhdyssanat voivat vaatia
tavutuskohtien lisäämistä, koska Latexin yhdysmerkki ja ajatusviivat
estävät tavutuksen muualta kuin näiden merkkien jälkeen. Ilman
tavutuskohtien lisäämistä Latexilla ei ehkä ole riittävästi vaihtoehtoja
tekstikappaleen latomiseen, ja voi syntyä liian suuria sanavälejä tai
riveistä tulee ylipitkiä eli yltävät marginaalin puolelle. Tavutuskohtia
voi lisätä sopiviin kohtiin omilla tavutusvihjeillä (\koodi{\keno-}).
Kaikki yleisten tavutussääntöjen mukaiset tavutuskohdat saa käyttöön
\paketti{extdash}\-/paketin komennoilla (taulukko \ref{tlk:extdash}).

\begin{koodilohkosis}
  Molo\-tov--Ribben\-trop-sopi\-mus
  Molotov\--Ribbentrop\-/sopimus
\end{koodilohkosis}

Tavutuksen hallintaa voi lähestyä ainakin kahdesta eri suunnasta. Joku
ehkä haluaa kirjoittaa dokumentin sisällön valmiiksi ilman, että
huolehtii tavu\-tus\-asiois\-ta lainkaan. Ihan lopuksi, kun kaikki
tekstin rivittämiseen liittyvät asetukset ovat valmiina, hän tarkistaa
koko tekstin ja lisää tavutusvihjeitä, jos automaattinen tavutus teki
virheitä tai jos kappaleen latominen tasapainoiseksi niitä muuten
vaatii.

Joku toinen ehkä mieluummin kirjoittaa dokumentin jo alusta saakka
siten, ettei virheellistä tavutusta tapahdu ja että tavutuskohtia on
tarjolla riittävästi, jotta kappaleet saadaan ladottua aina
hyvännäköiseksi. Tämä näkökulma vaatii, että jo kirjoitusvaiheessa
ymmärtää, miten tavutus toimii ja missä mahdolliset ongelmakohdat ovat.

\subsection{Muita tavutusasetuksia ja -vinkkejä}

% \newcommand{\hmtavu}{\discretionary{-}{}{'}}

% vaa\hmtavu al\-la
% rei\hmtavu it\-tää
% liu\hmtavu ut\-taa
%
% Voi tehdä tavutuskohtia, joihin ei tule mitään merkkiä:
% \discretionary{}{}{}

% Kieli\-asetuksia hoitavan \paketti{polyglossia}\-/paketin uudehkot
% versiot (2020\==) tukevat suomen kielelle
% \koodi{babel\-short\-hands}\-/valitsinta, joka lisää keinovalikoimaan
% \paketti{babel}\-/paketista peräisin olevia tavutuksen
% hallintakomentoja. On esimerkiksi tavutuksen salliva yhdysmerkki
% (\koodi{\textquotedbl-}), joka toimii samoin kuin
% \paketti{extdash}\-/paketin \koodi{\keno-/}.

% Mukana on myös sitova, kaiken tavutuksen estävä yhdysmerkki
% (\koodi{\textquotedbl\textasciitilde}), jolle ei ole vastinetta Texissä
% eikä \paketti{extdash}\-/paketissa -- muuten kuin \koodi{\keno
%   mbox}\-/laatikon avulla. \paketti{polyglossia}\-/paketin ''Baabelin
% lyhenteet'' sisältävät eräitä muitakin hyödyllistä sanan katkaisemiseen
% liittyviä komentoja.

% Babel: "= sitova-salliva yhdysmerkki; "" tavutuskohta ilman
% yhdysmerkkiä; "| ligatuurin esto

% showhyphens-paketti

.

\section{Komennot}
\label{luku:komennot}

Latexin komennot alkavat kenoviivalla (\koodi{\textbackslash}), jonka
jälkeen tulee komennon nimi. Nimi koostuu yleensä pienistä tai isoista
kirjaimista, mutta komento voi olla myös merkkejä.

Komennot voivat ottaa vastaan argumentteja eli lisätietoa, jota komento
käsittelee ja tarvitsee toimintaansa. Jotkin argumentit voivat olla
pakollisia ja jotkin valinnaisia. Pakolliset kirjoitetaan
aaltosulkeisiin \koodi{\{\ldots\}} ja valinnaiset hakasulkeisiin
\koodi{[\ldots]}.

\begin{koodilohkosis}
  \komento
  \toinenkomento{argu}{mentteja}
  \toinenkomento[valinnainen]{argu}{mentteja}
\end{koodilohkosis}

Jos pakolliseen argumenttiin haluaa sisällyttää aaltosulkeen, täytyy sen
eteen kirjoittaa kenoviiva: \koodi{\keno komento\{\keno\}\}}. Tämä pätee
aaltosulkeisiin muutenkin, eli ne saa ladottua tekstiin vain kenoviivan
kanssa. Hakasulkeet sen sijaan ladotaan tekstiin normaalisti, eikä
niiden kanssa käytetä kenoviivaa. Poikkeustilanne on komennon
valinnaisen argumentin sisällä, koska valinnainen argumentti jo sinänsä
kirjoitetaan hakasulkeiden sisään. Hakasulkeita ei voi suojata
kenoviivalla, koska \koodi{\keno[} ja \koodi{\keno]} ovat komentoja jo
itsessään. Niillä luodaan matematiikkatilassa (luku
\ref{luku:matematiikka}) oleva tekstilohko. Valinnaisen argumentin
sisään saa hakasulkeen, kun sen suojaa aaltosuljeparilla: \koodi{\keno
  komento[\{]\}]}.

Komennon yhteydessä sanavälejä käsitellään hieman poikkeuksellisesti.
Esimerkiksi komennon nimen perässä olevat sanavälit syödään pois, jos
komennolle ei anneta yhtään argumenttia. Seuraavassa esimerkissä sana
\emph{Latex} ladotaan ehjänä, jos vain \koodi{\keno ko\-men\-to}
itsessään ei kirjoita mitään eikä vaikuta tekstin latomiseen.

\pagebreak[3]

\begin{koodilohkosis}
  La\komento   tex
\end{koodilohkosis}

\begin{tulossis}
  Latex
\end{tulossis}

Jos haluaa komennon jälkeen yhden sanavälin, täytyy kirjoittaa komennon
nimen jälkeen aaltosulkeet (\koodi{\keno komento\{\}}) tai kenoviiva ja
sanaväli (\koodi{\keno komento\keno~}). Komennon nimen ja argumenttien
välissä voi olla sanavälejä, ja ne kaikki syödään pois. Komennon ja sen
argumentit voi siis kirjoittaa vaikka seuraavalla tavalla.

\begin{koodilohkosis}
  \toinenkomento  [valinnainen]
     {argu}   {mentteja}
\end{koodilohkosis}

\subsection{Omat komennot ja abstrahointi}

Omien komentojen tärkein tarkoitus on merkintätapojen abstrahointi eli
teknisen toteutuksen ja yksityiskohtien piilottaminen. Abstrahointi voi
helpottaa työskentelyä huomattavastikin ja tehdä lähdedokumentista
helppolukuisen. Otetaan esimerkki tämän oppaan toteutuksesta.

Tämä opas käsittelee välillä Unicode\-/merkkejä ja niiden tunnuksia
kuten \uctunnus{u+0061 latin small letter~a}. Merkkien tunnukset
ladotaan erilaisella kirjainleikkauksella, pienversaalilla eli
kapiteelilla. Jos fontti vain tukee pienversaalia, sitä saadaan helposti
komennolla \koodi{\keno text\-sc}. Silti tätä komentoa ei ehkä kannata
käyttää suoraan dokumentissa. Jos nimittäin kirjoittaa dokumentin
täyteen \koodi{\keno text\-sc}\-/komentoja, voi myöhemmin olla työlästä
muuttaa Unicode\-/tunnusten ulko\-asu ja toteutus toisenlaiseksi.

Jossain vaiheessa kirjoittaja oivaltaa, että Unicode\-/tunnukset ovat
englannin kieltä ja että sanoja pitäisi tavuttaa englannin sääntöjen
mukaan eikä suomen. Pitäisi siis liittää \koodi{\keno
  text\-sc}\-/komentojen ympärille vielä \koodi{\keno
  text\-en\-glish}\-/komento.%
\footnote{Komento \koodi{\keno text\-english} on
  \paketti{polyglossia}\-/paketin ominaisuus.} Lähdedokumentin
kirjoittaminen on ikävää ja ulko\-asu sekava, jos Unicode\-/tunnusten
kohdalla on aina \koodi{\keno text\-english\{\keno text\-sc\{\ldots\}\}}.

Parasta olisi jo ennen kirjoittamista miettiä, mitä rakenteita teksti
sisältää. Erilaisia rakenteita tai ilmauksia varten kannattaa luoda
komento, jotta sen toteutusta voi myöhemmin muuttaa helposti.
Esimerkiksi Unicoden merkkitunnuksille voisi luoda oman komennon
\koodi{\keno uctunnus}, jota käytetään aina tunnusten ilmaisemiseen
Latex\-/dokumentissa. Komento määritellään vain yhdessä paikassa, ja
määritelmää on helppoa muuttaa. Tekstikin pysyy selkeänä, kun siellä on
vain korkean tason komentoja, jotka ilmaisevat tarkoituksen eivätkä
teknistä toteutusta.

\subsection{Komentojen määrittely}
\label{luku:komennot-määr}

Komentojen määrittelyyn on kolme erilaista komentoa, ja niille kaikille
annetaan samanlaiset argumentit. Komennot ovat seuraavat:

\begin{koodilohkosis}
  \newcommand     {\nimi}[n][oletus]{määritelmä}
  \renewcommand   {\nimi}[n][oletus]{määritelmä}
  \providecommand {\nimi}[n][oletus]{määritelmä}
\end{koodilohkosis}

Ensimmäinen pakollinen argumentti on komennon nimi (\koodi{\keno
  ni\-mi}). Komento \koodi{\keno newcommand} määrittelee uuden komennon.
Mikäli komento on jo olemassa, annetaan virheilmoitus. Toinen komento
\koodi{\keno renewcommand} määrittelee olemassa olevan komennon
uudelleen. Se antaa virheilmoituksen, jos komentoa ei ollut olemassa.
Kolmas komento \koodi{\keno pro\-vide\-command} puolestaan määrittelee
uuden komennon vain siinä tapauksessa, että sellaista ei ollut ennen
olemassa. Se ei anna virheilmoitusta.

Komentojen toinen pakollinen argumentti (\koodi{mää\-ri\-tel\-mä})
sisältää komennon määritelmän eli mitä tahansa tekstiä tai komentoja.
Suoritusvaiheessa komento ikään kuin vaihdetaan sen määritelmäksi.

\pagebreak[3]

\begin{koodilohkosis}
  \newcommand{\komento}{Minua komennettiin!}
  \komento
\end{koodilohkosis}

\begin{tulossis}
  Minua komennettiin!
\end{tulossis}

Komentojen ensimmäinen valinnainen argumentti (\koodi{n}) on luku, joka
kertoo, kuinka monta argumenttia määriteltävä komento käsittelee.
Määritelmässä voi käyttää parametreja \koodi{\#1}, \koodi{\#2},
\koodi{\#3} jne., ja ne korvautuvat komennon suoritusvaiheessa
ensimmäisellä, toisella, kolmannella jne. argumentilla.

\pagebreak[3]

\begin{koodilohkosis}
  \newcommand{\komento}[2]{Sanoit #1 ja #2!}
  \komento{hip}{hei}
\end{koodilohkosis}

\begin{tulossis}
  Sanoit hip ja hei!
\end{tulossis}

Toinen valinnainen argumentti (\koodi{ole\-tus}) -- jos se on mukana --
kertoo, että määriteltävän komennon ensimmäinen argumentti on
valinnainen ja että tämä on sen ole\-tus\-arvo. Ole\-tus\-arvoa
käytetään silloin, kun valinnaista argumenttia ei ole annettu.

\pagebreak[3]

\begin{koodilohkosis}
  \newcommand{\komento}[3][tyyppi]{Hei #1, sanoit #2 ja #3!}
  \komento{hip}{hei} \\
  \komento[Leslie]{hip}{hei}
\end{koodilohkosis}

\begin{tulossis}
  Hei tyyppi, sanoit hip ja hei! \\
  Hei Leslie, sanoit hip ja hei!
\end{tulossis}

Joskus yhden komennon määritelmä sisältää komennon \koodi{\keno
  renewcommand}, joka sitten määrittelee uudelleen jonkin toisen
komennon. Silloin parametrit \koodi{\#1}, \koodi{\#2} jne. on
tarkoitettu ensimmäisen eli uloimman kerroksen käsiteltäväksi. Sisempi
kerros käyttää parametreja \koodi{\#\#1}, \koodi{\#\#2} jne.

Kaikista kolmesta komentojen määrittelykomennosta on olemassa
tähdellinen versio eli sellainen, jonka komennon nimen lopussa on tähti
(\koodi{*}). Latexin komennoissa on tapana, että tähdellinen versio --
jos sellainen on olemassa -- tarjoaa samaan asiaan jonkin toisenlaisen
näkökulman.

\begin{koodilohkosis}
  \newcommand*     {\nimi}[n][oletus]{määritelmä}
  \renewcommand*   {\nimi}[n][oletus]{määritelmä}
  \providecommand* {\nimi}[n][oletus]{määritelmä}
\end{koodilohkosis}

Komentojen määrittelyssä tähdelliset versiot toimivat muuten samalla
tavalla, mutta ne antavat virheilmoituksen, jos komennolle annetut
argumentit sisältävät enemmän kuin yhden tekstikappaleen. Niinpä
seuraava esimerkki tuottaa käännettäessä virheen.

\begin{koodilohkosis}
  \newcommand*{\komento}[1]{Teksti: #1}

  \komento{
    Ensimmäinen tekstikappale.

    Toinen tekstikappale.
  }
\end{koodilohkosis}

\koodi{\keno newcommand*}\-/komennolla määritelty \koodi{\keno
  ko\-men\-to} ei siis suostu ottamaan vastaan argumentteja, jotka
sisältävät kappaleen vaihtumisen eli enemmän kuin yhden tekstikappaleen.
Tähdelliset versiot tuovat tällaisen suo\-jaus\-omi\-nai\-suu\-den.

\subsection{Muita vinkkejä}
\label{luku:komennot-lisä}

Komennon määrittelyssä on välillä hyötyä \koodi{\keno
  ig\-nore\-spaces}\-/komennosta, joka jättää sanavälit huomioimatta
komennon jälkeen. Ilman tätä komentoa tulisi seuraavassa esimerkissä
sanojen väliin yksi välilyönti.

\pagebreak[3]

\begin{koodilohkosis}
  \newcommand{\komento}[1]{#1\ignorespaces}
  \komento{yhdys}       sana
\end{koodilohkosis}

\begin{tulossis}
  yhdyssana
\end{tulossis}

Aaltosulkeilla (luku \ref{luku:aaltosulkeet}) voi rajata
komentomäärittelyn vai\-ku\-tus\-aluet\-ta. Seuraavan esimerkin alussa
asetetaan \koodi{\keno ko\-men\-to} tiettyyn alkuperäismääritelmään.
Aaltosulkeiden sisällä se määritellään väliaikaisesti uudestaan.
Aaltosulkeilla rajatun ympäristön jälkeen komennon uusi määritelmä
lakkaa ja komento palautuu alkuperäiseksi.

\pagebreak[3]

\begin{koodilohkosis}
  \newcommand{\komento}{alkuperäinen}
  \komento
  {%
    \renewcommand{\komento}{muutettu}
    \komento
  }
  \komento
\end{koodilohkosis}

\begin{tulossis}
  alkuperäinen muutettu alkuperäinen
\end{tulossis}

Monimutkaisiin komentoihin voidaan tarvita ehtorakenteita. Ne saa
toteutettua \paketti{ifthen}\=/paketin\avctan{ifthen} tarjoaman
\koodi{\keno if\-then\-else}\-/komennon avulla. Se on
ohjelmointikielistä tuttu ehtorakenne: jos annettu ehtolauseke on tosi,
käsitellään then\-/haara; muussa tapauksessa käsitellään else-haara.

\section{Ympäristöt}
%\label{luku:ymparistot}

Ympäristöt ovat rakenteita, joilla on aloittava \koodi{\keno
  begin}\-/komento ja lopettava \koodi{\keno end}\-/komento sekä nimi.
Ympäristöjen ajatuksena on, että jokin ominaisuus tai jotkin toiminnot
ovat voimassa vain ympäristön sisällä ja asiat palautuvat ennalleen
ympäristön jälkeen. Tässä mielessä ne toimivat samalla tavalla kuin
aaltosulkeet (luku \ref{luku:aaltosulkeet}). Jos esimerkiksi
fonttiasetusta (luku \ref{luku:kirjaintyypit}) muuttaa ympäristön
sisäpuolella, asetus palautuu ympäristön jälkeen samaksi kuin se oli
ennen ympäristön alkua. Samoin ympäristön sisällä määritellyt komennot
(luku \ref{luku:komennot-määr}) ovat voimassa vain kyseisessä
ympäristössä.

\begin{koodilohkosis}
  \begin{nimi}
    % ympäristön
    % vaikutusalue
  \end{nimi}
\end{koodilohkosis}

Yleisin ympäristö on nimeltään \koodi{document}, jonka sisään koko
dokumentin sisältö kirjoitetaan. Muita ympäristöjä käytetään
tavallisesta leipätekstistä poikkeavien rakenteiden ilmaisemiseen,
esimerkiksi luetelmiin ja taulukoihin (luvut \ref{luku:luetelmat} ja
\ref{luku:taulukot}). Ympäristöjä voi tehdä itsekin mihin hyvänsä
tarkoitukseen. Niitä määritellään seuraavilla komennoilla.

\begin{koodilohkosis}
  \newenvironment   {nimi}[n][oletus]{aloitus}{lopetus}
  \renewenvironment {nimi}[n][oletus]{aloitus}{lopetus}
\end{koodilohkosis}

Komento \koodi{\keno newenvironment} määrittelee uuden ympäristön. Se
antaa virheilmoituksen, jos samanniminen ympäristö on jo olemassa.
Komento \koodi{\keno renewenvironment} puolestaan määrittelee uudelleen
ympäristön, joka on jo olemassa. Se antaa virheilmoituksen, jos
ympäristöä ei ollutkaan olemassa.

Argumentit ovat lähes samanlaiset kuin komentojen määrittelyssä (luku
\ref{luku:komennot-määr}). Ympäristöjen määrittelykomennoilla on kolme
pakollista argumenttia: ensimmäinen on ympäristön nimi, toinen on
ympäristön aloitusmääritelmä (\koodi{aloi\-tus}) ja kolmas on
lopetusmääritelmä (\koodi{lope\-tus}).

\pagebreak[3]

\begin{koodilohkosis}
  \newenvironment{ymp}{Tästä se alkaa.}{Tähän se päättyy.}

  \begin{ymp}
    Ympäristön sisältöä.
  \end{ymp}
\end{koodilohkosis}

\begin{tulossis}
  Tästä se alkaa. Ympäristön sisältöä. Tähän se päättyy.
\end{tulossis}

Tavallisesti ympäristön aloitusmääritelmään kirjoitetaan jonkin toisen
ympäristön aloituskomento sekä mahdollisesti suoritetaan joitakin
asetuskomentoja. Vastaavasti lopetusmääritelmässä lopetetaan ympäristö
eli palataan normaaliin tilaan. Tarkoituksena on abstrahoida jokin
monimutkaisempi kokonaisuus eli tehdä uusi helppokäyttöinen ympäristö, joka
piilottaa teknisen toteutuksen.

\begin{koodilohkosis}
  \newenvironment{ymp}
  {\begin{mahtavuus}
      \omia\hienoja\asetuksia}
    {\end{mahtavuus}}
\end{koodilohkosis}

Omille ympäristölle voi määritellä argumentteja samalla tavalla kuin
komennoillekin (luku \ref{luku:komennot-määr}). Ensimmäinen valinnainen
argumentti (\koodi{n}) on luku joka kertoo, kuinka monta argumenttia
määriteltävä ympäristö käsittelee. Ympäristön aloitusmääritelmässä voi
argumentteihin viitata parametreilla \koodi{\#1}, \koodi{\#2},
\koodi{\#3} jne.

Jos toinen valinnainen argumentti (\koodi{oletus}) on mukana, se
ilmaisee, että määriteltävän ympäristön ensimmäinen argumentti on
valinnainen ja että tämä on sen ole\-tus\-arvo. Oletusta käytetään
silloin, kun valinnaista argumenttia ei ole annettu. Argumentit annetaan
ympäristön aloittavan \koodi{\keno begin}-ko\-men\-non yhteydessä.

\begin{koodilohkosis}
  \begin{ymp}[valinnainen]{argu}{mentteja}
    % ympäristön
    % vaikutusalue
  \end{ymp}
\end{koodilohkosis}

Ympäristön määrittelykomennoille on myös tähdelliset versiot
\koodi{\keno newenvironment*} ja \koodi{\keno renewenvironment*}. Ne
toimivat samoin kuin edellä kuvatut tavallisetkin komentoversiot, mutta
ne eivät salli, että määritellylle ympäristölle annetut argumentit
sisältävät enemmän kuin yhden tekstikappaleen. Toiminta on siis sama
kuin komentojenkin määrittelyn tähdellisissä versioissa (luku
\ref{luku:komennot-määr}).

\begin{koodilohkosis}
  \newenvironment*   {nimi}[n][oletus]{aloitus}{lopetus}
  \renewenvironment* {nimi}[n][oletus]{aloitus}{lopetus}
\end{koodilohkosis}

Joskus ympäristöjen määrittelyyn on hyödyllistä sisällyttää komento
\koodi{\keno ig\-nore\-spaces}, joka jättää huomioimatta komennon
jälkeiset sanavälit. Toinen hyödyllinen on \koodi{\keno
  ig\-nore\-spaces\-af\-ter\-end}, joka jättää huomioimatta ympäristön
lopettavan \koodi{\keno end}\-/komennon jälkeiset sanavälit.

\pagebreak[3]

\begin{koodilohkosis}
  \newenvironment{ymp}
    {Yhdys\ignorespaces}
    {esi\ignorespacesafterend}

  \begin{ymp}
    sana% Kommentti poistaa seuraavan sanavälin.
  \end{ymp}   merkki.
\end{koodilohkosis}

\begin{tulossis}
  Yhdyssanaesimerkki.
\end{tulossis}

\section{Mitat}
\label{luku:mitat}

\subsection{Mittayksiköt}

Koska typografia on pitkälti teksti- ja muiden elementtien sijoittelua,
tarvitaan sitä varten mittavälineitä. Niinpä Latexissakin on
pituusmittoja (engl. \emph{length}) ja useita pituuden mittayksiköitä.
Taulukkoon \ref{tlk:mittayksikot} on koottu mittayksiköiden lyhenteet ja
merkitykset. Teknisesti on samantekevää, mitä yksiköitä käyttää, sillä
ne ovat vain välineitä pituuden ilmaisemiseen. Sisäisesti Tex käyttää
sp-yksikköä, joka ilmaisee samalla mittojen tarkkuuden: pienin jakamaton
mitta on 1\,sp.

\leijutlk{
  \begin{tabular}{ll}
    \toprule
    \ots{Lyh.} & \ots{Merkitys} \\
    \midrule
    bp & piste uudessa pica-järjestelmässä, 1/72 tuumaa, 0,3528 mm \\
    pt & piste vanhassa pica-järjestelmässä, 1/72,27 tuumaa, 0,3515 mm \\
    pc & pica eli 12 pt-pistettä \\
    sp & 1/65536 pt-pistettä, Texin sisäisesti käyttämä yksikkö \\
    dd & piste Didot-järjestelmässä, 0,376 mm \\
    cc & cicero eli 12 dd-pistettä \\
    mm & millimetri \\
    cm & senttimetri \\
    in & tuuma, 25,4 mm \\
    ex & nykyisen fontin x-korkeus, perus- ja gemenalinjan etäisyys \\
    em & typografisen neliön sivun pituus, sama kuin fontin koko \\
    \bottomrule
  \end{tabular}
}{
  \caption{Latexin mittayksiköiden lyhenteet ja merkitykset}
  \label{tlk:mittayksikot}
}

Usein tietyt yksiköt ovat vakiintuneet tiettyihin tilanteisiin.
Esimerkiksi fonttien kokoja ja rivikorkeuksia on tapana mitata
pistemittojen avulla. Nykyään käytetään lähinnä bp\-/yksikön mukaista
pistettä, joka tuli käyttöön Post Script \=/standardin myötä vuonna 1984
ja jota käytetään julkaisuohjelmissa. Sivun mittoja kuten leveyttä,
korkeutta ja marginaaleja ilmaistaan tavallisesti metrijärjestelmän
avulla eli senttimetreissä tai millimetreissä.

Latexin mittojen mittaluvuissa desi\-maa\-li\-erot\-ti\-me\-na on piste,
ja mittayksikön lyhenne kirjoitetaan kiinni mittalukuun. Seuraavassa
esimerkissä tehdään vaakasuuntaisia ja pystysuuntaisia välejä
komennoilla \koodi{\keno hspace} ja \koodi{\keno vspace}.

\pagebreak[3]

\begin{koodilohkosis}
  Sanat\hspace{1.2cm}hassusti
  \vspace{2mm}

  \hspace{1.75em}erillään.
\end{koodilohkosis}

\begin{tulossis}
  Sanat\hspace{1.2cm}hassusti  \nopagebreak
  \vspace{2mm}

  \hspace{1.75em}erillään.
\end{tulossis}

\subsection{Mittakomennot ja typografinen viivasto}

Mittoja tallennetaan eräänlaisiin muuttujiin, jotka näyttävät päällepäin
komennoilta eli niiden alussa on kenoviiva (\koodi{\keno}) ja sitten
kirjaimista koostuva nimi. Esimerkiksi mitta \koodi{\keno text\-width}
on teks\-ti\-alueen leveys nykyisellä sivulla. Komentomaisesta
ulko\-asus\-taan huolimatta mittoja ei voi suorittaa komentoina; ne
sopivat vain komennon argumentiksi, silloin kun tarvitaan mitta.

Uusia mittoja luodaan komennolla \koodi{\keno new\-length} ja olemassa
olevia mittoja asetetaan esimerkiksi komennoilla \koodi{\keno
  set\-length} ja \koodi{\keno add\-to\-length}. Omien mittoja on
tarpeen luoda silloin, kun halutaan määritellä tietynsuuruinen mitta,
jota käytetään Latex\-/koodissa useita kertoja.

\begin{koodilohkosis}
  \newlength{\omamitta}         % Luodaan mitta.
  \setlength{\omamitta}{2.3em}  % Asetetaan mitta.
  \addtolength{\omamitta}{1em}  % Lisätään mittaan.
  \addtolength{\omamitta}{-1em} % Vähennetään mitasta.
\end{koodilohkosis}

Näin luotuja mittoja voi käyttää mittayksiköiden tavoin, eli niille voi
asettaa eteen kertoimen. Esimerkiksi seuraava \koodi{\keno
  hspace}\-/komento luo vaakasuuntaisen välin, jonka pituus on 0,7
kertaa \koodi{\keno oma\-mitta}.

\begin{koodilohkosis}
  \hspace{0.7\omamitta}
\end{koodilohkosis}

Koska vaakasuuntaisten välien tekeminen on typografiassa varsin
tavallista, on niitä varten olemassa omia komentoja. Typografisen neliön
levyisen (1~em) välin voi tehdä komennolla \koodi{\keno quad}. Sen
puolikkaan (\murtoluku{1/2}\,em) saa komennolla \koodi{\keno en\-space}.
Ohuke eli \murtoluku{1/6}\,em-väli tehdään \koodi{\keno,}\-/komennolla,
josta on tarkempaa tietoa luvussa \ref{luku:ohuke}.

\leijukuva{
  \begin{tikzpicture}
    [viiva/.style={line width=.7bp}, xscale=1.1, yscale=1.9,
    baseline=0pt]
    \node at (.04,.27) {\fontsize{13em}{13em}\viivastofontti p};

    \draw [viiva, color=red] (-1,.98) rectangle (1,-.47);
    \draw [viiva, color=red] (1,.98) -- (2.25,.98);
    \draw [viiva, color=red] (-1,.02) -- (2.25,.02);
    \draw [viiva, color=red] (1,-.47) -- (2.25,-.47);

    \draw [viiva, <->, color=black] (1.2,.02) -- (1.2,.98);
    \node at (1.9,.5) {korkeus};

    \draw [viiva, <->, color=black] (1.2,.02) -- (1.2,-.47);
    \node at (1.9,-.25) {syvyys};

    \draw [viiva, <->, color=black] (-1,1.1) -- (1,1.1);
    \node at (0,1.25) {leveys};

    \node at (3.13,1.64) {ylälinja};
    \node at (3.13,1.44) {versaalilinja};
    \node at (3.13,.98) {gemenalinja};
    \node at (3.13,.02) {peruslinja};
    \node at (3.13,-.47) {alalinja};

    \node at (6.53,.74) {\fontsize{13em}{13em}\viivastofontti H};

    \draw [viiva, color=red] (5.05,1.47) rectangle (7.95,.02);
    \draw [viiva, color=red] (5.05,.02) -- (4,.02);
    \draw [viiva, color=red] (5.05,1.47) -- (4,1.47);
    \draw [viiva, color=red] (7.95,1.62) -- (4,1.62);
    \draw [viiva, color=red] (7.95,.98) -- (4,.98);

    \draw [viiva, <->, color=black] (4.86,.02) -- (4.86,1.47);
    \node at (4.1,.5) {korkeus};

    \draw [viiva, <->, color=black] (5.05,-.1) -- (7.95,-.1);
    \node at (6.5,-.3) {leveys};
\end{tikzpicture}
}{
  \caption{Kirjainten mitat ja typografinen viivasto}
  \label{kuva:kirjainmitat}
}

Latex sisältää myös komennot mittojen poimimiseen kirjaimista tai muista
merkeistä. Mittoja on kolme: leveys (\englanti{width}), korkeus
(\englanti{height}) ja syvyys (\englanti{depth}). Leveys on merkin
viemä tila leveyssuunnassa. Korkeus tarkoittaa merkin korkeutta
peruslinjan yläpuolella, ja syvyys on merkin korkeus peruslinjan
alapuolella. Kuva \ref{kuva:kirjainmitat} havainnollistaa näitä kolmea
mittaa sekä typografista viivastoa.

Gemenalinja sijaitsee gemenakirjainten eli pienaakkosten korkeudella.
Peruslinjan ja gemenalinjan etäisyys on fontin x\=/korkeus (1\,ex).
Optisen vaikutelman vuoksi gemenalinja ei tarkoita ehdotonta
gemenakirjainten ylintä kohtaa. Esimerkiksi p\=/kirjaimen yläpääte ja
silmukan yläkaari voivat yltää hieman gemenalinjan yläpuolelle ja
silmukan alakaari peruslinjan alapuolelle. Fonttien suunnittelijat
tekevät tällaisia optisia korjauksia, jotta kirjainten hahmot näyttävät
yhtä korkeilta ja tasapainoisilta yhdessä.

Versaalilinja sijaitsee versaalikirjainten eli suuraakkosten
korkeudella. Jotkin kirjaimet voivat yltää hieman versaalilinjan
yläpuolellekin. Esimerkiksi joidenkin fonttien Hk\=/kirjaimia
vertailemalla näkee, että k\=/kirjaimen yläpääte yltää H\=/kirjaimen eli
versaalilinjan yläpuolelle, ylälinjan tuntumaan. Myös tarkemerkit (luku
\ref{luku:tarkkeet}) voivat sijaita versaalilinjan yläpuolella.

\pagebreak[3]

Merkkien leveyden, korkeuden ja syvyyden voi mitata alla olevan
esimerkin komennoilla. Esimerkin ensimmäisellä rivillä luodaan uudet
mitat \koodi{\keno leveys}, \koodi{\keno korkeus} ja \koodi{\keno
  syvyys}, joihin sitten tallennetaan merkkien mitat.

\begin{koodilohkosis}
  \newlength{\leveys} \newlength{\korkeus} \newlength{\syvyys}
  \settowidth{\leveys}{abc} % merkkien ”abc” leveys
  \settoheight{\korkeus}{H} % merkin ”H” korkeus
  \settodepth{\syvyys}{p}   % merkin ”p” syvyys
\end{koodilohkosis}

\pagebreak[3]

Mitat saa näkyviin kirjoittamalla mitan eteen komennon \koodi{\keno
  the}. Näin mitan pituus ladotaan dokumenttiin. Yksikkönä on
typografinen piste (pt).

\begin{koodilohkosis}
  Leveys: \the\leveys, korkeus: \the\korkeus, syvyys: \the\syvyys.
\end{koodilohkosis}

\begin{tulossis}
  Leveys: 14.62865pt, korkeus: 6.81897pt, syvyys: 2.4662pt.
\end{tulossis}

Aiemmin mainituista optisista korjauksista johtuu, että gemenakirjaimet
eivät ole välttämättä täsmälleen samankorkuisia. Gemena\=/x asettuu
yleensä perus- ja gemenalinjojen väliin, mutta gemena\=/o voi yltää
aavistuksen verran linjojen ylä- ja alapuolelle. Alla on esimerkki,
jossa mitataan ja tulostetaan x:n ja o:n korkeus.

\pagebreak[3]

\begin{koodilohkosis}
  \newlength{\korkeusx} \newlength{\korkeuso}
  \settoheight{\korkeusx}{x}
  \settoheight{\korkeuso}{o}
  x-korkeus: \the\korkeusx, o-korkeus: \the\korkeuso
\end{koodilohkosis}

\begin{tulossis}
  x-korkeus: 4.54247pt, o-korkeus: 4.62679pt
\end{tulossis}

\subsection{Venyvät mitat}

Edellä on puhuttu vain kiinteistä mitoista, mutta Latex tuntee myös
venyvät mitat. Niiden ajatuksena on, että Latexille voi antaa luvan
kutistaa tai venyttää mittaa tietyissä rajoissa. Venyviä mittoja
käytettään usein pystysuuntaisissa väleissä, esimerkiksi väliotsikon
edellä ja jälkeen tai tekstikappaleiden välissä. Latex pystyy latomaan
sivut yleensä paremman näköiseksi, kun sille antaa venyvien mittojen
avulla hieman säätövaraa. Alla on esimerkki venyvän kappalevälin
(\koodi{\keno par\-skip}) määrittämisestä. Samalla asetetaan kappaleen
ensimmäisen rivin sisennys (\koodi{\keno par\-in\-dent}) nollaan
(\koodi{0em}).

\begin{koodilohkosis}
  \setlength{\parskip}{2ex plus 0.2ex minus 0.1ex}
  \setlength{\parindent}{0em}
\end{koodilohkosis}

Venyvissä mitoissa mainitaan ensin normaali pituus ja sitten sanoilla
\koodi{plus} ja \koodi{minus} ilmaistaan, kuinka paljon mitta voi venyä
tai kutistua. Molempia ei välttämättä tarvitse antaa.

Venyvät mitat voivat sisältää ''äärettömän'' mittayksikön \koodi{fill},
joka antaa luvan venyttää mittaa niin, että kaikki käytettävissä oleva
tila täyttyy. Äärettömän mittayksikön kanssa mittaluku ilmaisee
suhdeluvun muihin äärettömiin mittoihin. Seuraava esimerkki
havainnollistaa asiaa.

\pagebreak[3]

\begin{koodilohkosis}
  x\hspace{0mm plus 1fill}x\hspace{0mm plus 2fill}x
\end{koodilohkosis}

\begin{tulossis}
  x\hspace{0mm plus 1fill}x\hspace{0mm plus 2fill}x
\end{tulossis}

Edellisen esimerkin mittojen luonnollinen pituus on nolla millimetriä
(\koodi{0mm}), mutta \koodi{plus} ja \koodi{fill} \=/mitan vuoksi ne
voivat venyä ja täyttää koko käytettävissä olevan tilan. Ensin
mainitulla on suhdeluku 1 (\koodi{1fill}) ja jälkimmäisellä suhdeluku 2
(\koodi{2fill}), joten jälkimmäinen väli on kaksinkertainen ensimmäiseen
verrattuna. Saman äärettömästi venyvän mitan ja suhdeluvut voi ilmaista
myös \koodi{\keno stretch}\-/mitan tai \koodi{\keno hfill}\-/komentojen
avulla seuraavasti.

\pagebreak[3]

\begin{koodilohkosis}
  x\hspace{\stretch{1}}x\hspace{\stretch{2}}x \\
  x\hfill x\hfill\hfill x
\end{koodilohkosis}

\begin{tulossis}
  x\hspace{\stretch{1}}x\hspace{\stretch{2}}x \\
  x\hfill x\hfill\hfill x
\end{tulossis}

Vastaavasti pystysuuntaisen äärettömästi venyvän välin voi tehdä
komennolla \koodi{\keno vfill}, joka tekee saman asian kuin \koodi{\keno
  vspace\{0mm plus 1fill\}}.

Äärettömästi venyvälle, koko tilan täyttävälle mittayksikölle on itse
asiassa kolme eri versiota: \koodi{fil}, \koodi{fill} ja \koodi{filll}.
Niiden erona on tärkeysjärjestys. Ensin mainittu \koodi{fil} on vähiten
tärkeä, ja viimeinen eli \koodi{filll} on tärkein. Jos samassa
yhteydessä käytetään eri tär\-keys\-as\-tei\-sia yksiköitä,
korkeammantasoiset mitätöivät alemmantasoiset.

\pagebreak[3]

\begin{koodilohkosis}
  x\hspace{0mm plus 1filll}x\hspace{0mm plus 1fill}x
\end{koodilohkosis}

\begin{tulossis}
  x\hspace{0mm plus 1filll}x\hspace{0mm plus 1fill}x
\end{tulossis}

Edellisessä esimerkissä ensimmäinen venyvä mitta \koodi{1filll} mitätöi
jälkimmäisen \koodi{1fill} kokonaan. Yleensä lienee parasta käyttää
keskimmäistä (\koodi{fill}), mutta eri tär\-keys\-as\-teil\-le voi olla
käyttöä esimerkiksi makropaketin koodissa: \koodi{fil} sallii, että
käyttäjä tai muu koodi syrjäyttää asetuksen; \koodi{filll} on ehdoton
sääntö, joka syrjäyttää muut.

\section{Laskurit}

Laskureiden avulla Latex pitää kirjaa esimerkiksi sivunumeroista,
lukujen ja alalukujen sekä kuvien ja muiden elementtien numeroinnista.
Esimerkiksi nyt olemme pääluvun~\arabic{chapter}
alaluvussa~\arabic{section}. Edellisen virkkeen luvut tulevat Latexin
laskureista automaattisesti.

\leijutlk{
  \ttfamily
  \begin{tabular}{llll}
    \toprule
    part & paragraph & figure & enumi \\
    chapter & subparagraph & table & enumii \\
    section & page & footnote & enumiii \\
    subsection & equation & mpfootnote & enumiv \\
    subsubsection \\
    \bottomrule
  \end{tabular}
}{
  \caption{Latexin laskurit}
  \label{tlk:latexin_laskurit}
}

Taulukossa \ref{tlk:latexin_laskurit} ovat Latexin perus laskurit. Monet
niistä ovat otsikoiden numerointia varten (\englanti{\koodi{part},
  \koodi{chapter}, \koodi{section}, \koodi{paragraph}}). Sivunumeroita
varten on \koodi{page}\-/laskuri ja matemaattisten kaavojen
numerointiin \koodi{equation}\-/laskuri. Leijuvista kuvista ja
taulukoista (luku \ref{luku:leijuosat}) pidetään kirjaa laskureissa
\koodi{figure} ja \koodi{table}, ja alaviitteiden (luku
\ref{luku:alaviitteet}) numerointi on laskureissa \koodi{footnote} ja
\koodi{mpfootnote}. Numeroidut luetelmat (luku \ref{luku:luetelmat})
käsitellään \koodi{enum}\-/alkuisten laskureiden avulla siten, että
perustasolla käytetään laskuria \koodi{enumi}, ja jos sen luetelmakohta
sisältää toisen numeroidun luetelman, käytetään siinä laskuria
\koodi{enumii}, sen sisällä laskuria \koodi{enumiii} jne.

Edellä mainituista laskureista ei tarvitse yleensä itse huolehtia, sillä
ne ovat vain tekniikkaa, joka toimii korkeamman tason toimintojen
taustalla. Joskus on kuitenkin käyttöä myös omille laskureille. Alla
ovat laskureiden käsittelyn peruskomennot. Niissä käytetään laskuria
nimeltä \koodi{oma}. Laskurien nimet koostuvat pelkistä kirjaimista,
eikä niiden alussa ole kenoviivaa niin kuin komentojen ja mittojen
alussa.

\begin{koodilohkosis}
  \newcounter{oma}       % Luodaan uusi laskuri ”oma”.
  \setcounter{oma}{3}    % Asetetaan laskurin arvoksi 3.
  \addtocounter{oma}{1}  % Lisätään laskurin arvoon 1.
  \addtocounter{oma}{-1} % Vähennetään laskurin arvosta 1.
\end{koodilohkosis}

Laskuri on sisäisesti kokonaisluku, mutta sen arvon voi tulostaa eri
muodoissa: arabialaisena tai roomalaisena lukuna, kirjaimena tai
symbolien sarjana. Taulukossa \ref{tlk:laskurien_tulostus} ovat komennot
laskurin arvon tulostamiseen. Komennon argumentiksi annetaan laskurin
nimi. Laskurin voi tulostaa kirjainmuodossa, jos sen arvo on 1--26;
symbolit toimivat vain lu\-ku\-alueel\-la 1--9.

\leijutlk{
  \begin{tabular}{ll}
    \toprule
    \ots{Komento} & \ots{Merkitys} \\
    \midrule
    \koodi{\keno arabic\{\ldots\}} & arabialainen luku: 1, 2, 3\ldots \\
    \koodi{\keno roman\{\ldots\}} & roomalainen luku: i, ii, iii\ldots \\
    \koodi{\keno Roman\{\ldots\}} & roomalainen luku: I, II, III\ldots \\
    \koodi{\keno alph\{\ldots\}} & kirjain: a, b, c\ldots \\
    \koodi{\keno Alph\{\ldots\}} & kirjain: A, B, C\ldots \\
    \koodi{\keno fnsymbol\{\ldots\}} & symboli:
                                  \textasteriskcentered
                                  \textdagger
                                  \textdaggerdbl\S\P\ldots \\
    \bottomrule
  \end{tabular}
}{
  \caption{Komennot laskurien arvon tulostamiseen}
  \label{tlk:laskurien_tulostus}
}

Taulukon \ref{tlk:laskurien_tulostus} komentojen lisäksi laskuriin
liittyvän arvon voi tulostaa komennolla, joka alkaa kirjaimilla
\koodi{\keno the} ja jatkuu laskurin nimellä. Esimerkiksi komento
\koodi{\keno the\-page} tulostaa sivunumeron eli tekee käytännössä saman
asian kuin komento \koodi{\keno arabic\{page\}}. Aina nämä eivät
kuitenkaan ole sama asia, ja \koodi{\keno the}\-/alkuinen komento voi
olla määritelty toisellakin tavalla. Esimerkiksi tämän oppaan leijuvat
taulukot numeroidaan laskurilla \koodi{table}, mutta komento
\koodi{\keno the\-table} tulostaa ensin pääluvun ja sen perään pisteen
ja taulukon numeron. Viimeisin taulukko oli numeroltaan \thetable{} eli
pääluvun \arabic{chapter} taulukko \arabic{table}.

Jos laskurin arvoa tarvitaan Latexin teknisessä tilanteessa eikä
tarkoituksena ole latoa sitä näkyviin itse dokumenttiin, täytyy käyttää
komentoa \koodi{\keno val\-ue}. Seuraava esimerkki luo laskurin nimeltä
\koodi{mitta}, jonka arvoa (3) käytetään \koodi{\keno hspace}\-/komennon
argumenttina mitan ilmaisemiseen (3\,em).

\pagebreak[3]

\begin{koodilohkosis}
  \newcounter{mitta}
  \setcounter{mitta}{3}
  x\hspace{\value{mitta}em}x
\end{koodilohkosis}

\begin{tulossis}
  x\hspace{3em}x
\end{tulossis}

\subsection{Hierarkkiset laskurit}

Laskurit voivat olla hierarkkisia ja riippuvaisia toisista laskureista:
kun yhden laskurin arvo kasvaa, nollautuu jokin toinen laskuri
automaattisesti. Tällaista toimintoa käytetään dokumentin lukujen eli
otsikoiden numeroinnissa. Kirjan pääluvun~1 alaluvut ovat esimerkiksi
1.1, 1.2, 1.3 jne. Kun alkaa seuraava pääluku~2, nollautuu alaluvun
laskuri, jotta saadaan oikein numeroidut alaluvut 2.1, 2.2, 2.3 jne.
Latex huolehtii lukujen numeroinnista automaattisesti, mutta omille
laskureille täytyy määritellä riippuvuussuhteet itse. Seuraavassa
esimerkissä luodaan oma laskuri, joka nollautuu automaattisesti aina,
kun sivu vaihtuu eli laskurin \koodi{page} arvo kasvaa.

\begin{koodilohkosis}
  \newcounter{oma}[page]
\end{koodilohkosis}

Ylemmän tason laskureita ei kannata kasvattaa komennolla \koodi{\keno
  add\-to\-counter}, koska se vain muuttaa laskurin arvoa mutta ei
huolehdi alemman tason laskurien nollaamisesta. Hierarkkisten laskurien
kasvattamiseen on seuraavat kaksi komentoa.

\begin{koodilohkosis}
  \stepcounter{laskuri}
  \refstepcounter{laskuri}
\end{koodilohkosis}

Edellä mainitut komennot kasvattavat argumenttina annetun laskurin arvoa
yhdellä ja nollaavat siitä riippuvaiset alemman tason laskurit.
Jälkimmäinen komento \koodi{\keno ref\-step\-counter} asettaa lisäksi
ristiviitteen numeron, joten tätä komentoa seuraava \koodi{\keno
  label}\-/komento viittaa tähän laskuriin ja sen \koodi{\keno
  the\-las\-ku\-ri}\-/komennon tulosteeseen. Ristiviitteitä käsitellään
tarkemmin luvussa \ref{luku:ristiviitteet}.

Makropaketti \paketti{chngcntr}\avctan{chngcntr} helpottaa
hierarkkisten laskurien muuttamista jälkikäteen. Paketin komentojen
avulla voi jälkikäteen asettaa jonkin laskurin riippuvaiseksi toisesta
laskurista tai poistaa riippuvuuden.

\begin{koodilohkosis}
  \newcounter{oma}           % Luodaan laskuri ”oma”.
  \counterwithin {oma}{page} % Asetetaan riippuvuus page-laskurista.
  \counterwithout{oma}{page} % Poistetaan riippuvuus.
\end{koodilohkosis}

Edellä mainitut \paketti{chngcntr}\-/paketin komennot määrittelevät
uudelleen myös \koodi{\keno the\-oma}\-/komennon, jolla
\koodi{oma}\-/laskurin arvon voi tulostaa. Se tulostaa mukaan myös
ylemmäntasoisen laskurin arvon. Jos tätä \koodi{\keno the}\-/alkuista
komentoa ei halua määritellä uudelleen, täytyy käyttää tähdellisiä
komennon versioita: \koodi{\keno counter\-with\-in*} ja \koodi{\keno
  counter\-with\-out*}. Laskuriin liittyvän \koodi{\keno the}\-/komennon
voi aina itsekin määritellä haluamansa laiseksi komennolla \koodi{\keno
  renewcommand} (luku \ref{luku:komennot-määr}), esimerkiksi seuraavalla
tavalla.

\begin{koodilohkosis}
  \renewcommand{\theoma}{\arabic{page}/\alph{oma}}
\end{koodilohkosis}

\subsection{Kokonaislaskurit}

Latex ei tiedä etukäteen, mihin arvoon laskurit lopulta yltävät. Se vain
latoo sivuja peräkkäin eikä tiedä mitään tulevasta. Sen vuoksi
esimerkiksi dokumentin sivumäärää ei voi ihan yksinkertaisella
komennolla latoa dokumentin alkusivuille.

Vastaus tämäntyyppisiin ongelmiin löytyy ristiviitteistä (luku
\ref{luku:ristiviitteet}). Ne toimivat sisäisesti niin, että dokumentin
ensimmäisellä kääntökerralla kirjoitetaan väliaikaistiedostoon muistiin
tarpeellisia asioita ja seuraavalla kääntökerralla hyödynnetään
väliaikaistiedostoa. Dokumentin sivumäärän ja viimeisen sivunumeron
tallentamiseen on olemassa makropaketti
\paketti{tot\-pages},\avctan{totpages} joka lisää viimeiselle sivulle
automaattisesti ristiviitteen nimeltä \koodi{Tot\-Pages}. Sivumäärän ja
viimeisen sivun numeron voi tulostaa komennoilla \koodi{\keno ref} ja
\koodi{\keno page\-ref}. Esimerkki \ref{esim:totpages} havainnollistaa
niiden käyttöä.

\begin{esimerkki*}
\begin{koodilohko}
  \documentclass{article}
  \usepackage{totpages}

  \begin{document}
  Sivumäärä: \ref{TotPages}. Viimeinen sivu: \pageref{TotPages}.

  \addtocounter{page}{10} % Sivunumerot 11, 12, 13...
  \newpage Jotain... \newpage ...sisältöä.
  \end{document}
\end{koodilohko}
\caption{Dokumentin sivumäärän ja viimeisen sivun tulostaminen}
\label{esim:totpages}
\end{esimerkki*}

Muunlaisten kokonaislaskurien toteuttamiseen voi käyttää
\paketti{tot\-count}\-/pakettia.\avctan{totcount} Se tarjoaa komennon,
jolla rekisteröidään olemassa oleva laskuri kokonaislaskuriksi. Lisäksi
on komento, jolla tulostetaan tai palautetaan laskurin lopullinen arvo.

\begin{koodilohkosis}
  \newcounter{oma}      % Luodaan laskuri ”oma”.
  \regtotcounter{oma}   % Rekisteröidään ”oma” kokonaislaskuriksi.
  \addtocounter{oma}{1} % Kasvatetaan laskurin arvoa.
  \total{oma}           % Tulostetaan laskurin lopullinen arvo.
  \totvalue{oma}        % Palautetaan laskurin lopullinen arvo.
\end{koodilohkosis}

Edellä olevan esimerkin viimeistä komentoa \koodi{\keno tot\-value} ei
käytetä laskurin arvon latomiseen itse dokumenttiin vaan sitä käytetään
teknisissä yhteyksissä kuten toisen Latex\-/komennon argumenttina.

Myös Latexin valmiita laskureita voi rekisteröidä kokonaislaskureiksi.
Tässä oppaassa on yhteensä \total{chapter} numeroitua päälukua, ja
mainittu lukumäärä saatiin laskettua seuraavasti.

\begin{koodilohkosis}
  \regtotcounter{chapter} % Sijoitetaan dokumentin esittelyosaan.
  \total{chapter}         % Tulostaa päälukujen (chapter) lukumäärän.
\end{koodilohkosis}
